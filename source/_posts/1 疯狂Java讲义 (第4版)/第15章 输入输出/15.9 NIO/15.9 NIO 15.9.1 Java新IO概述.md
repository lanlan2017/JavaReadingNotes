---
title: 15.9 NIO 15.9.1 Java新IO概述
categories: 
  - 1 疯狂Java讲义 (第4版)
  - 第15章 输入输出
  - 15.9 NIO
abbrlink: 32004866
date: 2020-01-06 03:41:44
updated: 2022-04-03 01:21:15
---
# 15.9 NIO 15.9.1 Java新IO概述
## 旧IO
### 旧IO阻塞
前面介绍`BufferedReader`时提到它的一个特征—当`BufferedReader`读取输入流中的数据时,如果没有读到有效数据,程序将在此处阻塞该线程的执行(使用`InputStream`的`read()`方法从流中读取数据时,如果数据源中没有数据,它也会阻塞该线程),**也就是前面介绍的输入流、输出流都是阻塞式的输入、输出**。
### 旧IO一次只能处理一个字节
不仅如此,传统的输入流、输出流都是通过字节的移动来处理的(即使不直接去处理字节流,但底层的实现还是依赖于字节处理),也就是说,**面向流的输入输出系统一次只能处理一个字节,因此面向流的输入输出系统通常效率不高**。
## 新IO
从`JDK1.4`开始,`Java`提供了一系列改进的输入输出处理的新功能,这些功能被统称为`新IO`(`New IO`,简称`NIO`),新增了许多用于处理输入输出的类,这些类都被放在`java.nio`包以及子包下,并且**对原`java.io`包中的很多类都以`NIO`为基础进行了改写,新增了满足`NIO`的功能**。
# 15.9.1 Java新IO概述
新`IO`和传统的`IO`有相同的目的,都是用于进行输入输出,但新`IO`使用了不同的方式来处理输入/输出。
## 内存映射文件方式
**新`IO`采用<mark>内存映射文件</mark>的方式来处理输入/输出**,新`IO`模拟了操作系统上的虚拟内存的概念:**将文件或文件的一段区域映射到内存中,这样就可以像访问内存一样来访问文件了**,通过这种方式来进行输入输出比传统的输入输出要快得多。
## NIO相关包
`Java`中与新`IO`相关的包如下:

|新`IO`相关的包|描述|
|:---|:---|
|`java.nio`包|主要包含各种与`Buffer`相关的类|
|`java.nio.channels`包|主要包含与`Channel`和`Selector`相关的类。|
|`java.nio.charset`包|主要包含与字符集相关的类|
|`java.nio.channels.spi`包|主要包含与`Channel`相关的服务提供者编程接口。|
|`java.nio.charset.spi`包|包含与字符集相关的服务提供者编程接口。|

## Channel简介
`Channel`(通道)和`Buffer`(缓冲)是新`IO`中的两个核心对象,`Channel`是对传统的输入输出系统的模拟,在新`IO`系统中所有的数据都需要通过通道传输;
`Channel`与传统的`InputStream`、`OutputStream`最大的区别在于它提供了一个`map()`方法,通过该`map()`方法可以直接将“一块数据”映射到内存中。
如果说**传统的输入输出系统是面向`流`的处理**,则**新`IO`则是面向`块`的处理**。
## Buffer简介
`Buffer`可以被理解成一个容器,它的本质是一个数组,**发送到`Channel`中的所有对象都必须首先放到`Buffer`中**,而从`Channel`中读取的数据也必须先放到`Buffer`中。
此处的`Buffer`有点类似于前面介绍的“竹筒”,但该`Buffer`既可以像“竹筒”那样一次次去`Channel`中取水,也允许使用`Channel`直接将文件的某块数据映射成`Buffer`
## Charset和Selector简介
除`Channel`和`Buffer`之外,
- 新`IO`还提供了**用于将<mark>Unicode字符串</mark>映射成<mark>字节序列</mark>以及<mark>逆映射</mark>操作的`Charset`类**,
- 也提供**了用于支持<mark>非阻塞式输入输出</mark>的`Selector`类**。
