---
title: 1.5 展望Java技术的未来 1.5.5 语言语法持续增强
categories: 
  - 9 深入理解Java虛拟机：JVM高级特性与最佳实践(第3版)
  - 1第一部分 走近Java
  - 第1章 走近Java
  - 1.5 展望Java技术的未来
abbrlink: fb27b70
date: 2021-09-15 20:14:08
updated: 2021-09-24 10:17:26
---
# 1.5.5 语言语法持续增强
笔者将语言的功能特性和语法放到最后来讲，因为它是相对最不重要的改进点，毕竟连JavaScript 这种“反人类”的语法都能获得如此巨大的成功，而比Java语法先进优雅得多的挑战者C#现在已经“江湖 日下”，成了末路英雄[^1]。

但一门语言的功能、语法又是影响语言生产力和效率的重要因素，很多语言特性和语法糖不论有 没有，程序也照样能写，但即使只是可有可无的语法糖，也是直接影响语言使用者的幸福感程度的关 键指标。JDK 7的Coins项目结束以后，Java社区又创建了另外一个新的语言特性改进项目Amber，JDK 10至13里面提供的新语法改进基本都来自于这个项目，譬如：

- JEP 286：Local-Variable Type Inference，在JDK 10中提供，本地类型变量推断。
- JEP 323：Local-Variable Syntax for Lambda Parameters，在JDK 11中提供，JEP 286的加强，使它可 以用在Lambda中。
- JEP 325：Switch Expressions，在JDK 13中提供，实现switch语句的表达式支持。
- JEP 335：Text Blocks，在JDK 13中提供，支持文本块功能，可以节省拼接HTML、SQL等场景里 大量的“+”操作。

还有一些是仍然处于草稿状态或者暂未列入发布范围的JEP，可供我们窥探未来Java语法的变化， 譬如：
- JEP 301：Enhanced Enums，允许常量类绑定数据类型，携带额外的信息。
- JEP 302：Lambda Leftovers，用下划线来表示Lambda中的匿名参数。
- JEP 305：Pattern Matching for instanceof，用instanceof判断过的类型，在条件分支里面可以不需要 做强类型转换就能直接使用。

除语法糖以外，语言的功能也在持续改进之中，以下几个项目是目前比较明确的，也是受到较多 关注的功能改进计划：
- Project Loom：现在的Java做并发处理的最小调度单位是线程，Java线程的调度是直接由操作系统 内核提供的（这方面的内容可见本书第12章），会有核心态、用户态的切换开销。而很多其他语言都 提供了更加轻量级的、由软件自身进行调度的用户线程（曾经非常早期的Java也有绿色线程），譬如 Golang的Groutine、D语言的Fiber等。Loom项目就准备提供一套与目前Thread类API非常接近的Fiber实 现。
- Project Valhalla：提供值类型和基本类型的泛型支持，并提供明确的不可变类型和非引用类型的声 明。值类型的作用和价值在本书第10章会专门讨论，而不可变类型在并发编程中能带来很多好处，没 有数据竞争风险带来了更好的性能。一些语言（如Scala）就有明确的不可变类型声明，而Java中只能 在定义类时将全部字段声明为final来间接实现。基本类型的范型支持是指在泛型中引用基本数据类型不需要自动装箱和拆箱，避免性能损耗。
- Project Panama：目的是消弭Java虚拟机与本地代码之间的界线。现在Java代码可以通过JNI来调用 本地代码，这点在与硬件交互频繁的场合尤其常用（譬如Android）。但是JNI的调用方式充其量只能 说是达到能用的标准而已，使用起来仍相当烦琐，频繁执行的性能开销也非常高昂，Panama项目的目 标就是提供更好的方式让Java代码与本地代码进行调用和传输数据。

随着Java每半年更新一次的节奏，新版本的Java中会出现越来越多其他语言里已有的优秀特性，相 信博采众长的Java，还能继续保持现在的勃勃生机相当长时间。


[^1]: 笔者个人观点，读者请勿从“反人类”“江湖日下”这些词语中挑起语言战争。毕竟“PHP是世界上最 好的语言”（梗）。
