---
title: 1.5 循环
<<<<<<< HEAD
categories:
=======
categories: 
>>>>>>> 4ed4de8f07c69857a05fa9fda8014b55c4291ca0
  - 9 Java编程的逻辑
  - 1第一部分 编程基础与二进制
  - 第1章 编程基础
abbrlink: a874b478
date: 2021-12-01 19:33:21
<<<<<<< HEAD
updated: 2021-12-07 12:07:07
=======
updated: 2022-04-03 01:21:19
>>>>>>> 4ed4de8f07c69857a05fa9fda8014b55c4291ca0
---
# 1.5 循环
所谓循环，就是多次重复执行某些类似的操作，这个操作一般不是完全一样的操作，而是类似的操作。都有哪些操作呢？这种例子太多了，比如：
1）展示照片，我们查看手机上的照片，背后的程序需要将照片一张张展示给我们。
2）播放音乐，我们听音乐，背后程序按照播放列表一首首给我们放。
3）查看消息，我们浏览朋友圈消息，背后程序将消息一条条展示给我们。

循环除了用于重复读取或展示某个列表中的内容，日常中的很多操作也要靠循环完成，比如：
1）在文件中，查找某个词，程序需要和文件中的词逐个比较（当然可能有更高效的方式，但也离不开循环）；
2）使用Excel对数据进行汇总，比如求和或平均值，需要循环处理每个单元的数据；
3）群发祝福消息给好友，程序需要循环给每个好友发。

当然，以上这些例子只是冰山一角。计算机程序运行时大致只能顺序执行、条件执行和循环执行。顺序和条件其实没什么特别的，而循环大概才是程序强大的地方。凭借循环，计算机能够非常高效地完成人很难或无法完成的事情。比如，在大量文件中查找包含某个搜索词的文档，对几十万条销售数据进行统计汇总等。下面，我们先来介绍循环的4种形式，然后介绍循环控制，最后讨论循环的实现原理并进行总结。

## 1.5.1 循环的4种形式
在Java中，循环有4种形式，分别是while、do/while、for和foreach，下面我们分别介绍。

### 1. while
while的语法为：

```java
while(条件语句){
    代码块
}
```

或：

```java
while(条件语句) 代码；
```

while和if的语法很像，只是把if换成了while，它表达的含义也非常简单，只要条件语句为真，就一直执行后面的代码，为假就停止不做了。比如：

```java
Scanner reader = new Scanner(System.in);
System.out.println("please input password");
int num = reader.nextInt();
int password = 6789;
while(num! =password){
      System.out.println("please input password");
      num = reader.nextInt();
}
System.out.println("correct");
reader.close();
```

以上代码中，我们使用类型为Scanner的reader变量从屏幕控制台接收数字，reader. nextInt()从屏幕接收一个数字，如果数字不是6789，就一直提示输入，否则跳出循环。以上代码中的Scanner我们会在13.3节介绍，目前可以忽略其细节。

while循环中，代码块中会有影响循环中断或退出的条件，但经常不知道什么时候循环会中断或退出。比如，上例中在匹配的时候会退出，但什么时候能匹配取决于用户的输入。

### 2. do/while
如果不管条件语句是什么，代码块都会至少执行一次，则可以使用do/while循环，其语法为：

```java
do{
    代码块；
}while(条件语句)
```

这个也很容易理解，先执行代码块，然后再判断条件语句，如果成立，则继续循环，否则退出循环。也就是说，不管条件语句是什么，代码块都会至少执行一次。上面的例子，改为do/while循环，代码为：

```java
Scanner reader = new Scanner(System.in);
int password = 6789;
int num = 0;
do{
    System.out.println("please input password");
    num = reader.nextInt();
}while(num! =password);
System.out.println("correct");
reader.close();
```

### 3. for
实际中应用最为广泛的循环语法可能是for了，尤其是在循环次数已知的情况。其语法为：

```java
for(初始化语句；循环条件；步进操作){
    循环体
}
```

for后面的括号中有两个分号；，分隔了三条语句。除了循环条件必须返回一个boolean类型外，其他语句没有什么要求，但通常情况下第一条语句用于初始化，尤其是循环的索引变量，第三条语句修改循环变量，一般是步进，即递增或递减索引变量，循环体是在循环中执行的语句。

for循环简化了书写，但执行过程对初学者而言不是那么明显，实际上，它执行的流程如下：
1）执行初始化指令；
2）检查循环条件是否为true，如果为false，则跳转到第6步；
3）循环条件为真，执行循环体；
4）执行步进操作；
5）步进操作执行完后，跳转到第2步，即继续检查循环条件；
6）for循环后面的语句。

下面是一个简单的for循环：

```java
int[] arr = {1,2,3,4};
for(int i=0; i<arr.length; i++){
    System.out.println(arr[i]);
}
```

顺序打印数组中的每个元素，初始化语句初始化索引i为0，循环条件为索引小于数组长度，步进操作为递增索引i，循环体打印数组元素。

在for中，每条语句都是可以为空的，也就是说：

```java
for(; ; ){}
```

是有效的，这是个死循环，一直在空转，和while(true){}的效果是一样的。可以省略某些语句，但分号；不能省。如：

```java
int[] arr = {1,2,3,4};
int i=0;
for(; i<arr.length; i++){
    System.out.println(arr[i]);
}
```

索引变量在外面初始化了，所以初始化语句可以为空。

### 4. foreach
foreach的语法如下所示：

```java
int[] arr = {1,2,3,4};
for(int element : arr){
    System.out.println(element);
}
```

foreach不是一个关键字，它使用冒号：，冒号前面是循环中的每个元素，包括数据类型和变量名称，冒号后面是要遍历的数组或集合（第9章介绍），每次循环element都会自动更新。对于不需要使用索引变量，只是简单遍历的情况，foreach语法上更为简洁。

## 1.5.2 循环控制
在循环的时候，会以循环条件作为是否结束的依据，但有时可能会需要根据别的条件提前结束循环或跳过一些代码，这时可以使用break或continue关键字对循环进行控制。

### 1. break
break用于提前结束循环。比如，在一个数组中查找某个元素的时候，循环条件可能是到数组结束，但如果找到了元素，可能就会想提前结束循环，这时就可以使用break。

我们在介绍switch的时候提到过break，它用于跳转到switch外面。在循环的循环体中也可以使用break，它的含义和switch中的类似，用于跳出循环，开始执行循环后面的语句。以在数组中查找元素作为例子，代码可能是：

```java
int[] arr = … ; //在该数组中查找元素
int toSearch = 100; //要查找的元素
int i = 0;
for(; i<arr.length; i++){
    if(arr[i]==toSearch){
        break;
    }
}
if(i! =arr.length){
    System.out.println("found");
}else{
    System.out.println("not found");
}
```

如果找到了，会调用break, break执行后会跳转到循环外面，不会再执行i++语句，所以即使是最后一个元素匹配，i也小于arr.length，而如果没有找到，i最后会变为arr. length，所以可根据i是否等于arr.length来判断是否找到了。以上代码中，也可以将判断是否找到的检查放到循环条件中，但通常情况下，使用break会使代码更清楚一些。

### 2. continue
在循环的过程中，有的代码可能不需要每次循环都执行，这时候，可以使用continue语句，continue语句会跳过循环体中剩下的代码，然后执行步进操作。我们看个例子，以下代码统计一个数组中某个元素的个数：

```java
int[] arr = …     //在该数组中查找元素
int toSearch = 2;  //要查找的元素
int count = 0;
for(int i=0; i<arr.length; i++){
    if(arr[i]! =toSearch){
        continue;
    }
    count++;
}
System.out.println("found count "+count);
```

上面的代码统计数组中值等于toSearch的元素个数，如果值不等于toSearch，则跳过剩下的循环代码，执行i++。以上代码也可以不用continue，使用相反的if判断也可以得到相同的结果。这只是个人偏好的问题，如果类似要跳过的情况比较多，使用continue可能会更易读。

## 1.5.3 实现原理
和if一样，循环内部也是靠条件转移和无条件转移指令实现的，比如下面的代码：

```java
int[] arr = {1,2,3,4};
for(int i=0; i<arr.length; i++){
    System.out.println(arr[i]);
}
```

其对应的跳转过程可能为：

```
1 int[] arr = {1,2,3,4};
2 int i=0;
3 条件跳转：如果i>=arr.length，跳转到第7行
4 System.out.println(arr[i]);
5 i++
6 无条件跳转，跳转到第3行
7 其他代码
```

在if中，跳转只会往后面跳，而for会往前面跳，第6行就是无条件跳转指令，跳转到了前面的第3行。break/continue语句也都会转换为跳转指令，具体就不赘述了。

## 1.5.4 小结
循环的语法总体上也是比较简单的，初学者需要注意的是for的执行过程，以及break和continue的含义。**虽然循环看起来只是重复执行一些类似的操作而已，但它其实是计算机程序解决问题的一种基本思维方式**，凭借循环（当然还有别的），计算机程序可以发挥出强大的威力，比如批量转换数据、查找过滤数据、统计汇总等。

使用基本数据类型、数组、基本运算，加上条件和循环，其实已经可以写很多程序了，但这样写出来的程序往往难以理解，尤其是程序逻辑比较复杂的时候。

解决复杂问题的基本策略是分而治之，将复杂问题分解为若干相对简单的子问题，然后子问题再分解为更小的子问题……程序由数据和指令组成，大程序可以分解为小程序，小程序接着分解为更小的程序。那如何表示子程序，以及子程序之间如何协调呢？我们下节介绍。
