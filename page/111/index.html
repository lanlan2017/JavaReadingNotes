<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 6.1.0">

<link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>
  <link rel="apple-touch-icon" sizes="180x180" href="/JavaReadingNotes/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/JavaReadingNotes/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/JavaReadingNotes/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/JavaReadingNotes/images/logo.svg" color="#222">
  <meta name="google-site-verification" content="_Sly-yzHYmALHXzjFpPWsodMrjBSphw7bfRbMUH80Qc">
  <meta name="msvalidate.01" content="B1CFD346B8DEBBFE0C983C2AF8955531">
  <meta name="baidu-site-verification" content="vkMTwK56xr">

<link rel="stylesheet" href="/JavaReadingNotes/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css" integrity="sha256-DfWjNxDkM94fVBWx1H5BMMp0Zq7luBlV8QRcSES7s+0=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/themes/blue/pace-theme-minimal.css">
  <script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"lanlan2017.github.io","root":"/JavaReadingNotes/","images":"/JavaReadingNotes/images","scheme":"Gemini","darkmode":true,"version":"8.11.0","exturl":false,"sidebar":{"position":"right","display":"post","padding":18,"offset":12},"copycode":true,"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":true,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/JavaReadingNotes/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/JavaReadingNotes/js/config.js"></script>

    <meta name="description" content="好好学习，天天向上">
<meta property="og:type" content="website">
<meta property="og:title" content="蓝蓝站点">
<meta property="og:url" content="https://lanlan2017.github.io/JavaReadingNotes/page/111/index.html">
<meta property="og:site_name" content="蓝蓝站点">
<meta property="og:description" content="好好学习，天天向上">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="蓝蓝">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://lanlan2017.github.io/JavaReadingNotes/page/111/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"zh-CN","comments":"","permalink":"","path":"page/111/index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>蓝蓝站点</title>
  

  <script src="/JavaReadingNotes/js/third-party/analytics/baidu-analytics.js"></script>
  <script async src="https://hm.baidu.com/hm.js?dadeb188eb14ccde0b25a19230c429b5"></script>



<link rel="dns-prefetch" href="https://waline-test-lanlan2017.vercel.app">
  <noscript>
    <link rel="stylesheet" href="/JavaReadingNotes/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/JavaReadingNotes/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">蓝蓝站点</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">Java读书笔记</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/JavaReadingNotes/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-dir"><a href="/JavaReadingNotes/dir/" rel="section"><i class="fa fa-sitemap fa-fw"></i>目录</a></li><li class="menu-item menu-item-categories"><a href="/JavaReadingNotes/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/JavaReadingNotes/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li><li class="menu-item menu-item-tags"><a href="/JavaReadingNotes/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="蓝蓝"
      src="/JavaReadingNotes/images/avatar.gif">
  <p class="site-author-name" itemprop="name">蓝蓝</p>
  <div class="site-description" itemprop="description">好好学习，天天向上</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/JavaReadingNotes/archives/">
          <span class="site-state-item-count">1875</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/JavaReadingNotes/categories/">
        <span class="site-state-item-count">630</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://lanlan2017.github.io/todo/" title="todo → https:&#x2F;&#x2F;lanlan2017.github.io&#x2F;todo&#x2F;"><i class="fa fa-check-square fa-fw"></i>todo</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://lanlan2017.github.io/links/" title="links → https:&#x2F;&#x2F;lanlan2017.github.io&#x2F;links&#x2F;"><i class="fa fa-link fa-fw"></i>links</a>
      </span>
  </div>
  <div class="cc-license site-overview-item animated" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" class="cc-opacity" rel="noopener" target="_blank"><img src="https://cdn.jsdelivr.net/npm/@creativecommons/vocabulary@2020.11.3/assets/license_badges/small/by_nc_sa.svg" alt="Creative Commons"></a>
  </div>



        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="返回顶部">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="reading-progress-bar"></div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://lanlan2017.github.io/JavaReadingNotes/71a6157d/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/JavaReadingNotes/images/avatar.gif">
      <meta itemprop="name" content="蓝蓝">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="蓝蓝站点">
      <meta itemprop="description" content="好好学习，天天向上">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 蓝蓝站点">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/JavaReadingNotes/71a6157d/" class="post-title-link" itemprop="url">7.5 Spring容器中的Bean</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2019-08-26 12:03:51" itemprop="dateCreated datePublished" datetime="2019-08-26T12:03:51+08:00">2019-08-26</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2020-02-07 01:34:58" itemprop="dateModified" datetime="2020-02-07T01:34:58+08:00">2020-02-07</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JavaReadingNotes/categories/2-%E8%BD%BB%E9%87%8F%E7%BA%A7Java-EE%E4%BC%81%E4%B8%9A%E5%BA%94%E7%94%A8%E5%AE%9E%E6%88%98-%E7%AC%AC5%E7%89%88/" itemprop="url" rel="index"><span itemprop="name">2 轻量级Java EE企业应用实战(第5版)</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JavaReadingNotes/categories/2-%E8%BD%BB%E9%87%8F%E7%BA%A7Java-EE%E4%BC%81%E4%B8%9A%E5%BA%94%E7%94%A8%E5%AE%9E%E6%88%98-%E7%AC%AC5%E7%89%88/%E7%AC%AC7%E7%AB%A0-Spring%E7%9A%84%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95/" itemprop="url" rel="index"><span itemprop="name">第7章 Spring的基本用法</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JavaReadingNotes/categories/2-%E8%BD%BB%E9%87%8F%E7%BA%A7Java-EE%E4%BC%81%E4%B8%9A%E5%BA%94%E7%94%A8%E5%AE%9E%E6%88%98-%E7%AC%AC5%E7%89%88/%E7%AC%AC7%E7%AB%A0-Spring%E7%9A%84%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95/7-5-Spring%E5%AE%B9%E5%99%A8%E4%B8%AD%E7%9A%84Bean/" itemprop="url" rel="index"><span itemprop="name">7.5 Spring容器中的Bean</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
    <span class="post-meta-item-icon">
      <i class="far fa-comment"></i>
    </span>
    <span class="post-meta-item-text">Waline：</span>
  
    <a title="waline" href="/JavaReadingNotes/71a6157d/#waline-comments" itemprop="discussionUrl">
      <span class="post-comments-count waline-comment-count" id="/JavaReadingNotes/71a6157d/" data-xid="/JavaReadingNotes/71a6157d/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>428</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>1 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="7-5-Spring容器中的Bean"><a href="#7-5-Spring容器中的Bean" class="headerlink" title="7.5 Spring容器中的Bean"></a>7.5 Spring容器中的Bean</h1><p>从本质上来看, <code>Spring</code>容器就是一个超级大工厂, <code>Spring</code>容器中的<code>Bean</code>就是该工厂的产品。<code>Spring</code>容器能产生哪些产品,则完全取决于开发者在配置文件中的配置。<br>对于开发者来说,开发者使用<code>Spring</code>框架主要是做两件事:</p>
<ul>
<li>开发<code>Bean</code>;</li>
<li>配置<code>Bean</code>。</li>
</ul>
<p>对于<code>Spring</code>框架来说,它要做的就是根据配置文件来创建<code>Bean</code>实例,并调用<code>Bean</code>实例的方法完成”依赖注入”——这就是所谓<code>IoC</code>的本质。这就要求开发者在使用<code>Spring</code>框架时,眼中看到的是<code>&quot;XML配置&quot;</code>,心中想的是<code>&quot;Java代码&quot;</code>。本书后面介绍<code>Spring</code>框架时,会尽量向读者揭示”每段<code>XML</code>配置”在底层所对应的”<code>Java</code>代码调用”。<br>其实<code>Spring</code>框架的本质就是,通过<code>XML</code>配置来驱动<code>Java</code>代码,这样就可以把原本由<code>Java</code>代码管理的耦合关系,提取到<code>XML</code>配置文件中管理,这就实现了系统中各组件的解耦,有利于后期的升级和维护.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://lanlan2017.github.io/JavaReadingNotes/7c13f2ca/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/JavaReadingNotes/images/avatar.gif">
      <meta itemprop="name" content="蓝蓝">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="蓝蓝站点">
      <meta itemprop="description" content="好好学习，天天向上">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 蓝蓝站点">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/JavaReadingNotes/7c13f2ca/" class="post-title-link" itemprop="url">7.4.5 让Bean获取Spring容器</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2019-08-25 23:11:12" itemprop="dateCreated datePublished" datetime="2019-08-25T23:11:12+08:00">2019-08-25</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2020-02-07 01:34:58" itemprop="dateModified" datetime="2020-02-07T01:34:58+08:00">2020-02-07</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JavaReadingNotes/categories/2-%E8%BD%BB%E9%87%8F%E7%BA%A7Java-EE%E4%BC%81%E4%B8%9A%E5%BA%94%E7%94%A8%E5%AE%9E%E6%88%98-%E7%AC%AC5%E7%89%88/" itemprop="url" rel="index"><span itemprop="name">2 轻量级Java EE企业应用实战(第5版)</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JavaReadingNotes/categories/2-%E8%BD%BB%E9%87%8F%E7%BA%A7Java-EE%E4%BC%81%E4%B8%9A%E5%BA%94%E7%94%A8%E5%AE%9E%E6%88%98-%E7%AC%AC5%E7%89%88/%E7%AC%AC7%E7%AB%A0-Spring%E7%9A%84%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95/" itemprop="url" rel="index"><span itemprop="name">第7章 Spring的基本用法</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JavaReadingNotes/categories/2-%E8%BD%BB%E9%87%8F%E7%BA%A7Java-EE%E4%BC%81%E4%B8%9A%E5%BA%94%E7%94%A8%E5%AE%9E%E6%88%98-%E7%AC%AC5%E7%89%88/%E7%AC%AC7%E7%AB%A0-Spring%E7%9A%84%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95/7-4-%E4%BD%BF%E7%94%A8Spring%E5%AE%B9%E5%99%A8/" itemprop="url" rel="index"><span itemprop="name">7.4 使用Spring容器</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
    <span class="post-meta-item-icon">
      <i class="far fa-comment"></i>
    </span>
    <span class="post-meta-item-text">Waline：</span>
  
    <a title="waline" href="/JavaReadingNotes/7c13f2ca/#waline-comments" itemprop="discussionUrl">
      <span class="post-comments-count waline-comment-count" id="/JavaReadingNotes/7c13f2ca/" data-xid="/JavaReadingNotes/7c13f2ca/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>3.8k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>3 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="7-4-5-让Bean获取Spring容器"><a href="#7-4-5-让Bean获取Spring容器" class="headerlink" title="7.4.5 让Bean获取Spring容器"></a>7.4.5 让Bean获取Spring容器</h1><p>前面介绍的几个示例,都是程序先创建<code>Spring</code>容器,再调用<code>Spring</code>容器的<code>getBean()</code>方法来获取<code>Spring</code>容器中的<code>Bean</code>。在这种访问模式下,程序中总是持有<code>Spring</code>容器的引用。<br>在某些特殊的情况下,<code>Bean</code>需要实现某个功能(比如该<code>Bean</code>需要输出国际化消息,或者该<code>Bean</code>需要向<code>Spring</code>容器发布事件…),但该功能必须借助于<code>Spring</code>容器才能实现,此时就必须<strong>让该<code>Bean</code>获取它所在的<code>Spring</code>容器</strong>,然后借助于<code>Spring</code>容器来实现该功能。</p>
<h2 id="如何获取Bean所在的Spring容器"><a href="#如何获取Bean所在的Spring容器" class="headerlink" title="如何获取Bean所在的Spring容器"></a>如何获取Bean所在的Spring容器</h2><p>为了让<code>Bean</code>获取它所在的<code>Spring</code>容器,可以让该<code>Bean</code>实现<code>BeanFactoryAware</code>接口。<code>BeanFactoryAware</code>接口里只有一个方法。</p>
<table>
<thead>
<tr>
<th align="left">方法</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>setBeanFactory(BeanFactory beanFactory)</code></td>
<td align="left">该方法有一个参数<code>beanFactory</code>,该参数指向创建它的<code>BeanFactory</code></td>
</tr>
</tbody></table>
<p>大部分初学者看到这个<code>setter</code>方法会感到比较奇怪,因为以前定义一个<code>setter</code>方法之后,该<code>setter</code>方法通常都是由程序员来调用的, <code>setter</code>方法参数由程序员指定;即使使用<code>Spring</code>进行依赖注入时, <code>setter</code>方法参数值也是由程序员通过配置文件来指定的。但此处的这个<code>setter</code>方法比较奇怪,<strong>这个方法将由<code>Spring</code>调用, <code>Spring</code>调用该方法时会将<code>Spring</code>容器作为参数传入该方法</strong>。与该接口类似的还有<code>BeanNameAware</code>、 <code>ResourceLoaderAware</code>接口,这些接口里都会提供类似的<code>setter</code>方法,这些方法也由<code>Spring</code>负责调用。<br>与<code>BeanFactoryAware</code>接口类似的有<code>ApplicationContextAware</code>接口,实现该接口的<code>Bean</code>需要实现<code>setApplicationContext(ApplicationContext applicationContex)</code>方法—该方法也不是由程序员负责调用的而是由<code>Spring</code>来调用的。当<code>Spring</code>容器调用该方法时,它会把自身作为参数传入该方法。</p>
<h1 id="程序示例"><a href="#程序示例" class="headerlink" title="程序示例"></a>程序示例</h1><p>下面示例假设<code>Person</code>类的<code>sayHi()</code>方法必须能输出国际化消息,由于国际化功能需要借助于<code>Spring</code>容器来实现,因此程序就需要让<code>Person</code>类实现<code>Application ContextAware</code>接口。下面是<code>Person</code>类的源代码。</p>
<h2 id="项目结构"><a href="#项目结构" class="headerlink" title="项目结构"></a>项目结构</h2><h2 id="Person-java"><a href="#Person-java" class="headerlink" title="Person.java"></a>Person.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> org.crazyit.app.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Locale;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.BeansException;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.ApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.ApplicationContextAware;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Person</span> <span class="keyword">implements</span> <span class="title class_">ApplicationContextAware</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 用成员变量保存它所在的ApplicationContext容器</span></span><br><span class="line">    <span class="keyword">private</span> ApplicationContext ctx;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">     * Spring容器会检测容器中所有Bean，如果发现某个Bean实现了ApplicationContextAware接口，</span></span><br><span class="line"><span class="comment">     * Spring容器会在创建该Bean之后，自动调用该方法，调用该方法时， 会将容器本身作为参数传给该方法。</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setApplicationContext</span><span class="params">(ApplicationContext ctx)</span></span><br><span class="line">            <span class="keyword">throws</span> BeansException</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">this</span>.ctx = ctx;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sayHi</span><span class="params">(String name)</span></span><br><span class="line">    &#123;</span><br><span class="line">        System.out.println(ctx.getMessage(<span class="string">&quot;hello&quot;</span>, </span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">String</span>[]&#123;name&#125;, Locale.getDefault(Locale.Category.FORMAT)));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>上面的<code>Person</code>类实现了<code>ApplicationContextAware</code>接口,并实现了该接口提供的<code>setApplicationContextAware()</code>方法.<br><code>Spring</code>容器会检测容器中所有的<code>Bean</code>,如果发现某个<code>Bean</code>实现了<code>ApplicationContextAware</code>接口,<code>Spring</code>容器会在创建该<code>Bean</code>之后,自动调用该<code>Bean</code>的<code>setApplicationContextAware()</code>方法,调用该方法时,会将容器本身作为参数传给该方法——该方法的实现部分将<code>Spring</code>传入的参数(容器本身)赋给该<code>Person</code>对象的<code>ctx</code>实例变量,因此接下来即可通过该<code>ctx</code>实例变量来访问容器本身。<br>将该<code>Bean</code>部署在<code>Spring</code>容器中,部署该<code>Bean</code>与部署其他<code>Bean</code>没有任何区别。</p>
<h2 id="beans-xml"><a href="#beans-xml" class="headerlink" title="beans.xml"></a>beans.xml</h2><p><code>XML</code>配置文件如下:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;GBK&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">    http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 加载容器国际化所需要的语言资源文件 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;messageSource&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">class</span>=<span class="string">&quot;org.springframework.context.support.ResourceBundleMessageSource&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;basenames&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">list</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>message<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">list</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 设置国际化文件编码 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;defaultEncoding&quot;</span> <span class="attr">value</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- Spring容器会检测容器中所有Bean，如果发现某个Bean实现了ApplicationContextAware接口，</span></span><br><span class="line"><span class="comment">        Spring容器会在创建该Bean之后， 自动调用该Bean的setApplicationContext()方法，</span></span><br><span class="line"><span class="comment">        调用该方法时， 会将容器本身作为参数传给该方法。 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;person&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.crazyit.app.service.Person&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>主程序部分进行简单测试,程序先通过实例化的方法来获得<code>ApplicationContext</code>,然后再通过<code>personBean</code>来获得<code>BeanFactory</code>,并将二者进行比较。主程序如下。</p>
<h2 id="SpringTest-java"><a href="#SpringTest-java" class="headerlink" title="SpringTest.java"></a>SpringTest.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> lee;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.crazyit.app.service.Person;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.ApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringTest</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span><span class="keyword">throws</span> Exception</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="meta">@SuppressWarnings(&quot;resource&quot;)</span></span><br><span class="line">        <span class="type">ApplicationContext</span> <span class="variable">ctx</span> <span class="operator">=</span> <span class="keyword">new</span></span><br><span class="line">            <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;beans.xml&quot;</span>);</span><br><span class="line">        <span class="type">Person</span> <span class="variable">p</span> <span class="operator">=</span> ctx.getBean(<span class="string">&quot;person&quot;</span> , Person.class);</span><br><span class="line">        p.sayHi(<span class="string">&quot;孙悟空&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Bean获取它所在容器的好处"><a href="#Bean获取它所在容器的好处" class="headerlink" title="Bean获取它所在容器的好处"></a>Bean获取它所在容器的好处</h2><p>上面程序<strong>执行<code>Person</code>对象的<code>sayHi()</code>方法时,该<code>sayHi()</code>方法就自动具有了国际化的功能,而这种国际化的功能实际上是由<code>Spring</code>容器提供的,这就是让<code>Bean</code>获取它所在容器的好处</strong>。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://lanlan2017.github.io/JavaReadingNotes/103a103a/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/JavaReadingNotes/images/avatar.gif">
      <meta itemprop="name" content="蓝蓝">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="蓝蓝站点">
      <meta itemprop="description" content="好好学习，天天向上">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 蓝蓝站点">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/JavaReadingNotes/103a103a/" class="post-title-link" itemprop="url">7.4.4 ApplicationContext的事件机制</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2019-08-25 20:22:31" itemprop="dateCreated datePublished" datetime="2019-08-25T20:22:31+08:00">2019-08-25</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2020-02-07 01:34:58" itemprop="dateModified" datetime="2020-02-07T01:34:58+08:00">2020-02-07</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JavaReadingNotes/categories/2-%E8%BD%BB%E9%87%8F%E7%BA%A7Java-EE%E4%BC%81%E4%B8%9A%E5%BA%94%E7%94%A8%E5%AE%9E%E6%88%98-%E7%AC%AC5%E7%89%88/" itemprop="url" rel="index"><span itemprop="name">2 轻量级Java EE企业应用实战(第5版)</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JavaReadingNotes/categories/2-%E8%BD%BB%E9%87%8F%E7%BA%A7Java-EE%E4%BC%81%E4%B8%9A%E5%BA%94%E7%94%A8%E5%AE%9E%E6%88%98-%E7%AC%AC5%E7%89%88/%E7%AC%AC7%E7%AB%A0-Spring%E7%9A%84%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95/" itemprop="url" rel="index"><span itemprop="name">第7章 Spring的基本用法</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JavaReadingNotes/categories/2-%E8%BD%BB%E9%87%8F%E7%BA%A7Java-EE%E4%BC%81%E4%B8%9A%E5%BA%94%E7%94%A8%E5%AE%9E%E6%88%98-%E7%AC%AC5%E7%89%88/%E7%AC%AC7%E7%AB%A0-Spring%E7%9A%84%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95/7-4-%E4%BD%BF%E7%94%A8Spring%E5%AE%B9%E5%99%A8/" itemprop="url" rel="index"><span itemprop="name">7.4 使用Spring容器</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
    <span class="post-meta-item-icon">
      <i class="far fa-comment"></i>
    </span>
    <span class="post-meta-item-text">Waline：</span>
  
    <a title="waline" href="/JavaReadingNotes/103a103a/#waline-comments" itemprop="discussionUrl">
      <span class="post-comments-count waline-comment-count" id="/JavaReadingNotes/103a103a/" data-xid="/JavaReadingNotes/103a103a/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>4k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>4 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="7-4-4-ApplicationContext的事件机制"><a href="#7-4-4-ApplicationContext的事件机制" class="headerlink" title="7.4.4 ApplicationContext的事件机制"></a>7.4.4 ApplicationContext的事件机制</h1><p><code>ApplicationContext</code>的事件机制是<code>观察者设计模式</code>的实现,通过<code>ApplicationEvent</code>类和<code>ApplicationListener</code>接口,可以实现<code>ApplicationContext</code>的事件处理。如果容器中有一个<code>ApplicationListener</code> <code>Bean</code>每当<code>ApplicationContext</code>发布<code>ApplicationEvent</code>时, <code>ApplicationListener</code> <code>Bean</code>将自动被触发。<br><code>Spring</code>的事件框架有如下两个重要成员。</p>
<ul>
<li><code>ApplicationEvent</code>:容器事件,必须由<code>ApplicationContext</code>发布。</li>
<li><code>ApplicationListener</code>:监听器,可由容器中的任何监听器<code>Bean</code>担任。</li>
</ul>
<p>实际上, <code>Spring</code>的事件机制与所有的事件机制都基本相似,它们都需要由<code>事件源</code>、<code>事件</code>和<code>事件监听器</code>组成。只是此处的事件源是<code>ApplicationContext</code>,且事件必须由<code>Java</code>程序显式触发。</p>
<h1 id="程序示例"><a href="#程序示例" class="headerlink" title="程序示例"></a>程序示例</h1><h2 id="项目结构"><a href="#项目结构" class="headerlink" title="项目结构"></a>项目结构</h2><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">E:\<span class="title">workspace_QingLiangJiJavaEEQiYeYingYongShiZhang5</span>\<span class="title">EventHandler</span></span></span><br><span class="line"><span class="function">└─<span class="title">src</span>\</span></span><br><span class="line"><span class="function">  ├─<span class="title">beans.xml</span></span></span><br><span class="line"><span class="function">  ├─<span class="title">lee</span>\</span></span><br><span class="line"><span class="function">  │ └─<span class="title">SpringTest.java</span></span></span><br><span class="line"><span class="function">  └─<span class="title">org</span>\</span></span><br><span class="line"><span class="function">    └─<span class="title">crazyit</span>\</span></span><br><span class="line"><span class="function">      └─<span class="title">app</span>\</span></span><br><span class="line"><span class="function">        ├─<span class="title">event</span>\</span></span><br><span class="line"><span class="function">        │ └─<span class="title">EmailEvent.java</span></span></span><br><span class="line"><span class="function">        └─<span class="title">listener</span>\</span></span><br><span class="line"><span class="function">          └─<span class="title">EmailNotifier.java</span></span></span><br></pre></td></tr></table></figure>
<p>下面的程序将示范<code>Spring</code>容器的事件机制。程序先定义了一个<code>ApplicationEvent</code>类,其对象就是个<code>Spring</code>容器事件。 <code>ApplicationEvent</code>类的代码如下。</p>
<h2 id="beans-xml"><a href="#beans-xml" class="headerlink" title="beans.xml"></a>beans.xml</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> org.crazyit.app.event;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.ApplicationEvent;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EmailEvent</span> <span class="keyword">extends</span> <span class="title class_">ApplicationEvent</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">serialVersionUID</span> <span class="operator">=</span> <span class="number">1L</span>;</span><br><span class="line">    <span class="keyword">private</span> String address;</span><br><span class="line">    <span class="keyword">private</span> String text;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">EmailEvent</span><span class="params">(Object source)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">super</span>(source);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 初始化全部成员变量的构造器</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">EmailEvent</span><span class="params">(Object source, String address, String text)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">super</span>(source);</span><br><span class="line">        <span class="built_in">this</span>.address = address;</span><br><span class="line">        <span class="built_in">this</span>.text = text;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 此处省略getter和setter方法,请自己补上</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>上面的<code>EmailEvent</code>类继承了<code>ApplicationEvent</code>类,除此之外,它就是一个普通的<code>Java</code>类。</p>
<h2 id="如何创建Spring容器的容器事件"><a href="#如何创建Spring容器的容器事件" class="headerlink" title="如何创建Spring容器的容器事件"></a>如何创建Spring容器的容器事件</h2><p>只要个<code>Java</code>类继承了<code>ApplicationEvent</code>基类,那该对象就可作为<code>Spring</code>容器的容器事件。</p>
<h2 id="容器事件的监听器"><a href="#容器事件的监听器" class="headerlink" title="容器事件的监听器"></a>容器事件的监听器</h2><p>容器事件的监听器类必须实现<code>ApplicationListener</code>接口,实现该接口必须实现如下方法。<br><code>onApplicationEvent(ApplicationEvent event)</code>:每当容器内发生任何事件时,此方法都被触发</p>
<h2 id="EmailNotifier-java"><a href="#EmailNotifier-java" class="headerlink" title="EmailNotifier.java"></a>EmailNotifier.java</h2><p>本示例所用的容器监听器类的代码如下:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> org.crazyit.app.listener;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.crazyit.app.event.EmailEvent;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.ApplicationEvent;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.ApplicationListener;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EmailNotifier</span> <span class="keyword">implements</span> <span class="title class_">ApplicationListener</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 该方法会在容器发生事件时自动触发</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onApplicationEvent</span><span class="params">(ApplicationEvent evt)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// 只处理EmailEvent，模拟发送email通知...</span></span><br><span class="line">        <span class="keyword">if</span> (evt <span class="keyword">instanceof</span> EmailEvent)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">EmailEvent</span> <span class="variable">emailEvent</span> <span class="operator">=</span> (EmailEvent) evt;</span><br><span class="line">            System.out.println(<span class="string">&quot;需要发送邮件的接收地址  &quot;</span> + emailEvent.getAddress());</span><br><span class="line">            System.out.println(<span class="string">&quot;需要发送邮件的邮件正文  &quot;</span> + emailEvent.getText());</span><br><span class="line">        &#125; <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 其他事件不作任何处理</span></span><br><span class="line">            System.out.println(<span class="string">&quot;其他事件：&quot;</span> + evt);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>将监听器配置在容器中,配置文件如下。</p>
<h2 id="beans-xml-1"><a href="#beans-xml-1" class="headerlink" title="beans.xml"></a>beans.xml</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;GBK&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">    http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 配置监听器 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.crazyit.app.listener.EmailNotifier&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>从上面的粗体字代码可以看出,为<code>Spring</code>容器注册事件监听器,不需要像<code>AWT</code>编程那样采用代码进行编程,只要进行简单配置即可。<strong>只要在<code>Spring</code>中配置一个实现了<code>ApplicationListener</code>接口的<code>Bean</code>,<code>Spring</code>容器就会把这个<code>Bean</code>当成<code>容器事件</code>的事件监听器</strong>。<br>当系统<strong>创建<code>Spring</code>容器</strong>、<strong>加载<code>Spring</code>容器</strong>时会自动触发容器事件,容器事件监听器可以监听到这些事件。除此之外,程序也可调用<code>ApplicationContext</code>的<code>pulishEvent()</code>方法来主动触发容器事件。如下主程序使用<code>ApplicationContext</code>的<code>publishEvent()</code>来触发事件。</p>
<h2 id="SpringTest-java"><a href="#SpringTest-java" class="headerlink" title="SpringTest.java"></a>SpringTest.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> lee;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.crazyit.app.event.EmailEvent;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.ApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringTest</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="meta">@SuppressWarnings(&quot;resource&quot;)</span></span><br><span class="line">        <span class="type">ApplicationContext</span> <span class="variable">ctx</span> <span class="operator">=</span> <span class="keyword">new</span></span><br><span class="line">            <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;beans.xml&quot;</span>);</span><br><span class="line">        <span class="comment">// 创建一个ApplicationEvent对象</span></span><br><span class="line">        <span class="type">EmailEvent</span> <span class="variable">ele</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">EmailEvent</span>(<span class="string">&quot;test&quot;</span> ,</span><br><span class="line">            <span class="string">&quot;spring_test@163.com&quot;</span> , <span class="string">&quot;this is a test&quot;</span>);</span><br><span class="line">        <span class="comment">// 发布容器事件</span></span><br><span class="line">        ctx.publishEvent(ele);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>上面程序中的两行粗体字代码创建了<code>ApplicationEvent</code>对象,并通过<code>ApplictionContex</code>主动触发了该事件。运行上面的程序,将看到如下执行结果:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">其他事件：org.springframework.context.event.ContextRefreshedEvent[source=org.springframework.context.support.ClassPathXmlApplicationContext@439f5b3d, started on Sun Aug 25 23:06:44 CST 2019]</span><br><span class="line">需要发送邮件的接收地址  spring_test@163.com</span><br><span class="line">需要发送邮件的邮件正文  this is a test</span><br></pre></td></tr></table></figure>
<p>从上面的执行结果可以看出,监听器不仅监听到程序所触发的事件,也监听到容器内置的事件。实际上,如果开发者需要在<code>Spring</code>容器初始化、销毁时回调自定义方法,就可以通过上面的事件监听器来实现<br>提示:一如果<code>Bean</code>希望发布容器事件,则该<code>Bean</code>必须先获得对<code>Spring</code>容器的引用。为了让<code>Bean</code>获得对<code>Spring</code>容器的引用,可让<code>Bean</code>类实现<code>ApplicationContextAware</code>或<code>BeanFactoryAware</code>接口。</p>
<h2 id="Spring内置事件"><a href="#Spring内置事件" class="headerlink" title="Spring内置事件"></a>Spring内置事件</h2><p><code>Spring</code>提供如下几个内置事件:<br>这里先省略,后续用到再更新…</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://lanlan2017.github.io/JavaReadingNotes/22e47721/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/JavaReadingNotes/images/avatar.gif">
      <meta itemprop="name" content="蓝蓝">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="蓝蓝站点">
      <meta itemprop="description" content="好好学习，天天向上">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 蓝蓝站点">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/JavaReadingNotes/22e47721/" class="post-title-link" itemprop="url">7.4.3 ApplicationContext的国际化支持</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2019-08-25 13:04:02" itemprop="dateCreated datePublished" datetime="2019-08-25T13:04:02+08:00">2019-08-25</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2020-02-07 01:34:58" itemprop="dateModified" datetime="2020-02-07T01:34:58+08:00">2020-02-07</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JavaReadingNotes/categories/2-%E8%BD%BB%E9%87%8F%E7%BA%A7Java-EE%E4%BC%81%E4%B8%9A%E5%BA%94%E7%94%A8%E5%AE%9E%E6%88%98-%E7%AC%AC5%E7%89%88/" itemprop="url" rel="index"><span itemprop="name">2 轻量级Java EE企业应用实战(第5版)</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JavaReadingNotes/categories/2-%E8%BD%BB%E9%87%8F%E7%BA%A7Java-EE%E4%BC%81%E4%B8%9A%E5%BA%94%E7%94%A8%E5%AE%9E%E6%88%98-%E7%AC%AC5%E7%89%88/%E7%AC%AC7%E7%AB%A0-Spring%E7%9A%84%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95/" itemprop="url" rel="index"><span itemprop="name">第7章 Spring的基本用法</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JavaReadingNotes/categories/2-%E8%BD%BB%E9%87%8F%E7%BA%A7Java-EE%E4%BC%81%E4%B8%9A%E5%BA%94%E7%94%A8%E5%AE%9E%E6%88%98-%E7%AC%AC5%E7%89%88/%E7%AC%AC7%E7%AB%A0-Spring%E7%9A%84%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95/7-4-%E4%BD%BF%E7%94%A8Spring%E5%AE%B9%E5%99%A8/" itemprop="url" rel="index"><span itemprop="name">7.4 使用Spring容器</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
    <span class="post-meta-item-icon">
      <i class="far fa-comment"></i>
    </span>
    <span class="post-meta-item-text">Waline：</span>
  
    <a title="waline" href="/JavaReadingNotes/22e47721/#waline-comments" itemprop="discussionUrl">
      <span class="post-comments-count waline-comment-count" id="/JavaReadingNotes/22e47721/" data-xid="/JavaReadingNotes/22e47721/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>3k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>3 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="7-4-3-ApplicationContext的国际化支持"><a href="#7-4-3-ApplicationContext的国际化支持" class="headerlink" title="7.4.3 ApplicationContext的国际化支持"></a>7.4.3 ApplicationContext的国际化支持</h1><p><code>ApplicationContext</code>接口继承了<code>MessageSource</code>接口,因此具有国际化功能。</p>
<h2 id="MessageSource接口中用于国际化的方法"><a href="#MessageSource接口中用于国际化的方法" class="headerlink" title="MessageSource接口中用于国际化的方法"></a>MessageSource接口中用于国际化的方法</h2><p>下面是<code>MessageSource</code>接口中定义的两个用于国际化的方法。</p>
<ul>
<li><code>String getMessage(String code,Object[] args, Locale locale)</code></li>
<li><code>String getMessage(String code,Object[] args,String default,Locale locale)</code></li>
</ul>
<p><code>ApplicationContext</code>正是通过这两个方法来完成国际化的,当程序创建<code>ApplicationContext</code>容器时<code>Spring</code>自动查找配置文件中名为<code>messageSource</code>的<code>Bean</code>实例,</p>
<ul>
<li>一旦找到这个<code>Bean</code>实例,上述两个方法的调用就被委托给该<code>messageSource Bean</code>。</li>
<li>如果没有该<code>Bean</code>,<code>ApplicationContex</code>会查找其父容器中的<code>messageSource Bean</code>;如果找到,它将被作为<code>messageSource Bean</code>使用。</li>
<li>如果无法找到<code>messageSource Bean</code>,系统将会创建一个空的<code>StaticMessageSourceBean</code>,该<code>Bean</code>能接受上述两个方法的调用。</li>
</ul>
<p>在<code>Spring</code>中配置<code>messageSource bean</code>时通常使用<code>ResourceBundleMessageSource</code>类。</p>
<h1 id="程序示例"><a href="#程序示例" class="headerlink" title="程序示例"></a>程序示例</h1><h2 id="项目结构"><a href="#项目结构" class="headerlink" title="项目结构"></a>项目结构</h2><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">E:\<span class="title">workspace_QingLiangJiJavaEEQiYeYingYongShiZhang5</span>\<span class="title">I18N</span></span></span><br><span class="line"><span class="function">└─<span class="title">src</span>\</span></span><br><span class="line"><span class="function">  ├─<span class="title">beans.xml</span></span></span><br><span class="line"><span class="function">  ├─<span class="title">lee</span>\</span></span><br><span class="line"><span class="function">  │ └─<span class="title">SpringTest.java</span></span></span><br><span class="line"><span class="function">  ├─<span class="title">message_en_US.properties</span></span></span><br><span class="line"><span class="function">  └─<span class="title">message_zh_CN.properties</span></span></span><br></pre></td></tr></table></figure>
<h2 id="beans-xml"><a href="#beans-xml" class="headerlink" title="beans.xml"></a>beans.xml</h2><p>看下面的配置文件。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;GBK&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">    http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;messageSource&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">class</span>=<span class="string">&quot;org.springframework.context.support.ResourceBundleMessageSource&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 驱动Spring调用messageSource Bean的setBasenames()方法， 该方法需要一个数组参数，使用list元素配置多个数组元素 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;basenames&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">list</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>message<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">                <span class="comment">&lt;!-- 如果有多个资源文件，全部列在此处 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">list</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 设置国际化文件编码 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;defaultEncoding&quot;</span> <span class="attr">value</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>上面文件的粗体字代码定义了一个<code>id</code>为<code>messageSource</code>的<code>Bean</code>,该<code>Bean</code>实例只指定了一份国际化资源文件,其<code>baseName</code>是<code>message</code>.<br>然后给出如下两份资源文件。</p>
<h2 id="message-en-US-properties"><a href="#message-en-US-properties" class="headerlink" title="message_en_US.properties"></a>message_en_US.properties</h2><p>第一份为美式英语的资源文件:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hello=welcome,&#123;0&#125;</span><br><span class="line">now=now is :&#123;0&#125;</span><br></pre></td></tr></table></figure>
<h2 id="message-zh-CN-properties"><a href="#message-zh-CN-properties" class="headerlink" title="message_zh_CN.properties"></a>message_zh_CN.properties</h2><p>第二份为简体中文的资源文件:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hello=欢迎你，&#123;0&#125;</span><br><span class="line">now=现在时间是：&#123;0&#125;</span><br></pre></td></tr></table></figure>
<p>由于<code>Java9</code>支持使用<code>UTF-8</code>字符集保存国际化资源文件,这种国际化资源文件可以包含非西欧字符,因此只要将这份文件以<code>UTF-8</code>字符集保存即可。此时,程序拥有了两份资源文件,可以自适应美式英语和简体中文的环境。主程序部分如下。</p>
<h2 id="SpringTest-java"><a href="#SpringTest-java" class="headerlink" title="SpringTest.java"></a>SpringTest.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> lee;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.ApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;</span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringTest</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// 实例化ApplicationContext</span></span><br><span class="line">        <span class="meta">@SuppressWarnings(&quot;resource&quot;)</span></span><br><span class="line">        <span class="type">ApplicationContext</span> <span class="variable">ctx</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(</span><br><span class="line">                <span class="string">&quot;beans.xml&quot;</span>);</span><br><span class="line">        <span class="comment">// 使用getMessage()方法获取本地化消息。</span></span><br><span class="line">        <span class="comment">// Locale的getDefault方法返回计算机环境的默认Locale</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">hello</span> <span class="operator">=</span> ctx.getMessage(<span class="string">&quot;hello&quot;</span>, <span class="keyword">new</span> <span class="title class_">String</span>[]&#123;<span class="string">&quot;孙悟空&quot;</span>&#125;, </span><br><span class="line">                Locale.getDefault(Locale.Category.FORMAT));</span><br><span class="line">        <span class="type">String</span> <span class="variable">now</span> <span class="operator">=</span> ctx.getMessage(<span class="string">&quot;now&quot;</span>, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="keyword">new</span> <span class="title class_">Date</span>()&#125;,</span><br><span class="line">                Locale.getDefault(Locale.Category.FORMAT));</span><br><span class="line">        <span class="comment">// 打印出两条本地化消息</span></span><br><span class="line">        System.out.println(hello);</span><br><span class="line">        System.out.println(now);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>上面的两行粗体字代码是<code>Spring</code>容器提供的获取国际化消息的方法,这两个方法由<code>MessageSource</code>接口提供。<br>上面程序的执行结果会随环境不同而改变,在简体中文的环境下,执行结果如下:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">欢迎你，孙悟空</span><br><span class="line">现在时间是：19-8-25 下午11:29</span><br></pre></td></tr></table></figure>
<p><strong>注意</strong><br><code>Spring</code>的国际化支持,其实是建立在<code>Java</code>程序国际化的基础之上的。其核心思路都是将程序中需要实现国际化的信息写入资源文件,而代码中仅仅使用相应的各信息的<code>Key</code></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://lanlan2017.github.io/JavaReadingNotes/6fb8d1da/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/JavaReadingNotes/images/avatar.gif">
      <meta itemprop="name" content="蓝蓝">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="蓝蓝站点">
      <meta itemprop="description" content="好好学习，天天向上">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 蓝蓝站点">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/JavaReadingNotes/6fb8d1da/" class="post-title-link" itemprop="url">7.4.2 使用ApplicationContext</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2019-08-25 11:45:02" itemprop="dateCreated datePublished" datetime="2019-08-25T11:45:02+08:00">2019-08-25</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2020-02-07 01:34:58" itemprop="dateModified" datetime="2020-02-07T01:34:58+08:00">2020-02-07</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JavaReadingNotes/categories/2-%E8%BD%BB%E9%87%8F%E7%BA%A7Java-EE%E4%BC%81%E4%B8%9A%E5%BA%94%E7%94%A8%E5%AE%9E%E6%88%98-%E7%AC%AC5%E7%89%88/" itemprop="url" rel="index"><span itemprop="name">2 轻量级Java EE企业应用实战(第5版)</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JavaReadingNotes/categories/2-%E8%BD%BB%E9%87%8F%E7%BA%A7Java-EE%E4%BC%81%E4%B8%9A%E5%BA%94%E7%94%A8%E5%AE%9E%E6%88%98-%E7%AC%AC5%E7%89%88/%E7%AC%AC7%E7%AB%A0-Spring%E7%9A%84%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95/" itemprop="url" rel="index"><span itemprop="name">第7章 Spring的基本用法</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JavaReadingNotes/categories/2-%E8%BD%BB%E9%87%8F%E7%BA%A7Java-EE%E4%BC%81%E4%B8%9A%E5%BA%94%E7%94%A8%E5%AE%9E%E6%88%98-%E7%AC%AC5%E7%89%88/%E7%AC%AC7%E7%AB%A0-Spring%E7%9A%84%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95/7-4-%E4%BD%BF%E7%94%A8Spring%E5%AE%B9%E5%99%A8/" itemprop="url" rel="index"><span itemprop="name">7.4 使用Spring容器</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
    <span class="post-meta-item-icon">
      <i class="far fa-comment"></i>
    </span>
    <span class="post-meta-item-text">Waline：</span>
  
    <a title="waline" href="/JavaReadingNotes/6fb8d1da/#waline-comments" itemprop="discussionUrl">
      <span class="post-comments-count waline-comment-count" id="/JavaReadingNotes/6fb8d1da/" data-xid="/JavaReadingNotes/6fb8d1da/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>2.7k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>2 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="7-4-2-使用ApplicationContext"><a href="#7-4-2-使用ApplicationContext" class="headerlink" title="7.4.2 使用ApplicationContext"></a>7.4.2 使用ApplicationContext</h1><p>大部分时候,都不会使用<code>BeanFactory</code>实例作为<code>Spring</code>容器,而是使用<code>ApplicationContext</code>实例作为容器,因此<code>Spring</code>容器也称为<code>Spring</code>上下文。 <code>ApplicationContext</code>作为<code>BeanFactory</code>的子接口,增强了<code>BeanFactory</code>的功能。<br><code>ApplicationContext</code>允许以声明式方式操作容器,无须手动创建它。可利用如<code>ContextLoader</code>的支持类,在<code>Web</code>应用启动时自动创建<code>ApplicationContext</code>。当然也可采用编程方式创建<code>ApplicationContext</code>.</p>
<h2 id="ApplicationContext额外功能"><a href="#ApplicationContext额外功能" class="headerlink" title="ApplicationContext额外功能"></a>ApplicationContext额外功能</h2><p>除了提供<code>BeanFactory</code>所支持的全部功能外, <code>ApplicationContext</code>还有如下额外的功能。</p>
<ol>
<li><strong><code>ApplicationContext</code>默认会预初始化所有的<code>singleton Bean</code></strong>,也可通过配置取消预初始化<code>ApplicationContext</code>继承<code>MessageSource</code>接口,因此提供国际化支持。</li>
<li>资源访问,比如访问<code>URL</code>和文件。</li>
<li>事件机制。</li>
<li>同时加载多个配置文件。</li>
<li>以声明式方式启动并创建<code>Spring</code>容器。</li>
</ol>
<p><code>ApplicationContext</code>包括<code>BeanFactory</code>的全部功能,因此建议优先使用<code>ApplicationContext</code>。除非对于某些内存非常关键的应用,才考虑使用<code>BeanFactory</code>.</p>
<h2 id="程序示例"><a href="#程序示例" class="headerlink" title="程序示例"></a>程序示例</h2><h3 id="项目结构"><a href="#项目结构" class="headerlink" title="项目结构"></a>项目结构</h3><p>例如有如下配置。</p>
<h3 id="beans-xml"><a href="#beans-xml" class="headerlink" title="beans.xml"></a>beans.xml</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;GBK&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">    http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 如果不加任何特殊的配置，该Bean默认是singleton行为的 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;chinese&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.crazyit.app.service.Person&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 驱动Spring执行chinese Bean的setTest()方法，以&quot;孙悟空&quot;为传入参数 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;test&quot;</span> <span class="attr">value</span>=<span class="string">&quot;孙悟空&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>上面粗体字代码配置了一个<code>id</code>为<code>chinese</code>的<code>bean</code>,如果没有任何特殊配置,该<code>Bean</code>就是<code>singleton Bean</code>,<code>ApplicationContext</code>会在容器初始化完成后,自动调用<code>Person</code>类的构造器创建<code>chinese</code>这个<code>Bean</code>,并以<code>&quot;孙悟空&quot;</code>这个字符串作为传入参数去调用<code>chinese</code>这个<code>bean</code>的<code>setTest</code>方法。</p>
<h3 id="Person-java"><a href="#Person-java" class="headerlink" title="Person.java"></a>Person.java</h3><p>该程序用的<code>Person</code>类的代码如下。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> org.crazyit.app.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Person</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Person</span><span class="params">()</span></span><br><span class="line">    &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;==正在执行Person无参数的构造器==&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setTest</span><span class="params">(String name)</span></span><br><span class="line">    &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;正在调用setName()方法，传入参数为：&quot;</span> + name);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h3><p>即使主程序只有如下一行代码:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ApplicationContext</span> <span class="variable">ctx</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;beans.xml&quot;</span>);</span><br></pre></td></tr></table></figure>
<p>上面代码只是使用<code>ApplicationContext</code>创建了<code>Spring</code>容器, <code>ApplicationContext</code>会自动预初始化容器中的<code>chinese</code>这个<code>bean</code>包括：</p>
<ol>
<li>调用它的无参数的构造器,</li>
<li>根据<code>&lt; property.&gt;</code>元素执行<code>setter</code>方法。</li>
</ol>
<p>执行上面代码,可以看到如下输出:</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">==正在执行Person无参数的构造器==</span><br><span class="line">正在调用setName()方法，传入参数为：孙悟空</span><br></pre></td></tr></table></figure>
<p>如果将<code>main</code>方法中创建<code>Spring</code>容器的代码换成<strong>使用<code>BeanFactory</code>作为容器</strong>,例如改为如下代码:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 搜索类加载路径下的beans.xml文件创建Resource对象</span></span><br><span class="line"><span class="type">Resource</span> <span class="variable">isr</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathResource</span>(<span class="string">&quot;beans.xml&quot;</span>);</span><br><span class="line"><span class="comment">// 创建默认的BeanFactory容器</span></span><br><span class="line"><span class="type">DefaultListableBeanFactory</span> <span class="variable">beanFactory</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DefaultListableBeanFactory</span>();</span><br><span class="line"><span class="comment">// 让默认的BeanFactory容器加载默认的</span></span><br><span class="line"><span class="keyword">new</span> <span class="title class_">XmlBeanDefinitionReader</span>(beanFactory).loadBeanDefinitions(isr);</span><br></pre></td></tr></table></figure>
<p>上面代码以<code>BeanFactory</code>创建了<code>Spring</code>容器,但**<code>BeanFactory</code>不会预初始化容器中的<code>Bean</code>**,因此执行上面代码不会看到调用<code>Person</code>类的构造器、执行<code>chinese</code>这个<code>bean</code>的<code>setName</code>方法。</p>
<h2 id="如何阻止Spring容器预初始化Bean"><a href="#如何阻止Spring容器预初始化Bean" class="headerlink" title="如何阻止Spring容器预初始化Bean"></a>如何阻止Spring容器预初始化Bean</h2><p>为了阻止<code>Spring</code>容器预初始化容器中的<code>singleton Bean</code>,可以**为<code>&lt;bean&gt;</code>元素指定<code>lazy-init=&quot;true&quot;</code>属性,该属性用于阻止容器预初始化该<code>Bean</code>**。因此,<strong>如果为上面<code>&lt;bean&gt;</code>元素指定了<code>lazy-init=&quot;true&quot;</code>,那么即使使用<code>ApplicationContext</code>作为<code>Spring</code>容器, <code>Spring</code>也不会预初始化该<code>singleton Bean</code></strong>.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://lanlan2017.github.io/JavaReadingNotes/5de7f076/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/JavaReadingNotes/images/avatar.gif">
      <meta itemprop="name" content="蓝蓝">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="蓝蓝站点">
      <meta itemprop="description" content="好好学习，天天向上">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 蓝蓝站点">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/JavaReadingNotes/5de7f076/" class="post-title-link" itemprop="url">7.4.1 Spring容器</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2019-08-25 11:09:42" itemprop="dateCreated datePublished" datetime="2019-08-25T11:09:42+08:00">2019-08-25</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2020-02-07 01:34:58" itemprop="dateModified" datetime="2020-02-07T01:34:58+08:00">2020-02-07</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JavaReadingNotes/categories/2-%E8%BD%BB%E9%87%8F%E7%BA%A7Java-EE%E4%BC%81%E4%B8%9A%E5%BA%94%E7%94%A8%E5%AE%9E%E6%88%98-%E7%AC%AC5%E7%89%88/" itemprop="url" rel="index"><span itemprop="name">2 轻量级Java EE企业应用实战(第5版)</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JavaReadingNotes/categories/2-%E8%BD%BB%E9%87%8F%E7%BA%A7Java-EE%E4%BC%81%E4%B8%9A%E5%BA%94%E7%94%A8%E5%AE%9E%E6%88%98-%E7%AC%AC5%E7%89%88/%E7%AC%AC7%E7%AB%A0-Spring%E7%9A%84%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95/" itemprop="url" rel="index"><span itemprop="name">第7章 Spring的基本用法</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JavaReadingNotes/categories/2-%E8%BD%BB%E9%87%8F%E7%BA%A7Java-EE%E4%BC%81%E4%B8%9A%E5%BA%94%E7%94%A8%E5%AE%9E%E6%88%98-%E7%AC%AC5%E7%89%88/%E7%AC%AC7%E7%AB%A0-Spring%E7%9A%84%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95/7-4-%E4%BD%BF%E7%94%A8Spring%E5%AE%B9%E5%99%A8/" itemprop="url" rel="index"><span itemprop="name">7.4 使用Spring容器</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
    <span class="post-meta-item-icon">
      <i class="far fa-comment"></i>
    </span>
    <span class="post-meta-item-text">Waline：</span>
  
    <a title="waline" href="/JavaReadingNotes/5de7f076/#waline-comments" itemprop="discussionUrl">
      <span class="post-comments-count waline-comment-count" id="/JavaReadingNotes/5de7f076/" data-xid="/JavaReadingNotes/5de7f076/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>2.6k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>2 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="7-4-1-Spring容器"><a href="#7-4-1-Spring容器" class="headerlink" title="7.4.1 Spring容器"></a>7.4.1 Spring容器</h1><p><code>Spring</code>容器最基本的接口就是<code>BeanFactory</code>。 <code>BeanFactory</code>负责<strong>配置</strong>、<strong>创建</strong>、<strong>管理</strong><code>Bean</code>,它有一个子接口:<code>ApplictionContext</code>,也被称为<code>Spring</code>上下文。 <code>Spring</code>容器还负责管理<code>Bean</code>与<code>Bean</code>之间的依赖关系。</p>
<h2 id="BeanFactory接口方法"><a href="#BeanFactory接口方法" class="headerlink" title="BeanFactory接口方法"></a>BeanFactory接口方法</h2><p><code>BeanFactory</code>接口包含如下几个基本方法。</p>
<table>
<thead>
<tr>
<th align="left">方法</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>boolean containsBean(String name)</code></td>
<td align="left">判断<code>Spring</code>容器是否包含<code>id</code>为<code>name</code>的<code>Bean</code>实例。</td>
</tr>
<tr>
<td align="left"><code>&lt;T&gt; T getBean(Class&lt;T&gt; requiredType)</code></td>
<td align="left">获取<code>Spring</code>容器中属于<code>requiredType</code>类型的、唯一的<code>Bean</code>实例。</td>
</tr>
<tr>
<td align="left"><code>Object getBean(String name)</code></td>
<td align="left">返回容器id为<code>name</code>的<code>Bean</code>实例。</td>
</tr>
<tr>
<td align="left"><code>&lt;T&gt; T getBean(String name,Class requiredType)</code></td>
<td align="left">返回容器中<code>id</code>为<code>name</code>,并且类型为<code>requiredType</code>的<code>Bean</code>。</td>
</tr>
<tr>
<td align="left"><code>Class&lt;?&gt; getType(String name)</code></td>
<td align="left">返回容器中<code>id</code>为<code>name</code>的<code>Bean</code>实例的类型。</td>
</tr>
</tbody></table>
<p>调用者只需使用<code>getBean()</code>方法即可获得指定<code>Bean</code>的引用,无须关心<code>Bean</code>的实例化过程。<code>Bean</code>实例的创建、初始化以及依赖关系的注入都由<code>Spring</code>容器完成<br><code>BeanFactory</code>常用的实现类是<code>DefaultListableBeanFactory</code></p>
<h2 id="ApplicationContext接口"><a href="#ApplicationContext接口" class="headerlink" title="ApplicationContext接口"></a>ApplicationContext接口</h2><p><code>ApplicationContext</code>是<code>BeanFactory</code>的子接口,因此功能更强大。对于大部分<code>Java EE</code>应用而言,<strong>使用<code>ApplicationContext</code>作为<code>Spring</code>容器更方便</strong>。</p>
<ul>
<li>其常用实现类是<code>FileSystemXmlApplicationContext</code>、<code>ClassPathXmlApplicationContext</code>和<code>AnnotationConfigApplicationContext</code>。</li>
<li>如果在<code>Web</code>应用中使用<code>Spring</code>容器,则通常有<code>XmlWebApplicationContext</code>、<code>AnnotationConfigWebApplicationContext</code>两个实现类。</li>
</ul>
<p>创建<code>Spring</code>容器的实例时,必须提供<code>Spring</code>容器管理的<code>Bean</code>的详细配置信息。 <code>Spring</code>的配置信息通常采用<code>XML</code>配置文件来设置,因此,创建<code>BeanFactory</code>实例时,应该提供<code>XML</code>配置文件作为参数,<code>XML</code>配置文件通常使用<code>Resource</code>对象传入。</p>
<h2 id="Resource接口"><a href="#Resource接口" class="headerlink" title="Resource接口"></a>Resource接口</h2><p><code>Resource</code>接口是<code>Spring</code>提供的资源访问接口,<strong>通过使用<code>Resource</code>接口, <code>Spring</code>能以简单、透明的方式访问磁盘、类路径以及网络上的资源</strong>。</p>
<p>大部分<code>Java EE</code>应用,可在启动<code>web</code>应用时自动加载<code>ApplicationContext</code>实例,接受<code>Spring</code>管理的<code>Bean</code>无须知道<code>ApplicationContext</code>的存在,一样可以利用<code>ApplicationContext</code>的管理。</p>
<h2 id="实例化BeanFactory"><a href="#实例化BeanFactory" class="headerlink" title="实例化BeanFactory"></a>实例化BeanFactory</h2><p>对于独立的应用程序,可通过如下方法来实例化<code>BeanFactory</code>.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//搜索类加载路径下的beans.xml文件创建Resource对象</span></span><br><span class="line">Resource isr=<span class="keyword">new</span> <span class="title class_">ClassPathResource</span>(<span class="string">&quot;beans.xml&quot;</span>);</span><br><span class="line"><span class="comment">// 创建默认的BeanFactory容器</span></span><br><span class="line">DefaultListableBeanFactory beanFactory=<span class="keyword">new</span> <span class="title class_">DefaultListableBeanFactory</span>();</span><br><span class="line"><span class="comment">// 让默认的BeanFactory容器加载isr对应的XML配置文件</span></span><br><span class="line"><span class="keyword">new</span> <span class="title class_">XmlBeanDefinitionReader</span>(beanFactory).loadBeanDefinitions(isr);</span><br></pre></td></tr></table></figure>
<p>或者采用如下代码来创建<code>BeanFactory</code>:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//搜索文件系统的当前路径下的beans.xml文件创建Resource对象</span></span><br><span class="line">Resource isr=<span class="keyword">new</span> <span class="title class_">FileSystemResource</span>(<span class="string">&quot;beans.xml&quot;</span>);</span><br><span class="line"><span class="comment">// 创建默认的BeanFactory容器</span></span><br><span class="line">DefaultListableBeanFactory beanFactory=<span class="keyword">new</span> <span class="title class_">DefaultListableBeanFactory</span>();</span><br><span class="line"><span class="comment">// 让默认的BeanFactory容器加载isr对应的XML配置文件</span></span><br><span class="line"><span class="keyword">new</span> <span class="title class_">XmlBeanDefinitionReader</span>(beanFactory).loadBeanDefinitions(isr);</span><br></pre></td></tr></table></figure>
<h2 id="加载多个配置文件来创建Spring容器"><a href="#加载多个配置文件来创建Spring容器" class="headerlink" title="加载多个配置文件来创建Spring容器"></a>加载多个配置文件来创建Spring容器</h2><p><strong>如果应用需要加载<code>多个配置文件</code>来创建<code>Spring</code>容器,则应该采用<code>BeanFactory</code>的子接口<code>ApplicationContext</code>来创建<code>BeanFactory</code>的实例</strong>。 <code>ApplicationContext</code>接口包含<code>FileSystemXmlApplicationContext</code>和<code>ClassPathXmlApplicationContext</code>两个常用的实现类。<br>如果需要同时加载多个<code>XML</code>配置文件来创建<code>Spring</code>容器,则可以采用如下方式:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 以类加载路径下的beans.xml和service.xml文件来创建ApplicationContext</span></span><br><span class="line">AplicationContext appContext=<span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;beans.xml&quot;</span>,<span class="string">&quot;service.xml&quot;</span>);</span><br></pre></td></tr></table></figure>
<p>当然也可支持从文件系统的相对路径或绝对路径来搜索配置文件,只要使用<code>FileSystemXmlApplicationContext</code>即可,如下面的程序片段所示:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AplicationContext appContext=<span class="keyword">new</span> <span class="title class_">FileSystemXmlApplicationContext</span>(<span class="string">&quot;beans.xml&quot;</span>,<span class="string">&quot;service.xml&quot;</span>);</span><br></pre></td></tr></table></figure>
<p>由于<code>ApplicationContext</code>本身就是<code>BeanFactory</code>的子接口,因此**<code>ApplicationContext</code>完全可以作为<code>Spring</code>容器来使用**,而且功能更强。当然,如果有需要,也可以把<code>ApplicationContext</code>实例赋给<code>BeanFactory</code>变量.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://lanlan2017.github.io/JavaReadingNotes/ea416c55/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/JavaReadingNotes/images/avatar.gif">
      <meta itemprop="name" content="蓝蓝">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="蓝蓝站点">
      <meta itemprop="description" content="好好学习，天天向上">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 蓝蓝站点">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/JavaReadingNotes/ea416c55/" class="post-title-link" itemprop="url">7.4 使用Spring容器</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2019-08-25 11:05:35" itemprop="dateCreated datePublished" datetime="2019-08-25T11:05:35+08:00">2019-08-25</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2020-02-07 01:34:58" itemprop="dateModified" datetime="2020-02-07T01:34:58+08:00">2020-02-07</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JavaReadingNotes/categories/2-%E8%BD%BB%E9%87%8F%E7%BA%A7Java-EE%E4%BC%81%E4%B8%9A%E5%BA%94%E7%94%A8%E5%AE%9E%E6%88%98-%E7%AC%AC5%E7%89%88/" itemprop="url" rel="index"><span itemprop="name">2 轻量级Java EE企业应用实战(第5版)</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JavaReadingNotes/categories/2-%E8%BD%BB%E9%87%8F%E7%BA%A7Java-EE%E4%BC%81%E4%B8%9A%E5%BA%94%E7%94%A8%E5%AE%9E%E6%88%98-%E7%AC%AC5%E7%89%88/%E7%AC%AC7%E7%AB%A0-Spring%E7%9A%84%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95/" itemprop="url" rel="index"><span itemprop="name">第7章 Spring的基本用法</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JavaReadingNotes/categories/2-%E8%BD%BB%E9%87%8F%E7%BA%A7Java-EE%E4%BC%81%E4%B8%9A%E5%BA%94%E7%94%A8%E5%AE%9E%E6%88%98-%E7%AC%AC5%E7%89%88/%E7%AC%AC7%E7%AB%A0-Spring%E7%9A%84%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95/7-4-%E4%BD%BF%E7%94%A8Spring%E5%AE%B9%E5%99%A8/" itemprop="url" rel="index"><span itemprop="name">7.4 使用Spring容器</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
    <span class="post-meta-item-icon">
      <i class="far fa-comment"></i>
    </span>
    <span class="post-meta-item-text">Waline：</span>
  
    <a title="waline" href="/JavaReadingNotes/ea416c55/#waline-comments" itemprop="discussionUrl">
      <span class="post-comments-count waline-comment-count" id="/JavaReadingNotes/ea416c55/" data-xid="/JavaReadingNotes/ea416c55/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>533</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>1 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="7-4-使用Spring容器"><a href="#7-4-使用Spring容器" class="headerlink" title="7.4 使用Spring容器"></a>7.4 使用Spring容器</h1><p><code>Spring</code>有两个核心接口:<code>BeanFactory</code>和<code>ApplicationContext</code>,其中<code>ApplicationContext</code>是<code>BeanFactory</code>的子接口。它们都可代表<code>Spring</code>容器, <code>Spring</code>容器是生成<code>Bean</code>实例的工厂,并管理容器中的<code>Bean</code>。在基于<code>Spring</code>的<code>Java EE</code>应用中,所有的组件都被当成<code>Bean</code>处理,包括<code>数据源</code>、 <code>Hibernate</code>的<code>SessionFactory</code>事务管理器等。<br>应用中的所有组件都处于<code>Spring</code>的管理下,都被<code>Spring</code>以<code>Bean</code>的方式管理, <code>Spring</code>负责创建<code>Bean</code>实例,并管理其生命周期。 <code>Spring</code>里的<code>Bean</code>是非常广义的概念,任何的<code>Java</code>对象、<code>Java</code>组件都被当成<code>Bean</code>处理。对于<code>Spring</code>而言,一切<code>Java</code>对象都是<code>Bean</code>。<br><code>Bean</code>在<code>Spring</code>容器中运行,无须感受<code>Spring</code>容器的存在,一样可以接受<code>Spring</code>的依赖注入,包括<code>Bean</code>成员变量的注入、协作者的注入、依赖关系的注入等。<br><code>Java</code>程序面向接口编程,无须关心<code>Bean</code>实例的实现类;但<code>Spring</code>容器负责创建<code>Bean</code>实例,因此必须精确知道每个<code>Bean</code>实例的实现类,故<code>Spring</code>配置文件必须指定<code>Bean</code>实例的实现类。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://lanlan2017.github.io/JavaReadingNotes/4725d881/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/JavaReadingNotes/images/avatar.gif">
      <meta itemprop="name" content="蓝蓝">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="蓝蓝站点">
      <meta itemprop="description" content="好好学习，天天向上">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 蓝蓝站点">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/JavaReadingNotes/4725d881/" class="post-title-link" itemprop="url">7.3.4 两种注入方式的对比</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2019-08-25 10:57:22" itemprop="dateCreated datePublished" datetime="2019-08-25T10:57:22+08:00">2019-08-25</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2020-02-07 01:34:58" itemprop="dateModified" datetime="2020-02-07T01:34:58+08:00">2020-02-07</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JavaReadingNotes/categories/2-%E8%BD%BB%E9%87%8F%E7%BA%A7Java-EE%E4%BC%81%E4%B8%9A%E5%BA%94%E7%94%A8%E5%AE%9E%E6%88%98-%E7%AC%AC5%E7%89%88/" itemprop="url" rel="index"><span itemprop="name">2 轻量级Java EE企业应用实战(第5版)</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JavaReadingNotes/categories/2-%E8%BD%BB%E9%87%8F%E7%BA%A7Java-EE%E4%BC%81%E4%B8%9A%E5%BA%94%E7%94%A8%E5%AE%9E%E6%88%98-%E7%AC%AC5%E7%89%88/%E7%AC%AC7%E7%AB%A0-Spring%E7%9A%84%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95/" itemprop="url" rel="index"><span itemprop="name">第7章 Spring的基本用法</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JavaReadingNotes/categories/2-%E8%BD%BB%E9%87%8F%E7%BA%A7Java-EE%E4%BC%81%E4%B8%9A%E5%BA%94%E7%94%A8%E5%AE%9E%E6%88%98-%E7%AC%AC5%E7%89%88/%E7%AC%AC7%E7%AB%A0-Spring%E7%9A%84%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95/7-3-Spring%E7%9A%84%E6%A0%B8%E5%BF%83%E6%9C%BA%E5%88%B6-%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5/" itemprop="url" rel="index"><span itemprop="name">7.3 Spring的核心机制 依赖注入</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
    <span class="post-meta-item-icon">
      <i class="far fa-comment"></i>
    </span>
    <span class="post-meta-item-text">Waline：</span>
  
    <a title="waline" href="/JavaReadingNotes/4725d881/#waline-comments" itemprop="discussionUrl">
      <span class="post-comments-count waline-comment-count" id="/JavaReadingNotes/4725d881/" data-xid="/JavaReadingNotes/4725d881/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>683</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>1 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="7-3-4-两种注入方式的对比"><a href="#7-3-4-两种注入方式的对比" class="headerlink" title="7.3.4 两种注入方式的对比"></a>7.3.4 两种注入方式的对比</h1><p>在过去的开发过程中,这两种注入方式都是非常常用的。 <code>Spring</code>也同时支持两种依赖注入方式:<code>设值注入</code>和<code>构造注入</code>。这两种依赖注入方式并没有绝对的好坏,只是适应的场景有所不同。</p>
<h2 id="设值注入的优点"><a href="#设值注入的优点" class="headerlink" title="设值注入的优点"></a>设值注入的优点</h2><p>相比之下,设值注入具有如下的优点。</p>
<ol>
<li>与传统的<code>Javabean</code>的写法更相似,程序开发人员更容易理解、接受。通过<code>setter</code>方法设定依赖关系显得更加直观、自然。</li>
<li>对于复杂的依赖关系,如果采用构造注入,会导致构造器过于臃肿,难以阅读。 <code>Spring</code>在创建<code>Bean</code>实例时,需要同时实例化其依赖的全部实例,因而导致性能下降。而使用设值注入,则能避免这些问题。</li>
<li>尤其是在某些成员变量可选的情况下,多参数的构造器更加笨重。<h2 id="构造注入的优点"><a href="#构造注入的优点" class="headerlink" title="构造注入的优点"></a>构造注入的优点</h2>构造注入也不是绝对不如设值注入,在某些特定的场景下,构造注入比设值注入更优秀。构造注入也有如下优势:</li>
<li>构造注入可以在构造器中决定依赖关系的注入顺序,优先依赖的优先注入。例如,组件中其他依赖关系的注入,常常需要依赖于<code>Datasource</code>的注入。采用构造注入,可以在代码中清晰地决定注入顺序。</li>
<li>对于依赖关系无须变化的<code>Bean</code>,构造注入更有用处。因为没有<code>setter</code>方法,所有的依赖关系全部在构造器内设定。因此,无须担心后续的代码对依赖关系产生破坏。</li>
<li>依赖关系只能在构造器中设定,则只有组件的创建者才能改变组件的依赖关系。对组件的调用者而言,组件内部的依赖关系完全透明,更符合高内聚的原则。</li>
</ol>
<h2 id="设值注入为主-构造注入为辅"><a href="#设值注入为主-构造注入为辅" class="headerlink" title="设值注入为主,构造注入为辅"></a>设值注入为主,构造注入为辅</h2><p>建议采用以<strong>设值注入为主,构造注入为辅</strong>的注入策略。<br>对于依赖关系无须变化的注入,尽量采用构造注入;<br>而其他依赖关系的注入,则考虑采用设值注入。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://lanlan2017.github.io/JavaReadingNotes/521e30bb/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/JavaReadingNotes/images/avatar.gif">
      <meta itemprop="name" content="蓝蓝">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="蓝蓝站点">
      <meta itemprop="description" content="好好学习，天天向上">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 蓝蓝站点">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/JavaReadingNotes/521e30bb/" class="post-title-link" itemprop="url">7.3.3 构造注入</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2019-08-24 23:52:01" itemprop="dateCreated datePublished" datetime="2019-08-24T23:52:01+08:00">2019-08-24</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2020-02-07 01:34:58" itemprop="dateModified" datetime="2020-02-07T01:34:58+08:00">2020-02-07</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JavaReadingNotes/categories/2-%E8%BD%BB%E9%87%8F%E7%BA%A7Java-EE%E4%BC%81%E4%B8%9A%E5%BA%94%E7%94%A8%E5%AE%9E%E6%88%98-%E7%AC%AC5%E7%89%88/" itemprop="url" rel="index"><span itemprop="name">2 轻量级Java EE企业应用实战(第5版)</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JavaReadingNotes/categories/2-%E8%BD%BB%E9%87%8F%E7%BA%A7Java-EE%E4%BC%81%E4%B8%9A%E5%BA%94%E7%94%A8%E5%AE%9E%E6%88%98-%E7%AC%AC5%E7%89%88/%E7%AC%AC7%E7%AB%A0-Spring%E7%9A%84%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95/" itemprop="url" rel="index"><span itemprop="name">第7章 Spring的基本用法</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JavaReadingNotes/categories/2-%E8%BD%BB%E9%87%8F%E7%BA%A7Java-EE%E4%BC%81%E4%B8%9A%E5%BA%94%E7%94%A8%E5%AE%9E%E6%88%98-%E7%AC%AC5%E7%89%88/%E7%AC%AC7%E7%AB%A0-Spring%E7%9A%84%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95/7-3-Spring%E7%9A%84%E6%A0%B8%E5%BF%83%E6%9C%BA%E5%88%B6-%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5/" itemprop="url" rel="index"><span itemprop="name">7.3 Spring的核心机制 依赖注入</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
    <span class="post-meta-item-icon">
      <i class="far fa-comment"></i>
    </span>
    <span class="post-meta-item-text">Waline：</span>
  
    <a title="waline" href="/JavaReadingNotes/521e30bb/#waline-comments" itemprop="discussionUrl">
      <span class="post-comments-count waline-comment-count" id="/JavaReadingNotes/521e30bb/" data-xid="/JavaReadingNotes/521e30bb/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>3.8k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>3 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="7-3-3-构造注入"><a href="#7-3-3-构造注入" class="headerlink" title="7.3.3 构造注入"></a>7.3.3 构造注入</h1><p>前面已经介绍过,通过<code>setter</code>方法为目标<code>Bean</code>注入依赖关系的方式被称为<strong>设值注入</strong>;另外还有种注入方式,这种方式在构造实例时,已经为其完成了依赖关系的初始化。这种利**用构造器来设置依赖关系的方式,被称为<code>构造注入</code>**。</p>
<h2 id="构造注入的本质"><a href="#构造注入的本质" class="headerlink" title="构造注入的本质"></a>构造注入的本质</h2><p>通俗来说,就是驱动<code>Spring</code>在底层以反射方式执行带参数的构造器,<strong>当执行带参数的构造器时,就可利用构造器参数对成员变量执行初始化—这就是构造注入的本质</strong>。<br>现在问题产生了:<strong><code>&lt;bean&gt;</code>元素默认总是驱动<code>Spring</code>调用无参数的构造器来创建对象</strong>,那怎样驱动<code>Spring</code>调用有参数的构造器去创建对象呢?答案是使用<code>&lt;constructor-arg&gt;</code>子元素,每个<code>&lt;constructor-arg&gt;</code>子元素代表一个构造器参数,<strong>如果<code>&lt;bean&gt;</code>元素包含<code>N</code>个<code>&lt;constructor-arg&gt;</code>子元素,就会驱动<code>Spring</code>调用带<code>N</code>个参数的构造器来创建对象</strong>.</p>
<h1 id="程序示例"><a href="#程序示例" class="headerlink" title="程序示例"></a>程序示例</h1><p>对前面代码中的<code>Chinese</code>类做简单的修改,修改后的代码如下。</p>
<h2 id="Chinese-java"><a href="#Chinese-java" class="headerlink" title="Chinese.java"></a>Chinese.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> org.crazyit.app.service.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.crazyit.app.service.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Chinese</span> <span class="keyword">implements</span> <span class="title class_">Person</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> Axe axe;</span><br><span class="line">    <span class="comment">// 构造注入所需的带参数的构造器</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Chinese</span><span class="params">(Axe axe)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">this</span>.axe = axe;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 实现Person接口的useAxe()方法</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">useAxe</span><span class="params">()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// 调用axe的chop()方法</span></span><br><span class="line">        <span class="comment">// 表明Person对象依赖于axe对象</span></span><br><span class="line">        System.out.println(axe.chop());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>上面的<code>Chinese</code>类没有提供设置<code>axe</code>成员变量的<code>setter</code>法,仅仅提供了一个带<code>Axe</code>参数的构造器。<code>Spring</code>将通过该构造器为<code>chinese</code>注入所依赖的<code>Bean</code>实例。<br>构造注入的配置文件也需做简单的修改,为了使用构造注入(也就是驱动<code>Spring</code>调用有参数的构造器创建对象),还需使用<code>&lt;constructor-arg&gt;</code>元素指定构造器的参数。修改后的配置文件如下。</p>
<h2 id="beans-xml"><a href="#beans-xml" class="headerlink" title="beans.xml"></a>beans.xml</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;GBK&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">    http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 配置chinese实例，其实现类是Chinese --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 1号代码 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;chinese&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.crazyit.app.service.impl.Chinese&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 下面只有一个constructor-arg子元素， 驱动Spring调用Chinese带一个参数的构造器来创建对象 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">ref</span>=<span class="string">&quot;steelAxe&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">type</span>=<span class="string">&quot;org.crazyit.app.service.Axe&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 配置stoneAxe实例，其实现类是StoneAxe --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;stoneAxe&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">class</span>=<span class="string">&quot;org.crazyit.app.service.impl.StoneAxe&quot;</span> /&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 配置steelAxe实例，其实现类是SteelAxe --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;steelAxe&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">class</span>=<span class="string">&quot;org.crazyit.app.service.impl.SteelAxe&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>上面配置文件中的粗体字代码使用<code>&lt;constructor-arg&gt;</code>元素指定了一个构造器参数,该参数类型是<code>Axe</code>,这指定<code>Spring</code>调用<code>Chinese</code>类里带一个<code>Axe</code>参数的构造器来创建<code>chinese</code>实例。也就是说,上面代码相当于驱动<code>Spring</code>执行如下代码:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">String idStr=...;<span class="comment">//Spring解析&lt;bean&gt;元素得到id属性值为chinese</span></span><br><span class="line">String refStr=...;<span class="comment">//Spring解析&lt;constructor-arg&gt;元素得到ref属性值为steelAxe</span></span><br><span class="line">Object paramBean=container.get(refStr);</span><br><span class="line"><span class="comment">//Spring会用反射方式执行下面代码,此处为了降低阅读难度,该行代码没有使用反射。</span></span><br><span class="line">Object obj=<span class="keyword">new</span> <span class="title class_">org</span>.crazyit.app.service.impl.Chinese(paramBean);</span><br><span class="line"><span class="comment">// container代表Spring容器</span></span><br><span class="line">container.put(idStr,obj);</span><br></pre></td></tr></table></figure>
<p>从上面字代码可以看出,由于使用了有参数的构造器创建实例,所以当<code>Bean</code>实例被创建完成后,该<code>Bean</code>的依赖关系已经设置完成。<br>该示例的执行效果与设值注入<code>steelAxe</code>时的执行效果完全一样。区别在于:</p>
<ul>
<li>创建<code>Person</code>实例中<code>Axe</code>属性的时机不同——设值注入是先通过无参数的构造器创建一个<code>Bean</code>实例,然后调用对应的<code>setter</code>方法注入依赖关系;</li>
<li>而构造注入则直接调用有参数的构造器,当<code>Bean</code>实例创建完成后,已经完成了依赖关系的注入</li>
</ul>
<h2 id="index属性"><a href="#index属性" class="headerlink" title="index属性"></a>index属性</h2><p>配置<code>&lt;constructor-arg&gt;</code>元素时可指定一个<code>index</code>属性,用于指定该构造参数值将作为第几个构造参数值,例如,<strong>指定<code>index=&quot;0&quot;</code>表明该构造参数值将作为第一个构造参数值</strong>。<br><strong>希望<code>Spring</code>调用带几个参数的构造器,就在<code>&lt;bean&gt;</code>元素中配置几个<code>&lt;constructor-arg&gt;</code>子元素</strong>。例如如下配置代码:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--定义名为bean1的Bean,对应的实现类为lee.Test1--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;bean1&quot;</span> <span class="attr">class</span>=<span class="string">&quot;lee.Test1&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">index</span>=<span class="string">&quot;0&quot;</span> <span class="attr">value</span>=<span class="string">&quot;hello&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">index</span>=<span class="string">&quot;1&quot;</span> <span class="attr">value</span>=<span class="string">&quot;23&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>上面的代码相当于让<code>Spring</code>调用如下代码( <code>Spring</code>底层用反射执行该代码)</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Object bean1=<span class="keyword">new</span> <span class="title class_">lee</span>.Test1(<span class="string">&quot;hello&quot;</span>,<span class="string">&quot;23&quot;</span>);<span class="comment">//①号代码</span></span><br></pre></td></tr></table></figure>
<p>由于<code>Spring</code>本身提供了功能强大的类型转换机制,因此如果<code>lee.Test1</code>只包含一个<code>Test(String,int)</code>构造器,那么上面的配置片段相当于让<code>Spring</code>执行如下代码( <code>Spring</code>底层用反射执行该代码):</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Object bean1=<span class="keyword">new</span> <span class="title class_">lee</span>.Test1(<span class="string">&quot;hello&quot;</span>,<span class="number">23</span>);<span class="comment">//②号代码</span></span><br></pre></td></tr></table></figure>
<p>这就产生一个问题:如果<code>lee.Test1</code>类既有<code>Testl(String, String)</code>构造器,又有<code>Test1(String,int)</code>构造器,那么上面的粗体字配置片段到底让<code>Spring</code>执行哪行代码呢?答案是①号代码,因为此时的配置还不够明确:对于<code>&lt;constructor-arg value=&quot;23&gt;</code>,<code>Spring</code>只能解析出一个<code>&quot;23&quot;</code>字符串,但它到底需要转换为哪种数据类型——从配置文件中看不出来,只能根据<code>lee.Test1</code>的构造器来尝试转换.</p>
<h2 id="type属性"><a href="#type属性" class="headerlink" title="type属性"></a>type属性</h2><p>为了更明确地指定数据类型, <code>Spring</code>允许为<code>&lt;constructor-arg.&gt;</code>元素指定一个<code>type</code>属性,例如<code>&lt;constructor-arg value=&quot;23&quot; type=&quot;int&quot;&gt;</code>,此处<code>Spring</code>明确知道此处配置了一个<code>int</code>类型的参数。与此类似的是,<code>&lt;value&gt;</code>元素也可指定<code>type</code>属性,用于确定该属性值的数据类型。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://lanlan2017.github.io/JavaReadingNotes/37d15e90/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/JavaReadingNotes/images/avatar.gif">
      <meta itemprop="name" content="蓝蓝">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="蓝蓝站点">
      <meta itemprop="description" content="好好学习，天天向上">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 蓝蓝站点">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/JavaReadingNotes/37d15e90/" class="post-title-link" itemprop="url">7.3.2 设值注入</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2019-08-24 20:31:27" itemprop="dateCreated datePublished" datetime="2019-08-24T20:31:27+08:00">2019-08-24</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2020-02-07 01:34:58" itemprop="dateModified" datetime="2020-02-07T01:34:58+08:00">2020-02-07</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JavaReadingNotes/categories/2-%E8%BD%BB%E9%87%8F%E7%BA%A7Java-EE%E4%BC%81%E4%B8%9A%E5%BA%94%E7%94%A8%E5%AE%9E%E6%88%98-%E7%AC%AC5%E7%89%88/" itemprop="url" rel="index"><span itemprop="name">2 轻量级Java EE企业应用实战(第5版)</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JavaReadingNotes/categories/2-%E8%BD%BB%E9%87%8F%E7%BA%A7Java-EE%E4%BC%81%E4%B8%9A%E5%BA%94%E7%94%A8%E5%AE%9E%E6%88%98-%E7%AC%AC5%E7%89%88/%E7%AC%AC7%E7%AB%A0-Spring%E7%9A%84%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95/" itemprop="url" rel="index"><span itemprop="name">第7章 Spring的基本用法</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JavaReadingNotes/categories/2-%E8%BD%BB%E9%87%8F%E7%BA%A7Java-EE%E4%BC%81%E4%B8%9A%E5%BA%94%E7%94%A8%E5%AE%9E%E6%88%98-%E7%AC%AC5%E7%89%88/%E7%AC%AC7%E7%AB%A0-Spring%E7%9A%84%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95/7-3-Spring%E7%9A%84%E6%A0%B8%E5%BF%83%E6%9C%BA%E5%88%B6-%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5/" itemprop="url" rel="index"><span itemprop="name">7.3 Spring的核心机制 依赖注入</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
    <span class="post-meta-item-icon">
      <i class="far fa-comment"></i>
    </span>
    <span class="post-meta-item-text">Waline：</span>
  
    <a title="waline" href="/JavaReadingNotes/37d15e90/#waline-comments" itemprop="discussionUrl">
      <span class="post-comments-count waline-comment-count" id="/JavaReadingNotes/37d15e90/" data-xid="/JavaReadingNotes/37d15e90/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>5.6k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>5 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="7-3-2-设值注入"><a href="#7-3-2-设值注入" class="headerlink" title="7.3.2 设值注入"></a>7.3.2 设值注入</h1><p>设值注入是指<code>IoC</code>容器<strong>通过成员变量的<code>setter</code>方法来注入被依赖对象</strong>。这种注入方式简单、直观,因而在<code>Spring</code>的依赖注入里大量使用。<br>下面示例将会对前面示例进行改写,使之更加规范。 <strong><code>Spring</code>推荐面向接口编程</strong>。不管是调用者,还是被依赖对象,都应该为之定义接口,<strong>程序应该面向它们的接口,而不是面向实现类编程,这样以便程序后期的升级、维护</strong>。</p>
<h1 id="程序示例"><a href="#程序示例" class="headerlink" title="程序示例"></a>程序示例</h1><h2 id="项目结构"><a href="#项目结构" class="headerlink" title="项目结构"></a>项目结构</h2><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">E:\<span class="title">workspace_QingLiangJiJavaEEQiYeYingYongShiZhang5</span>\<span class="title">setter</span></span></span><br><span class="line"><span class="function">└─<span class="title">src</span>\</span></span><br><span class="line"><span class="function">  ├─<span class="title">beans.xml</span></span></span><br><span class="line"><span class="function">  ├─<span class="title">lee</span>\</span></span><br><span class="line"><span class="function">  │ └─<span class="title">BeanTest.java</span></span></span><br><span class="line"><span class="function">  └─<span class="title">org</span>\</span></span><br><span class="line"><span class="function">    └─<span class="title">crazyit</span>\</span></span><br><span class="line"><span class="function">      └─<span class="title">app</span>\</span></span><br><span class="line"><span class="function">        └─<span class="title">service</span>\</span></span><br><span class="line"><span class="function">          ├─<span class="title">Axe.java</span></span></span><br><span class="line"><span class="function">          ├─<span class="title">impl</span>\</span></span><br><span class="line"><span class="function">          │ ├─<span class="title">Chinese.java</span></span></span><br><span class="line"><span class="function">          │ ├─<span class="title">SteelAxe.java</span></span></span><br><span class="line"><span class="function">          │ └─<span class="title">StoneAxe.java</span></span></span><br><span class="line"><span class="function">          └─<span class="title">Person.java</span></span></span><br><span class="line"><span class="function"></span></span><br></pre></td></tr></table></figure>
<h2 id="Person-java"><a href="#Person-java" class="headerlink" title="Person.java"></a>Person.java</h2><p>下面先定义一个<code>Person</code>接口,该接口定义了一个<code>Person</code>对象应遵守的规范。下面是<code>Person</code>接口的代码。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> org.crazyit.app.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Person</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 定义一个使用斧子的方法</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">useAxe</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Axe-java"><a href="#Axe-java" class="headerlink" title="Axe.java"></a>Axe.java</h2><p>下面是<code>Axe</code>接口的代码。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> org.crazyit.app.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Axe</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// Axe接口里有个砍的方法</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">chop</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>Spring</code>推荐面向接口编程,这样可以更好地让规范和实现分离,从而提供更好的解耦。对于一个<code>Java EE</code>应用,不管是<code>DAO</code>组件,还是业务逻辑组件,都应该先定义一个接口,该接口定义了该组件应该实现的功能,但功能的实现则由其实现类提供。</p>
<h2 id="Chinese-java"><a href="#Chinese-java" class="headerlink" title="Chinese.java"></a>Chinese.java</h2><p>下面是<code>Person</code>实现类的代码。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> org.crazyit.app.service.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.crazyit.app.service.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Chinese</span> <span class="keyword">implements</span> <span class="title class_">Person</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> Axe axe;</span><br><span class="line">    <span class="comment">// 设值注入所需的setter方法</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setAxe</span><span class="params">(Axe axe)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">this</span>.axe = axe;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 实现Person接口的useAxe方法</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">useAxe</span><span class="params">()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// 调用axe的chop()方法，</span></span><br><span class="line">        <span class="comment">// 表明Person对象依赖于axe对象</span></span><br><span class="line">        System.out.println(axe.chop());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>上面程序中的粗体字代码实现了<code>Person</code>接口的<code>useAxe()</code>方法,实现该方法时调用了<code>axe</code>的<code>chop()</code>方法,这就是典型的依赖关系。<br>回忆一下曾经编写的<code>Java</code>应用,除了最简单的<code>Hello world</code>之外,哪个应用不是A调用B、B调用C、C调用D…这种方式?那<code>Spring</code>的作用呢? <code>Spring</code>容器的最大作用就是以松耦合的方式来管理这种调用关系。在上面的<code>Chinese</code>类中, <code>Chinese</code>类并不知道它要调用的<code>axe</code>实例在哪里,也不知道<code>axe</code>实例是如何实现的,它只是需要调用<code>Axe</code>对象的方法,这个<code>Axe</code>实例将由<code>Spring</code>容器负责注入。</p>
<h2 id="SteelAxe-java"><a href="#SteelAxe-java" class="headerlink" title="SteelAxe.java"></a>SteelAxe.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> org.crazyit.app.service.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.crazyit.app.service.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SteelAxe</span> <span class="keyword">implements</span> <span class="title class_">Axe</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">chop</span><span class="params">()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;钢斧砍柴真快&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>到现在为止,程序依然不知道<code>Chinese</code>类和哪个<code>Axe</code>实例耦合, <code>Spring</code>当然也不知道! <code>Spring</code>需要使用<code>XML</code>配置文件来指定实例之间的依赖关系.<br><code>Spring</code>采用了<code>XML</code>配置文件,从<code>Spring2.0</code>开始, <code>Spring</code>推荐采用<code>XML Schema</code>来定义配置文件的语义约束。当采用<code>XML Schema</code>来定义配置文件的语义约束时,还可利用<code>Spring</code>配置文件的扩展性进一步简化<code>Spring</code>配置。<br><code>Spring</code>为基于<code>XML Schema</code>的<code>XML</code>配置文件提供了一些新的标签,这些新标签使配置更简单,使用更方便。关于如何使用<code>Spring</code>所提供的新标签,后面会有更进一步的介绍。<br>不仅如此,采用基于<code>XML Schema</code>的<code>XML</code>配置文件时, <code>Spring</code>甚至允许程序员开发自定义的配置文件标签,让其他开发人员在<code>Spring</code>配置文件中使用这些标签,但这些通常应由第三方供应商来完成。对普通软件开发人员以及普通系统架构师而言,则通常无须开发自定义的<code>Spring</code>配置文件标签。所以本书也不打算介绍相关方面的内容。<br>提示:本书并不是一本完整的<code>Spring</code>学习手册,所以本书只会介绍<code>Spring</code>的核心机制,包括<code>loC</code>、<code>SpEL</code>、<code>AOP</code>和资源访问等, <code>Spring</code>和<code>Hibernate</code>整合, <code>Spring</code>的<code>DAO</code>支持和事务管理,以及<code>Spring</code>和<code>Struts2</code>整合等内容,这些是<code>Java ee</code>开发所需要的核心知识。而<code>Spring</code>框架的其他方面,本书不会涉及.<br>下面是本应用所用的配置文件代码。</p>
<h2 id="beans-xml"><a href="#beans-xml" class="headerlink" title="beans.xml"></a>beans.xml</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;GBK&quot;</span>?&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- Spring配置文件的根元素，使用spring-beans.xsd语义约束 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">    http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 配置chinese实例，其实现类是Chinese类 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;chinese&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.crazyit.app.service.impl.Chinese&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 驱动调用chinese的setAxe()方法，将容器中stoneAxe作为传入参数 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;axe&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;stoneAxe&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 配置stoneAxe实例，其实现类是StoneAxe --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;stoneAxe&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">class</span>=<span class="string">&quot;org.crazyit.app.service.impl.StoneAxe&quot;</span> /&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 配置steelAxe实例，其实现类是SteelAxe --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;steelAxe&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">class</span>=<span class="string">&quot;org.crazyit.app.service.impl.SteelAxe&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>在配置文件中, <code>Spring</code>配置<code>Bean</code>实例通常会指定两个属性。</p>
<ol>
<li><code>id</code>:指定该<code>Bean</code>的唯一标识, <strong><code>Spring</code>根据<code>id</code>属性值来管理<code>Bean</code></strong>,程序通过<code>id</code>属性值来访问该<code>Bean</code>实例。</li>
<li><code>class</code>:指定该<code>Bean</code>的实现类,此处不可再用接口,<strong>必须使用实现类</strong>, <code>Spring</code>容器会使用<code>XML</code>解析器读取该属性值,并利用反射来创建该实现类的实例。</li>
</ol>
<p>可以看到<code>Spring</code>管理<code>Bean</code>的灵巧性。<code>Bean</code>与<code>Bean</code>之间的依赖关系放在配置文件里组织,而不是写在代码里。通过配置文件的指定, <code>Spring</code>能精确地为每个<code>Bean</code>的成员变量注入值。</p>
<p><code>Spring</code>会自动检测每个<code>&lt;bean&gt;</code>定义里的<code>&lt;property&gt;</code>元素定义, <code>Spring</code>会在调用默认的构造器创建<code>Bean</code>实例之后,立即调用对应的<code>setter</code>法为<code>Bean</code>的成员变量注入值。<br>下面是主程序的代码,该主程序只是简单地获取了<code>Person</code>实例,并调用该实例的<code>useAxeo</code>方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> lee;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.context.ApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.crazyit.app.service.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BeanTest</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// 创建Spring容器</span></span><br><span class="line">        <span class="meta">@SuppressWarnings(&quot;resource&quot;)</span></span><br><span class="line">        <span class="type">ApplicationContext</span> <span class="variable">ctx</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(</span><br><span class="line">                <span class="string">&quot;beans.xml&quot;</span>);</span><br><span class="line">        <span class="comment">// 从Spring容器中获取chinese实例</span></span><br><span class="line">        <span class="type">Person</span> <span class="variable">p</span> <span class="operator">=</span> ctx.getBean(<span class="string">&quot;chinese&quot;</span>, Person.class);</span><br><span class="line">        <span class="comment">// 调用useAxe()方法</span></span><br><span class="line">        p.useAxe();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>上面程序中的实现了创建<code>Spring</code>容器,并通过<code>Spring</code>容器来获取<code>Bean</code>实例。从上面程序中可以看出, <code>Spring</code>容器就是一个巨大的工厂,它可以”生产”出所有类型的<code>Bean</code>实例。程序获取<code>Bean</code>实例的方法是<code>getBean()</code>。<br>一旦通过<code>Spring</code>容器获得了<code>Bean</code>实例之后,如何调用<code>Bean</code>实例的方法就没什么特别之处了。执行上面程序,会看到如下执行结果:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">石斧砍柴好慢</span><br></pre></td></tr></table></figure>
<p>主程序调用<code>Person</code>的<code>useAxe()</code>方法时,该方法的方法体内需要使用<code>Axe</code>实例,但程序没有任何地方将特定的<code>Person</code>实例和<code>Axe</code>实例耦合在一起。或者说,程序没有为<code>Person</code>实例传入<code>Axe</code>实例,<code>Axe</code>实例由<code>Spring</code>在运行期间注入。<br>下面是<code>Axe</code>的另一个实现类:<code>SteelAxe</code></p>
<h2 id="SteelAxe-java-1"><a href="#SteelAxe-java-1" class="headerlink" title="SteelAxe.java"></a>SteelAxe.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> org.crazyit.app.service.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.crazyit.app.service.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SteelAxe</span> <span class="keyword">implements</span> <span class="title class_">Axe</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">chop</span><span class="params">()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;钢斧砍柴真快&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>将修改后的<code>SteelAxe</code>部署在<code>Spring</code>容器中,只需在<code>Spring</code>配置文件中增加如下一行:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 配置steelAxe实例，其实现类是SteelAxe --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;steelAxe&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.crazyit.app.service.impl.SteelAxe&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<p>该行重新定义了一个<code>Axe</code>实例,它的id是<code>steelAxe</code>,实现类是<code>SteelAxe</code>。然后修改<code>chineseBean</code>的配置,将原来传入<code>stoneAxe</code>的地方改为传入<code>steelAxe</code>。也就是将</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;axe&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;stoneAxe&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<p>改成:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;axe&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;steelAxe&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<p>此时再次执行程序,将得到如下结果:<br>从上面这种切换可以看出,因为<code>chinese</code>实例与具体的<code>Axe</code>实现类没有任何关系, <code>chinese</code>实例仅仅与<code>Axe</code>接口耦合,这就保证了<code>chinese</code>实例与<code>Axe</code>实例之间的<strong>松耦合</strong>—这也是<code>Spring</code>强调面向接口编程的原因。</p>
<h2 id="设值注入"><a href="#设值注入" class="headerlink" title="设值注入"></a>设值注入</h2><p><code>Bean</code>与<code>Bean</code>之间的依赖关系由<code>Spring</code>管理,** <code>Spring</code>采用<code>setter</code>方法为目标<code>Bean</code>注入所依赖的<code>Bean</code>这种方式被称为设值注入**。<br>从上面示例程序中应该可以看出,<strong>依赖注入以配置文件管理<code>Bean</code>实例之间的耦合,让<code>Bean</code>实例之间的耦合从代码层次分离出来</strong>。依赖注入是一种优秀的解耦方式。</p>
<h2 id="Spring-IoC容器的三个基本要点"><a href="#Spring-IoC容器的三个基本要点" class="headerlink" title="Spring IoC容器的三个基本要点"></a>Spring IoC容器的三个基本要点</h2><p>经过上面的介绍,不难发现使用<code>Spring loC</code>容器的三个基本要点:</p>
<ol>
<li>应用程序的各组件<strong>面向接口编程</strong>。面向接口编程可以将组件之间的耦合关系提升到接口层次从而有利于项目后期的扩展。</li>
<li>应用程序的<strong>各组件不再由程序主动创建,而是由<code>Spring</code>容器来负责产生并初始化</strong>。</li>
<li><code>Spring</code>采用<code>配置文件</code>或<code>注解</code>来管理<code>Bean</code>的实现类、依赖关系, <strong><code>Spring</code>容器则根据配置文件或注解,利用反射来创建实例,并为之注入依赖关系</strong></li>
</ol>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/JavaReadingNotes/page/110/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/JavaReadingNotes/">1</a><span class="space">&hellip;</span><a class="page-number" href="/JavaReadingNotes/page/110/">110</a><span class="page-number current">111</span><a class="page-number" href="/JavaReadingNotes/page/112/">112</a><span class="space">&hellip;</span><a class="page-number" href="/JavaReadingNotes/page/188/">188</a><a class="extend next" rel="next" href="/JavaReadingNotes/page/112/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 2018 – 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">蓝蓝</span>
  <!--博客朗读功能开始-->
  <script>
const java_generic_descriptor_regexp = new RegExp('\\<[a-zA-Z?& ,]+\\>');
const modifierRegExp = '([a-z]+)';
const returnValueRegExp = '([a-zA-Z0-9<>,&? \\[\\]]+)';
const methodNameRegExp = '([a-zA-Z0-9]+)';
const parameterRegExp = '([a-zA-Z0-9<>,&? ]+)';
const constructorRegExp = '([A-Z][a-zA-Z0-9_]+)';
const constructor_parameterless_regexp = new RegExp('^' + constructorRegExp + '\\(\\)$');
const constructor_parameterless_replace = '$1无参数构造方法';
const constructor_parameter_regexp = new RegExp('^' + constructorRegExp + '\\(' + parameterRegExp + '\\)$');
const constructor_parameter_replace = '$1构造方法，参数列表$2。';
const return_name_parameterless_regexp = new RegExp('^' + returnValueRegExp + ' ' + methodNameRegExp + '\\(\\)$');
const return_name_parameterless_replace = '$2方法，无参数，返回值$1。';
const modifier_return_name_parameterless_regexp = new RegExp('^' + modifierRegExp + ' ' + returnValueRegExp + ' ' + methodNameRegExp + '\\(\\)$');
const modifier_return_name_parameterless_replace = '$3方法，无参数，返回值$2，修饰符$1。';
const return_name_parameter_regexp = new RegExp('^' + returnValueRegExp + ' ' + methodNameRegExp + '\\(' + parameterRegExp + '\\)' + '$');
const return_name_parameter_replace = '$2方法，参数列表：$3，返回值：$1。';
const modifier_return_name_parameter_regexp = new RegExp('^' + modifierRegExp + ' ' + returnValueRegExp + ' ' + methodNameRegExp + '\\(' + parameterRegExp + '\\)' + '$');
const modifier_return_name_parameter_replace = '$3方法，参数列表：$4，返回值：$2，修饰符：$1。';
function fixTuoFengSplit(javaMethodCode, code) {
    var wrongCode = code.replace(/(?<=[A-Z])(?=[A-Z])/g, " ");
    if (javaMethodCode.search(wrongCode) > -1) {
        javaMethodCode = javaMethodCode.replaceAll(wrongCode, code);
    }
    return javaMethodCode;
}
function javaTuoFengLangDu(javaMethodCode) {
    javaMethodCode = javaMethodCode.replace(/(?<=[a-zA-Z])(?=[A-Z])/g, " ");
    var wrongSplit = ['UNIX', 'WEST', 'NORTH', 'SOUTH', 'EAST', 'RIGHT', 'CENTER', 'LEFT', 'CLASSPATH', 'PATH'];
    wrongSplit = wrongSplit.sort(function (a, b) {
        return b.length - a.length;
    })
    for (var i = 0, len = wrongSplit.length; i < len; i++) {
        javaMethodCode = fixTuoFengSplit(javaMethodCode, wrongSplit[i]);
    }
    return javaMethodCode;
}
function readPunctuation(text) {
    text = text.replaceAll("<", "");
    text = text.replaceAll(">", "");
    text = text.replaceAll(".", "点");
    text = text.replaceAll(":", "冒号");
    text = text.replaceAll("?", "问号");
    return text.replaceAll("**", "");
}
function readKeywords(text) {
    text = text.replaceAll("instanceof", "instance of");
    text = text.replaceAll("C#", "C sharp");
    text = text.replaceAll("javac", "java c");
    return text;
}
function remove_colon_Period_AtTheEndOfTheLine(text) {
    if (text.endsWith(".") || text.endsWith(":")) {
        text = text.substring(0, text.length - 1);
    }
    return text;
}
function readJavaStaticConstants(text) {
    const regexp = /(\.[A-Z_]+)/g;
    const matches = text.matchAll(regexp);
    for (const match of matches) {
        const goup1 = RegExp.$1;
        const goup1Lower = goup1.toLowerCase();
        text = text.replace(goup1, goup1Lower);
    }
    return text;
}
function removeReadingBtnTag(text) {
    text = text.replace(/\n朗读\n/g, '');
    text = text.replace(/^\d+$\n/mg, '');
    text = text.replace(/朗读$/mg, '');
    return text;
}
function preprocessingText(text) {
    text = remove_colon_Period_AtTheEndOfTheLine(text);
    text = readJavaStaticConstants(text);
    text = readPunctuation(text);
    text = readKeywords(text);
    text = javaTuoFengLangDu(text);
    text = removeReadingBtnTag(text);
    return text;
}
function methondReading(text) {
    while (java_generic_descriptor_regexp.test(text)) {
        text = text.replace(java_generic_descriptor_regexp, '');
    }
    console.log("     删除泛型后：" + text);
    text = text.replace('[]', '数组');
    text = text.replace(/\, ?/g, " 和 ");
    text = text.replace(/([a-zA-Z<>]+) ([a-zA-Z]+)/g, "$1类型的参数$2")
    text = javaTuoFengLangDu(text);
    return text;
}
function speak(text, parentElement) {
    const to_speak = new window.SpeechSynthesisUtterance();
    to_speak.text = text;
    to_speak.rate = 7.0;
    const oldColor = parentElement.style.backgroundColor;
    window.speechSynthesis.speak(to_speak);
    parentElement.style.backgroundColor = 'LightCyan';
    to_speak.onstart = function () {
        parentElement.style.backgroundColor = 'LightSkyBlue';
        parentElement.scrollIntoView({
            behavior: "smooth"
        });
    }
    to_speak.onend = function () {
        parentElement.style.backgroundColor = oldColor;
    }
}
function isMethod(text) {
    const modifierCode = 2;
    const returnCode = 3;
    const methodNameCode = 5;
    const parameterCode = 7;
    const constructorCode = 11;
    if (modifier_return_name_parameter_regexp.test(text)) {
        return modifierCode * returnCode * methodNameCode * parameterCode;
    }
    else if (return_name_parameter_regexp.test(text)) {
        return returnCode * methodNameCode * parameterCode;
    } else if (modifier_return_name_parameterless_regexp.test(text)) {
        return modifierCode * returnCode * methodNameCode;
    }
    else if (return_name_parameterless_regexp.test(text)) {
        return returnCode * methodNameCode;
    }
    else if (constructor_parameter_regexp.test(text)) {
        return constructorCode * methodNameCode;
    }
    else if (constructor_parameterless_regexp.test(text)) {
        return constructorCode;
    }
    return -1;
}
function addSpeckBtn(element, number) {
    let i = 0;
    for (; i < element.length; i++) {
        let speakBtn = document.createElement('button');
        speakBtn.innerText = "朗读";
        setButtonStyle(speakBtn);
        speakBtn.id = "speak_btn_" + (i + number);
        speakBtn.className = "speak_btn";
        speakBtn.onclick = function (e) {
            e.target.style.backgroundColor = '#979696';
            const btn = document.getElementById(e.target.id);
            parentElement = btn.parentElement;
            let text = parentElement.innerText;
            text = text.substring(0, text.lastIndexOf(e.target.innerText));
            text = text.replaceAll('​', '');
            console.log(text);
            const methodCode = isMethod(text);
            if (methodCode > 0) {
                console.log("是方法！编号:" + methodCode);
                if (methodCode === 210) {
                    console.log("    修饰符 返回值 方法名 参数列表")
                    text = text.replace(modifier_return_name_parameter_regexp, modifier_return_name_parameter_replace);
                } else if (methodCode === 105) {
                    console.log("    返回值 方法名 参数列表");
                    text = text.replace(return_name_parameter_regexp, return_name_parameter_replace);
                } else if (methodCode === 15) {
                    console.log("    返回值 方法名 没有参数列表")
                    text = text.replace(return_name_parameterless_regexp, return_name_parameterless_replace);
                } else if (methodCode === 30) {
                    console.log("    修饰符 返回值 方法名 没有参数列表");
                    text = text.replace(modifier_return_name_parameterless_regexp, modifier_return_name_parameterless_replace);
                } else if (methodCode === 55) {
                    console.log("    构造器 参数列表");
                    text = text.replace(constructor_parameter_regexp, constructor_parameter_replace);
                } else if (methodCode === 11) {
                    console.log("    构造器 无参数");
                    text = text.replace(constructor_parameterless_regexp, constructor_parameterless_replace);
                }
                text = methondReading(text);
            } else {
                console.log("不是方法")
                text = preprocessingText(text);
            }
            console.log(text + '\n');
            speak(text, parentElement);
        }
        element[i].append(speakBtn);
    }
    return (i + number);
}
function setButtonStyle(button) {
    if (button.innerText.startsWith('朗读')) {
        button.style.fontSize = '12px';
        button.style.backgroundColor = '#008CBA';
    } else {
        button.style.fontSize = '0.8em';
        if (button.innerText == '显示' || button.innerText == '隐藏') {
            button.style.backgroundColor = '#d54b4b';
        } else {
            button.style.backgroundColor = '#25d37c';
        }
        button.style.display = 'block';
    }
    button.style.border = 'none';
    button.style.marginTop = '0.5em';
    button.style.borderRadius = '2px';
}
window.onload = function () {
    const article_div = document.querySelector('body > main > div> div> article');
    const p_ul_ol_h = article_div.querySelectorAll('p:not(.image-caption,:has(img)),div:not(.post-copyright)>ul,div>ol,div>pre,h1:not(.post-title),h2,h3,h4,h5,h6');
    let number = addSpeckBtn(p_ul_ol_h, 0);
    const table_td = article_div.querySelectorAll('div > table tr > th,td:not(.code,.gutter)');
    addSpeckBtn(table_td, number);
    const readAllBtn = document.createElement('button');
    readAllBtn.innerText = "开始";
    setButtonStyle(readAllBtn);
    readAllBtn.onclick = function () {
        const sttButtonS = document.querySelectorAll('button.speak_btn');
        console.log(sttButtonS);
        for (let i = 0; i < sttButtonS.length; i++) {
            sttButtonS[i].click();
        }
    }
    const reloadBtn = document.createElement('button');
    reloadBtn.innerText = "刷新";
    setButtonStyle(reloadBtn);
    reloadBtn.onclick = function () {
        location.reload();
        window.scrollTo(0, 0);
    }
    const pauseBtn = document.createElement('button');
    pauseBtn.innerText = "暂停";
    setButtonStyle(pauseBtn);
    pauseBtn.onclick = function () {
        if (pauseBtn.innerText === "暂停") {
            window.speechSynthesis.pause();
            pauseBtn.innerText = "继续";
        } else if (pauseBtn.innerText === "继续") {
            window.speechSynthesis.resume();
            pauseBtn.innerText = "暂停";
        }
    }
    const readStopBtn = document.createElement('button');
    readStopBtn.innerText = "停止";
    setButtonStyle(readStopBtn);
    readStopBtn.onclick = function () {
        window.speechSynthesis.cancel()
        const sttButtonS = document.querySelectorAll('button.speak_btn');
        for (let i = 0; i < sttButtonS.length; i++) {
            sttButtonS[i].parentElement.style.backgroundColor = '#fff';
        }
    }
    const divTop = document.createElement('div');
    divTop.id = 'blog_reading_control_div';
    divTop.style.position = 'fixed';
    divTop.style.zIndex = '9999';
    divTop.style.textAlign = 'center';
    divTop.style.bottom = '1em';
    divTop.style.left = '0em';
    divTop.style.lineHeight = '1.15';
    const controlDiv = document.createElement('div');
    const showHideBtn = document.createElement('button');
    showHideBtn.innerText = '隐藏';
    showHideBtn.onclick = function (ev) {
        if (showHideBtn.innerText === '隐藏') {
            controlDiv.style.display = 'none';
            showHideBtn.innerText = '显示';
        } else if (showHideBtn.innerText === '显示') {
            controlDiv.style.display = 'block';
            showHideBtn.innerText = '隐藏';
        }
    }
    setButtonStyle(showHideBtn);
    controlDiv.append(reloadBtn);
    controlDiv.append(readAllBtn);
    controlDiv.append(pauseBtn);
    controlDiv.append(readStopBtn);
    divTop.append(controlDiv);
    divTop.append(showHideBtn);
    document.body.appendChild(divTop);
}
  </script>
  <!--博客朗读功能结束-->
</div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
      <span>站点总字数：</span>
    <span title="站点总字数">5.9m</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span>站点阅读时长 &asymp;</span>
    <span title="站点阅读时长">88:42</span>
  </span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@next-theme/pjax@0.5.0/pjax.min.js" integrity="sha256-3NkoLDrmHLTYj7csHIZSr0MHAFTXth7Ua/DDt4MRUAg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/lozad@1.16.0/dist/lozad.min.js" integrity="sha256-mOFREFhqmHeQbXpK2lp4nA3qooVgACfh88fpJftLBbc=" crossorigin="anonymous"></script>
<script src="/JavaReadingNotes/js/comments.js"></script><script src="/JavaReadingNotes/js/utils.js"></script><script src="/JavaReadingNotes/js/motion.js"></script><script src="/JavaReadingNotes/js/next-boot.js"></script><script src="/JavaReadingNotes/js/pjax.js"></script>

  
<script src="https://cdn.jsdelivr.net/npm/hexo-generator-searchdb@1.4.0/dist/search.js" integrity="sha256-vXZMYLEqsROAXkEw93GGIvaB2ab+QW6w3+1ahD9nXXA=" crossorigin="anonymous"></script>
<script src="/JavaReadingNotes/js/third-party/search/local-search.js"></script>



  <script src="/JavaReadingNotes/js/third-party/fancybox.js"></script>

  <script src="/JavaReadingNotes/js/third-party/pace.js"></script>

  




  

  <script class="next-config" data-name="enableMath" type="application/json">false</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js","integrity":"sha256-r+3itOMtGGjap0x+10hu6jW/gZCzxHsoKrOd7gyRSGY="}}</script>
<script src="/JavaReadingNotes/js/third-party/math/mathjax.js"></script>


  <script src="https://cdn.jsdelivr.net/npm/quicklink@2.2.0/dist/quicklink.umd.js" integrity="sha256-4kQf9z5ntdQrzsBC3YSHnEz02Z9C1UeW/E9OgnvlzSY=" crossorigin="anonymous"></script>
  <script class="next-config" data-name="quicklink" type="application/json">{"enable":true,"home":true,"archive":true,"delay":true,"timeout":3000,"priority":true,"url":"https://lanlan2017.github.io/JavaReadingNotes/page/111/"}</script>
  <script src="/JavaReadingNotes/js/third-party/quicklink.js"></script>
<script class="next-config" data-name="waline" type="application/json">{"lang":null,"enable":true,"serverURL":"https://waline-test-lanlan2017.vercel.app","placeholder":"填写邮箱可接收回复通知 填写个人网址可为您引流","avatar":"mm","pageSize":10,"visitor":false,"comment_count":true,"requiredFields":[],"meta":["nick","mail","link"],"libUrl":"https://cdn.jsdelivr.net/npm/@waline/client/dist/Waline.min.js","el":"#waline-comments","path":"/JavaReadingNotes/page/111/"}</script>
<script>
document.addEventListener('page:loaded', () => {
  NexT.utils.loadComments(CONFIG.waline.el).then(() => 
    NexT.utils.getScript(CONFIG.waline.libUrl, { condition: window.Waline })
  ).then(() => {
    new Waline(CONFIG.waline);
  });
});
</script>
</body>
</html>
