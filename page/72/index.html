<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)">
<meta name="generator" content="Hexo 5.4.0">

<link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>
  <link rel="apple-touch-icon" sizes="180x180" href="/JavaReadingNotes/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/JavaReadingNotes/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/JavaReadingNotes/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/JavaReadingNotes/images/logo.svg" color="#222">
  <meta name="google-site-verification" content="_Sly-yzHYmALHXzjFpPWsodMrjBSphw7bfRbMUH80Qc">
  <meta name="msvalidate.01" content="B1CFD346B8DEBBFE0C983C2AF8955531">
  <meta name="baidu-site-verification" content="vkMTwK56xr">

<link rel="stylesheet" href="/JavaReadingNotes/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/themes/blue/pace-theme-minimal.css">
  <script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"lanlan2017.github.io","root":"/JavaReadingNotes/","images":"/JavaReadingNotes/images","scheme":"Gemini","darkmode":true,"version":"8.8.2","exturl":false,"sidebar":{"position":"right","display":"post","padding":18,"offset":12},"copycode":true,"bookmark":{"enable":true,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":true,"pangu":true,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/JavaReadingNotes/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/JavaReadingNotes/js/config.js"></script>
<meta name="description" content="好好学习，天天向上">
<meta property="og:type" content="website">
<meta property="og:title" content="蓝蓝站点">
<meta property="og:url" content="https://lanlan2017.github.io/JavaReadingNotes/page/72/index.html">
<meta property="og:site_name" content="蓝蓝站点">
<meta property="og:description" content="好好学习，天天向上">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="蓝蓝">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://lanlan2017.github.io/JavaReadingNotes/page/72/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"zh-CN","comments":"","permalink":"","path":"page/72/index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>蓝蓝站点</title>
  

  <script src="/JavaReadingNotes/js/third-party/analytics/baidu-analytics.js"></script>
  <script async src="https://hm.baidu.com/hm.js?dadeb188eb14ccde0b25a19230c429b5"></script>


<link rel="dns-prefetch" href="https://waline-test-lanlan2017.vercel.app">
  <noscript>
    <link rel="stylesheet" href="/JavaReadingNotes/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/JavaReadingNotes/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">蓝蓝站点</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">Java读书笔记</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home"><a href="/JavaReadingNotes/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li>
        <li class="menu-item menu-item-dir"><a href="/JavaReadingNotes/dir/" rel="section"><i class="fa fa-sitemap fa-fw"></i>目录</a></li>
        <li class="menu-item menu-item-categories"><a href="/JavaReadingNotes/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li>
        <li class="menu-item menu-item-archives"><a href="/JavaReadingNotes/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li>
        <li class="menu-item menu-item-tags"><a href="/JavaReadingNotes/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="蓝蓝"
      src="/JavaReadingNotes/images/avatar.gif">
  <p class="site-author-name" itemprop="name">蓝蓝</p>
  <div class="site-description" itemprop="description">好好学习，天天向上</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/JavaReadingNotes/archives/">
          <span class="site-state-item-count">1871</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/JavaReadingNotes/categories/">
        <span class="site-state-item-count">626</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://lanlan2017.github.io/todo/" title="todo → https:&#x2F;&#x2F;lanlan2017.github.io&#x2F;todo&#x2F;"><i class="fa fa-check-square fa-fw"></i>todo</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://lanlan2017.github.io/links/" title="links → https:&#x2F;&#x2F;lanlan2017.github.io&#x2F;links&#x2F;"><i class="fa fa-link fa-fw"></i>links</a>
      </span>
  </div>
  <div class="cc-license site-overview-item animated" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" class="cc-opacity" rel="noopener" target="_blank"><img src="https://cdn.jsdelivr.net/npm/@creativecommons/vocabulary@2020.11.3/assets/license_badges/small/by_nc_sa.svg" alt="Creative Commons"></a>
  </div>



        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="返回顶部">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://lanlan2017.github.io/JavaReadingNotes/7b2af6c6/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/JavaReadingNotes/images/avatar.gif">
      <meta itemprop="name" content="蓝蓝">
      <meta itemprop="description" content="好好学习，天天向上">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="蓝蓝站点">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/JavaReadingNotes/7b2af6c6/" class="post-title-link" itemprop="url">12.12.5 使用JTextPane</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-02-27 05:39:13" itemprop="dateCreated datePublished" datetime="2020-02-27T05:39:13+08:00">2020-02-27</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2020-03-28 03:34:04" itemprop="dateModified" datetime="2020-03-28T03:34:04+08:00">2020-03-28</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JavaReadingNotes/categories/1-%E7%96%AF%E7%8B%82Java%E8%AE%B2%E4%B9%89-%E7%AC%AC4%E7%89%88/" itemprop="url" rel="index"><span itemprop="name">1 疯狂Java讲义 (第4版)</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JavaReadingNotes/categories/1-%E7%96%AF%E7%8B%82Java%E8%AE%B2%E4%B9%89-%E7%AC%AC4%E7%89%88/%E7%AC%AC12%E7%AB%A0-Swing%E7%BC%96%E7%A8%8B/" itemprop="url" rel="index"><span itemprop="name">第12章 Swing编程</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JavaReadingNotes/categories/1-%E7%96%AF%E7%8B%82Java%E8%AE%B2%E4%B9%89-%E7%AC%AC4%E7%89%88/%E7%AC%AC12%E7%AB%A0-Swing%E7%BC%96%E7%A8%8B/12-12-%E5%88%9B%E5%BB%BA%E6%A0%BC%E5%BC%8F%E6%96%87%E6%9C%AC/" itemprop="url" rel="index"><span itemprop="name">12.12 创建格式文本</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
    <span class="post-meta-item-icon">
      <i class="far fa-comment"></i>
    </span>
    <span class="post-meta-item-text">Waline：</span>
  
    <a title="waline" href="/JavaReadingNotes/7b2af6c6/#waline-comments" itemprop="discussionUrl">
      <span class="post-comments-count waline-comment-count" id="/JavaReadingNotes/7b2af6c6/" data-xid="/JavaReadingNotes/7b2af6c6/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>12k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>11 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="12-12-5-使用JTextPane"><a href="#12-12-5-使用JTextPane" class="headerlink" title="12.12.5 使用JTextPane"></a>12.12.5 使用JTextPane</h1><p>使用<code>EditPlus</code>、<code>Eclipse</code>等工具时会发现,当在这些工具中输入代码时,如果输入的单词是程序关键字、类名等,则这些关键字将会自动变色。<strong>使用<code>JTextPane</code>组件,就可以开发出这种带有语法高亮的编辑器</strong><br><code>JTextPane</code>使用<code>StyledDocument</code>作为它的<code>model</code>对象,而**<code>StyleDocument</code>允许对文档的不同段落分别设置不同的颜色、字体属性**。<br><code>Document</code>使用<code>Element</code>来表示文档中的组成部分,<code>Element</code>可以表示章(<code>chapter</code>)、段落(<code>paragraph</code>)等.<br>在普通文档中,<code>Element</code>也可以表示一行。</p>
<h2 id="AttributeSet接口"><a href="#AttributeSet接口" class="headerlink" title="AttributeSet接口"></a>AttributeSet接口</h2><p><strong>为了设置<code>StyledDocument</code>中文字的字体、颜色,<mark><code>Swing</code>提供了<code>AttributeSet</code>接口来表示文档字体、颜色等属性</mark><strong>。<br><code>Swing</code>为<code>StyledDocument</code>提供了<code>DefaultstyledDocument</code>实现类,该实现类就是<code>JTextPane</code>的<code>model</code>实现类;为<code>AttributeSet</code>接口提供了<code>MutableAttributeSet</code>子接口,并为该接口提供了</strong><code>SimpleAttributeSet</code>实现类</strong>,程序通过这些接口和实现类就可以很好地控制<code>JTextPane</code>中文字的字体和颜色。</p>
<h2 id="StyledDocument"><a href="#StyledDocument" class="headerlink" title="StyledDocument"></a>StyledDocument</h2><p><code>StyledDocument</code>提供了如下一个方法来设置文档中局部文字的字体、颜色</p>
<table>
<thead>
<tr>
<th align="left">方法</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>void setParagraphAttributes(int offset, int length, AttributeSet s, boolean replace)</code></td>
<td align="left">设置文档中从<code>offset</code>开始,长度为<code>length</code>处的文字使用s属性(控制字体、颜色等),最后一个参数控制新属性是替换原有属性,还是将新属性累加到原有属性上。</td>
</tr>
</tbody></table>
<h2 id="StyleConstants工具类"><a href="#StyleConstants工具类" class="headerlink" title="StyleConstants工具类"></a>StyleConstants工具类</h2><p><code>AttributeSet</code>的常用实现类是<code>MutableAttributeSet</code>,为了给<code>MutableAttributeSet</code>对象设置字体、颜色等属性,<code>Swing</code>提供了<code>StyleConstants</code>工具类,该工具类里大致包含了如下常用的静态方法来设置<code>MutableAttributeSet</code>里的字体、颜色等。</p>
<table>
<thead>
<tr>
<th align="left">方法</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>static void setAlignment(MutableAttributeSet a, int align)</code></td>
<td align="left">设置文本对齐方式。</td>
</tr>
<tr>
<td align="left"><code>static void setBackground(MutableAttributeSet a, Color fg)</code></td>
<td align="left">设置背景色</td>
</tr>
<tr>
<td align="left"><code>static void setBold(MutableAttributeSet a, boolean b)</code></td>
<td align="left">设置是否使用粗体字</td>
</tr>
<tr>
<td align="left"><code>static void setFirstLineIndent(MutableAttributeSet a, float i)</code></td>
<td align="left">设置首行缩进的大小。</td>
</tr>
<tr>
<td align="left"><code>static void setFontFamily(MutableAttributeSet a, String fam)</code></td>
<td align="left">设置字体。</td>
</tr>
<tr>
<td align="left"><code>static void setFontSize(MutableAttributeSet a, int s)</code></td>
<td align="left">设置字体大小。</td>
</tr>
<tr>
<td align="left"><code>static void setForeground(MutableAttributeSet a, Color fg)</code></td>
<td align="left">设置字体前景色。</td>
</tr>
<tr>
<td align="left"><code>static void setItalic(MutableAttributeSet a, boolean b)</code></td>
<td align="left">设置是否采用斜体字。</td>
</tr>
<tr>
<td align="left"><code>static void setLeftIndent(MutableAttributeSet a, float i)</code></td>
<td align="left">设置左边缩进大小。</td>
</tr>
<tr>
<td align="left"><code>static void setLineSpacing(MutableAttributeSet a, float i)</code></td>
<td align="left">设置行间距。</td>
</tr>
<tr>
<td align="left"><code>static void setRightIndent(MutableAttributeSet a, float i)</code></td>
<td align="left">设置右边缩进大小。</td>
</tr>
<tr>
<td align="left"><code>static void setStrikeThrough(MutableAttributeSet a, boolean b)</code></td>
<td align="left">设置是否为文字添加删除线。</td>
</tr>
<tr>
<td align="left"><code>static void setSubscript(MutableAttributeSet a, boolean b)</code></td>
<td align="left">设置将指定文字设置成下标。</td>
</tr>
<tr>
<td align="left"><code>static void setSuperscript(MutableAttributeSet a, boolean b)</code></td>
<td align="left">设置将指定文字设置成上标。</td>
</tr>
<tr>
<td align="left"><code>static void setUnderline(MutableAttributeSet a, boolean b)</code></td>
<td align="left">设置是否为文字添加下画线。</td>
</tr>
</tbody></table>
<p>上面这些方法用于控制文档中<strong>文字的外观样式</strong>,如果读者对这些外观样式不是太熟悉,则可以参考<code>Word</code>里设置“字体”属性的设置效果。<br>图12.60显示了<code>Document</code>及其相关实现类,以及相关辅助类的类关系图。</p>
<h2 id="程序-文本编辑器设置-字体-颜色"><a href="#程序-文本编辑器设置-字体-颜色" class="headerlink" title="程序 文本编辑器设置 字体 颜色"></a>程序 文本编辑器设置 字体 颜色</h2><p>下面程序简单地定义了三个<code>SimpleAttributeSet</code>对象,并为这三个对象设置了对应的文字、颜色、字体等属性,并使用三个<code>SimpleAttributeSet</code>对象设置文档中三段文字的外观。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.awt.*;</span><br><span class="line"><span class="keyword">import</span> javax.swing.*;</span><br><span class="line"><span class="keyword">import</span> javax.swing.text.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JTextPaneTest</span> </span>&#123;</span><br><span class="line">    JFrame mainWin = <span class="keyword">new</span> JFrame(<span class="string">&quot;测试JTextPane&quot;</span>);</span><br><span class="line">    JTextPane txt = <span class="keyword">new</span> JTextPane();</span><br><span class="line">    StyledDocument doc = txt.getStyledDocument();</span><br><span class="line">    <span class="comment">// 定义三个SimpleAttributeSet对象</span></span><br><span class="line">    SimpleAttributeSet android = <span class="keyword">new</span> SimpleAttributeSet();</span><br><span class="line">    SimpleAttributeSet java = <span class="keyword">new</span> SimpleAttributeSet();</span><br><span class="line">    SimpleAttributeSet javaee = <span class="keyword">new</span> SimpleAttributeSet();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 为android属性集设置颜色、字体大小、字体和下划线</span></span><br><span class="line">        StyleConstants.setForeground(android, Color.RED);</span><br><span class="line">        StyleConstants.setFontSize(android, <span class="number">24</span>);</span><br><span class="line">        StyleConstants.setFontFamily(android, <span class="string">&quot;Dialog&quot;</span>);</span><br><span class="line">        StyleConstants.setUnderline(android, <span class="keyword">true</span>);</span><br><span class="line">        <span class="comment">// 为java属性集设置颜色、字体大小、字体和粗体字</span></span><br><span class="line">        StyleConstants.setForeground(java, Color.BLUE);</span><br><span class="line">        StyleConstants.setFontSize(java, <span class="number">30</span>);</span><br><span class="line">        StyleConstants.setFontFamily(java, <span class="string">&quot;Arial Black&quot;</span>);</span><br><span class="line">        StyleConstants.setBold(java, <span class="keyword">true</span>);</span><br><span class="line">        <span class="comment">// 为javaee属性集设置颜色、字体大小、斜体字</span></span><br><span class="line">        StyleConstants.setForeground(javaee, Color.GREEN);</span><br><span class="line">        StyleConstants.setFontSize(javaee, <span class="number">32</span>);</span><br><span class="line">        StyleConstants.setItalic(javaee, <span class="keyword">true</span>);</span><br><span class="line">        <span class="comment">// 设置不允许编辑</span></span><br><span class="line">        txt.setEditable(<span class="keyword">false</span>);</span><br><span class="line">        txt.setText(<span class="string">&quot;疯狂Android讲义\n&quot;</span> + <span class="string">&quot;疯狂Java讲义\n&quot;</span> + <span class="string">&quot;轻量级Java EE企业应用实战\n&quot;</span>);</span><br><span class="line">        <span class="comment">// 分别为文档中三段文字设置不同的外观样式</span></span><br><span class="line">        doc.setCharacterAttributes(<span class="number">0</span>, <span class="number">12</span>, android, <span class="keyword">true</span>);</span><br><span class="line">        doc.setCharacterAttributes(<span class="number">12</span>, <span class="number">12</span>, java, <span class="keyword">true</span>);</span><br><span class="line">        doc.setCharacterAttributes(<span class="number">24</span>, <span class="number">30</span>, javaee, <span class="keyword">true</span>);</span><br><span class="line">        mainWin.add(<span class="keyword">new</span> JScrollPane(txt), BorderLayout.CENTER);</span><br><span class="line">        <span class="comment">// 获取屏幕尺寸</span></span><br><span class="line">        Dimension screenSize = Toolkit.getDefaultToolkit().getScreenSize();</span><br><span class="line">        <span class="keyword">int</span> inset = <span class="number">100</span>;</span><br><span class="line">        <span class="comment">// 设置主窗口的大小</span></span><br><span class="line">        mainWin.setBounds(inset, inset, screenSize.width - inset * <span class="number">2</span>, screenSize.height - inset * <span class="number">2</span>);</span><br><span class="line">        mainWin.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);</span><br><span class="line">        mainWin.setVisible(<span class="keyword">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">new</span> JTextPaneTest().init();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>上面程序其实很简单,程序中的第一段粗体字代码为三个<code>SimpleAttributeSet</code>对象设置了字体、字体大小、颜色等外观样式,第二段粗体字代码使用前面的三个<code>SimpleAttributeSet</code>对象来控制文档中三段文字的外观样式。运行上面程序,将看到如图12.61所示的界面。<br><img data-src="https://raw.githubusercontent.com/lanlan2017/images/master/CrazyJavaHandout4/Chapter12/12.12.5/1.png"><br>从图12.61中可以看出,窗口中文字具有丰富的外观,而且还可以选中这些文字,表明它们依然是文字,而不是直接绘制上去的图形。<br>如果希望开发出类似于<code>Editplus</code>、<code>Eclipse</code>等的代码编辑窗口,程序可以扩展<code>JTextPane</code>的子类,为该对象添加按键监听器和文档监听器。当文档内容被修改时,或者用户在该文档内进行击键动作时,程序负责分析该文档的内容,对特殊关键字设置字体颜色。</p>
<p>为了保证具有较好的性能,程序并不总是分析文档中的所有内容,而是只分析文档中被改变的部分,这个要求看似简单,只为文档添加文档监听器即可:当文档内容改变时分析被改变部分,并设置其中关键字的颜色。但问题是:<code>Documentlistener</code>监听器里的三个方法不能改变文档本身,所以程序还是必须通过监听按键事件来启动语法分析,<code>DocumentListener</code>监听器中仅仅记录文档改变部分的位置和长度。<br>除此之外,程序还提供了一个<code>SyntaxFormatter</code>类根据语法文件来设置文档中的文字颜色。</p>
<h2 id="程序-带语法高亮的文本编辑器-单词着色"><a href="#程序-带语法高亮的文本编辑器-单词着色" class="headerlink" title="程序 带语法高亮的文本编辑器 单词着色"></a>程序 带语法高亮的文本编辑器 单词着色</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.awt.*;</span><br><span class="line"><span class="keyword">import</span> java.awt.event.*;</span><br><span class="line"><span class="keyword">import</span> javax.swing.*;</span><br><span class="line"><span class="keyword">import</span> javax.swing.event.*;</span><br><span class="line"><span class="keyword">import</span> javax.swing.text.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyTextPane</span> <span class="keyword">extends</span> <span class="title">JTextPane</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">7177281290506716762L</span>;</span><br><span class="line">    <span class="keyword">protected</span> StyledDocument doc;</span><br><span class="line">    <span class="keyword">protected</span> SyntaxFormatter formatter = <span class="keyword">new</span> SyntaxFormatter(<span class="string">&quot;my.stx&quot;</span>);</span><br><span class="line">    <span class="comment">// 定义该文档的普通文本的外观属性</span></span><br><span class="line">    <span class="keyword">private</span> SimpleAttributeSet normalAttr = formatter.getNormalAttributeSet();</span><br><span class="line">    <span class="keyword">private</span> SimpleAttributeSet quotAttr = <span class="keyword">new</span> SimpleAttributeSet();</span><br><span class="line">    <span class="comment">// 保存文档改变的开始位置</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> docChangeStart = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">// 保存文档改变的长度</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> docChangeLength = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MyTextPane</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        StyleConstants.setForeground(quotAttr, <span class="keyword">new</span> Color(<span class="number">255</span>, <span class="number">0</span>, <span class="number">255</span>));</span><br><span class="line">        StyleConstants.setFontSize(quotAttr, <span class="number">16</span>);</span><br><span class="line">        <span class="keyword">this</span>.doc = <span class="keyword">super</span>.getStyledDocument();</span><br><span class="line">        <span class="comment">// 设置该文档的页边距</span></span><br><span class="line">        <span class="keyword">this</span>.setMargin(<span class="keyword">new</span> Insets(<span class="number">3</span>, <span class="number">40</span>, <span class="number">0</span>, <span class="number">0</span>));</span><br><span class="line">        <span class="comment">// 添加按键监听器，当按键松开时进行语法分析</span></span><br><span class="line">        <span class="keyword">this</span>.addKeyListener(<span class="keyword">new</span> KeyAdapter() &#123;</span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">keyReleased</span><span class="params">(KeyEvent ke)</span> </span>&#123;</span><br><span class="line">                syntaxParse();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="comment">// 添加文档监听器</span></span><br><span class="line">        doc.addDocumentListener(<span class="keyword">new</span> DocumentListener() &#123;</span><br><span class="line">            <span class="comment">// 当Document的属性或属性集发生了改变时触发该方法</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">changedUpdate</span><span class="params">(DocumentEvent e)</span> </span>&#123;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 当向Document中插入文本时触发该方法</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">insertUpdate</span><span class="params">(DocumentEvent e)</span> </span>&#123;</span><br><span class="line">                docChangeStart = e.getOffset();</span><br><span class="line">                docChangeLength = e.getLength();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 当从Document中删除文本时触发该方法</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">removeUpdate</span><span class="params">(DocumentEvent e)</span> </span>&#123;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">syntaxParse</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// 获取文档的根元素，即文档内的全部内容</span></span><br><span class="line">            Element root = doc.getDefaultRootElement();</span><br><span class="line">            <span class="comment">// 获取文档中光标插入符的位置</span></span><br><span class="line">            <span class="keyword">int</span> cursorPos = <span class="keyword">this</span>.getCaretPosition();</span><br><span class="line">            <span class="keyword">int</span> line = root.getElementIndex(cursorPos);</span><br><span class="line">            <span class="comment">// 获取光标所在位置的行</span></span><br><span class="line">            Element para = root.getElement(line);</span><br><span class="line">            <span class="comment">// 定义光标所在行的行头在文档中位置</span></span><br><span class="line">            <span class="keyword">int</span> start = para.getStartOffset();</span><br><span class="line">            <span class="comment">// 让start等于start与docChangeStart中较小值。</span></span><br><span class="line">            start = start &gt; docChangeStart ? docChangeStart : start;</span><br><span class="line">            <span class="comment">// 定义被修改部分的长度</span></span><br><span class="line">            <span class="keyword">int</span> length = para.getEndOffset() - start;</span><br><span class="line">            length = length &lt; docChangeLength ? docChangeLength + <span class="number">1</span> : length;</span><br><span class="line">            <span class="comment">// 取出所有可能被修改的字符串</span></span><br><span class="line">            String s = doc.getText(start, length);</span><br><span class="line">            <span class="comment">// 以空格、点号等作为分隔符</span></span><br><span class="line">            String[] tokens = s.split(<span class="string">&quot;\\s+|\\.|\\(|\\)|\\&#123;|\\&#125;|\\[|\\]&quot;</span>);</span><br><span class="line">            <span class="comment">// 定义当前分析单词的在s字符串中的开始位置</span></span><br><span class="line">            <span class="keyword">int</span> curStart = <span class="number">0</span>;</span><br><span class="line">            <span class="comment">// 定义单词是否处于引号以内</span></span><br><span class="line">            <span class="keyword">boolean</span> isQuot = <span class="keyword">false</span>;</span><br><span class="line">            <span class="keyword">for</span> (String token : tokens) &#123;</span><br><span class="line">                <span class="comment">// 找出当前分析单词在s字符串中的位置</span></span><br><span class="line">                <span class="keyword">int</span> tokenPos = s.indexOf(token, curStart);</span><br><span class="line">                <span class="keyword">if</span> (isQuot &amp;&amp; (token.endsWith(<span class="string">&quot;\&quot;&quot;</span>) || token.endsWith(<span class="string">&quot;\&#x27;&quot;</span>))) &#123;</span><br><span class="line">                    doc.setCharacterAttributes(start + tokenPos, token.length(), quotAttr, <span class="keyword">false</span>);</span><br><span class="line">                    isQuot = <span class="keyword">false</span>;</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (isQuot &amp;&amp; !(token.endsWith(<span class="string">&quot;\&quot;&quot;</span>) || token.endsWith(<span class="string">&quot;\&#x27;&quot;</span>))) &#123;</span><br><span class="line">                    doc.setCharacterAttributes(start + tokenPos, token.length(), quotAttr, <span class="keyword">false</span>);</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> ((token.startsWith(<span class="string">&quot;\&quot;&quot;</span>) || token.startsWith(<span class="string">&quot;\&#x27;&quot;</span>))</span><br><span class="line">                        &amp;&amp; (token.endsWith(<span class="string">&quot;\&quot;&quot;</span>) || token.endsWith(<span class="string">&quot;\&#x27;&quot;</span>))) &#123;</span><br><span class="line">                    doc.setCharacterAttributes(start + tokenPos, token.length(), quotAttr, <span class="keyword">false</span>);</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> ((token.startsWith(<span class="string">&quot;\&quot;&quot;</span>) || token.startsWith(<span class="string">&quot;\&#x27;&quot;</span>))</span><br><span class="line">                        &amp;&amp; !(token.endsWith(<span class="string">&quot;\&quot;&quot;</span>) || token.endsWith(<span class="string">&quot;\&#x27;&quot;</span>))) &#123;</span><br><span class="line">                    doc.setCharacterAttributes(start + tokenPos, token.length(), quotAttr, <span class="keyword">false</span>);</span><br><span class="line">                    isQuot = <span class="keyword">true</span>;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="comment">// 使用格式器对当前单词设置颜色</span></span><br><span class="line">                    formatter.setHighLight(doc, token, start + tokenPos, token.length());</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">// 开始分析下一个单词</span></span><br><span class="line">                curStart = tokenPos + token.length();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception ex) &#123;</span><br><span class="line">            ex.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 重画该组件，设置行号</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">paint</span><span class="params">(Graphics g)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.paint(g);</span><br><span class="line">        Element root = doc.getDefaultRootElement();</span><br><span class="line">        <span class="comment">// 获得行号</span></span><br><span class="line">        <span class="keyword">int</span> line = root.getElementIndex(doc.getLength());</span><br><span class="line">        <span class="comment">// 设置颜色</span></span><br><span class="line">        g.setColor(<span class="keyword">new</span> Color(<span class="number">230</span>, <span class="number">230</span>, <span class="number">230</span>));</span><br><span class="line">        <span class="comment">// 绘制显示行数的矩形框</span></span><br><span class="line">        g.fillRect(<span class="number">0</span>, <span class="number">0</span>, <span class="keyword">this</span>.getMargin().left - <span class="number">10</span>, getSize().height);</span><br><span class="line">        <span class="comment">// 设置行号的颜色</span></span><br><span class="line">        g.setColor(<span class="keyword">new</span> Color(<span class="number">40</span>, <span class="number">40</span>, <span class="number">40</span>));</span><br><span class="line">        <span class="comment">// 每行绘制一个行号</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> count = <span class="number">0</span>, j = <span class="number">1</span>; count &lt;= line; count++, j++) &#123;</span><br><span class="line">            g.drawString(String.valueOf(j), <span class="number">3</span>, (<span class="keyword">int</span>) ((count + <span class="number">1</span>) * <span class="number">1.535</span> * StyleConstants.getFontSize(normalAttr)));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        JFrame frame = <span class="keyword">new</span> JFrame(<span class="string">&quot;文本编辑器&quot;</span>);</span><br><span class="line">        <span class="comment">// 使用MyTextPane</span></span><br><span class="line">        frame.getContentPane().add(<span class="keyword">new</span> JScrollPane(<span class="keyword">new</span> MyTextPane()));</span><br><span class="line">        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);</span><br><span class="line">        <span class="keyword">final</span> <span class="keyword">int</span> inset = <span class="number">50</span>;</span><br><span class="line">        Dimension screenSize = Toolkit.getDefaultToolkit().getScreenSize();</span><br><span class="line">        frame.setBounds(inset, inset, screenSize.width - inset * <span class="number">2</span>, screenSize.height - inset * <span class="number">2</span>);</span><br><span class="line">        frame.setVisible(<span class="keyword">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义语法格式器</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SyntaxFormatter</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 以一个Map保存关键字和颜色的对应关系</span></span><br><span class="line">    <span class="keyword">private</span> Map&lt;SimpleAttributeSet, ArrayList&lt;String&gt;&gt; attMap = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">    <span class="comment">// 定义文档的正常文本的外观属性</span></span><br><span class="line">    SimpleAttributeSet normalAttr = <span class="keyword">new</span> SimpleAttributeSet();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">SyntaxFormatter</span><span class="params">(String syntaxFile)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 设置正常文本的颜色、大小</span></span><br><span class="line">        StyleConstants.setForeground(normalAttr, Color.BLACK);</span><br><span class="line">        StyleConstants.setFontSize(normalAttr, <span class="number">16</span>);</span><br><span class="line">        <span class="comment">// 创建一个Scanner对象，负责根据语法文件加载颜色信息</span></span><br><span class="line">        Scanner scaner = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            scaner = <span class="keyword">new</span> Scanner(<span class="keyword">new</span> File(syntaxFile));</span><br><span class="line">        &#125; <span class="keyword">catch</span> (FileNotFoundException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">&quot;丢失语法文件：&quot;</span> + e.getMessage());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> color = -<span class="number">1</span>;</span><br><span class="line">        ArrayList&lt;String&gt; keywords = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        <span class="comment">// 不断读取语法文件的内容行</span></span><br><span class="line">        <span class="keyword">while</span> (scaner.hasNextLine()) &#123;</span><br><span class="line">            String line = scaner.nextLine();</span><br><span class="line">            <span class="comment">// 如果当前行以#开头</span></span><br><span class="line">            <span class="keyword">if</span> (line.startsWith(<span class="string">&quot;#&quot;</span>)) &#123;</span><br><span class="line">                <span class="keyword">if</span> (keywords.size() &gt; <span class="number">0</span> &amp;&amp; color &gt; -<span class="number">1</span>) &#123;</span><br><span class="line">                    <span class="comment">// 取出当前行的颜色值，并封装成SimpleAttributeSet对象</span></span><br><span class="line">                    SimpleAttributeSet att = <span class="keyword">new</span> SimpleAttributeSet();</span><br><span class="line">                    StyleConstants.setForeground(att, <span class="keyword">new</span> Color(color));</span><br><span class="line">                    StyleConstants.setFontSize(att, <span class="number">16</span>);</span><br><span class="line">                    <span class="comment">// 将当前颜色和关键字List对应起来</span></span><br><span class="line">                    attMap.put(att, keywords);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">// 重新创建新的关键字List，为下一个语法格式准备</span></span><br><span class="line">                keywords = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">                color = Integer.parseInt(line.substring(<span class="number">1</span>), <span class="number">16</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="comment">// 对于普通行，每行内容添加到关键字List里</span></span><br><span class="line">                <span class="keyword">if</span> (line.trim().length() &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                    keywords.add(line.trim());</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 把所有关键字和颜色对应起来</span></span><br><span class="line">        <span class="keyword">if</span> (keywords.size() &gt; <span class="number">0</span> &amp;&amp; color &gt; -<span class="number">1</span>) &#123;</span><br><span class="line">            SimpleAttributeSet att = <span class="keyword">new</span> SimpleAttributeSet();</span><br><span class="line">            StyleConstants.setForeground(att, <span class="keyword">new</span> Color(color));</span><br><span class="line">            StyleConstants.setFontSize(att, <span class="number">16</span>);</span><br><span class="line">            attMap.put(att, keywords);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 返回该格式器里正常文本的外观属性</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> SimpleAttributeSet <span class="title">getNormalAttributeSet</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> normalAttr;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 设置语法高亮</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setHighLight</span><span class="params">(StyledDocument doc, String token, <span class="keyword">int</span> start, <span class="keyword">int</span> length)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 保存需要对当前单词对应的外观属性</span></span><br><span class="line">        SimpleAttributeSet currentAttributeSet = <span class="keyword">null</span>;</span><br><span class="line">        outer: <span class="keyword">for</span> (SimpleAttributeSet att : attMap.keySet()) &#123;</span><br><span class="line">            <span class="comment">// 取出当前颜色对应的所有关键字</span></span><br><span class="line">            ArrayList&lt;String&gt; keywords = attMap.get(att);</span><br><span class="line">            <span class="comment">// 遍历所有关键字</span></span><br><span class="line">            <span class="keyword">for</span> (String keyword : keywords) &#123;</span><br><span class="line">                <span class="comment">// 如果该关键字与当前单词相同</span></span><br><span class="line">                <span class="keyword">if</span> (keyword.equals(token)) &#123;</span><br><span class="line">                    <span class="comment">// 跳出循环，并设置当前单词对应的外观属性</span></span><br><span class="line">                    currentAttributeSet = att;</span><br><span class="line">                    <span class="keyword">break</span> outer;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 如果当前单词对应的外观属性不为空</span></span><br><span class="line">        <span class="keyword">if</span> (currentAttributeSet != <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="comment">// 设置当前单词的颜色</span></span><br><span class="line">            doc.setCharacterAttributes(start, length, currentAttributeSet, <span class="keyword">false</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 否则使用普通外观来设置该单词</span></span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            doc.setCharacterAttributes(start, length, normalAttr, <span class="keyword">false</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="配置文件"><a href="#配置文件" class="headerlink" title="配置文件"></a>配置文件</h3><details><summary>展开/折叠</summary>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">#FF0000</span><br><span class="line">System</span><br><span class="line">Class</span><br><span class="line">String</span><br><span class="line">Integer</span><br><span class="line">Object</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#0000FF</span><br><span class="line">abstract</span><br><span class="line">assert</span><br><span class="line">boolean</span><br><span class="line">break</span><br><span class="line">byte</span><br><span class="line">case</span><br><span class="line">catch</span><br><span class="line">char</span><br><span class="line">class</span><br><span class="line">const</span><br><span class="line">continue</span><br><span class="line">default</span><br><span class="line">do</span><br><span class="line">double</span><br><span class="line">else</span><br><span class="line">enum</span><br><span class="line">extends</span><br><span class="line">false</span><br><span class="line">final</span><br><span class="line">finally</span><br><span class="line">float</span><br><span class="line">for</span><br><span class="line">goto</span><br><span class="line">if</span><br><span class="line">import</span><br><span class="line">implements</span><br><span class="line">int</span><br><span class="line">interface</span><br><span class="line">instanceof</span><br><span class="line">long</span><br><span class="line">native</span><br><span class="line">new</span><br><span class="line">null</span><br><span class="line">package</span><br><span class="line">private</span><br><span class="line">protected</span><br><span class="line">public</span><br><span class="line">return</span><br><span class="line">short</span><br><span class="line">static</span><br><span class="line">strictfp</span><br><span class="line">super</span><br><span class="line">switch</span><br><span class="line">synchronized</span><br><span class="line">this</span><br><span class="line">throw</span><br><span class="line">throws</span><br><span class="line">transient</span><br><span class="line">try</span><br><span class="line">true</span><br><span class="line">void</span><br><span class="line">volatile</span><br><span class="line">while</span><br></pre></td></tr></table></figure>

</details>

<p>上面程序中的粗体字代码负责分析当前单词与哪种颜色关键字匹配,并为这段文字设置字体颜色。其实这段程序为文档中的单词设置颜色并不难,难点在于找出每个单词与哪种关键字匹配,并要标识出该单词在文档中的位置,然后才可以为该单词设置颜色。<br>运行上面程序,会看到如图12.62所示的带语法高亮的文本编辑器<br><img data-src="https://raw.githubusercontent.com/lanlan2017/images/master/CrazyJavaHandout4/Chapter12/12.12.5/2.png"></p>
<!-- CrazyJavaHandout4/Chapter12/12.12.5/2 -->
<p>上面程序已经完成了对不同类型的单词进行着色,所以会看到如图12.62示的运行界面。如果进行改进,则可以为上面的编辑器增加括号配对、代码折叠等功能,这些都可以通过<code>JTextPane</code>组件来完成对于此文本编辑器,只要传入不同的语法文件,程序就可以为不同的源代码显示语法高亮</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://lanlan2017.github.io/JavaReadingNotes/3374add6/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/JavaReadingNotes/images/avatar.gif">
      <meta itemprop="name" content="蓝蓝">
      <meta itemprop="description" content="好好学习，天天向上">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="蓝蓝站点">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/JavaReadingNotes/3374add6/" class="post-title-link" itemprop="url">12.12.4 使用JEditorPane</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-02-27 05:31:05" itemprop="dateCreated datePublished" datetime="2020-02-27T05:31:05+08:00">2020-02-27</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2020-03-03 04:57:54" itemprop="dateModified" datetime="2020-03-03T04:57:54+08:00">2020-03-03</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JavaReadingNotes/categories/1-%E7%96%AF%E7%8B%82Java%E8%AE%B2%E4%B9%89-%E7%AC%AC4%E7%89%88/" itemprop="url" rel="index"><span itemprop="name">1 疯狂Java讲义 (第4版)</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JavaReadingNotes/categories/1-%E7%96%AF%E7%8B%82Java%E8%AE%B2%E4%B9%89-%E7%AC%AC4%E7%89%88/%E7%AC%AC12%E7%AB%A0-Swing%E7%BC%96%E7%A8%8B/" itemprop="url" rel="index"><span itemprop="name">第12章 Swing编程</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JavaReadingNotes/categories/1-%E7%96%AF%E7%8B%82Java%E8%AE%B2%E4%B9%89-%E7%AC%AC4%E7%89%88/%E7%AC%AC12%E7%AB%A0-Swing%E7%BC%96%E7%A8%8B/12-12-%E5%88%9B%E5%BB%BA%E6%A0%BC%E5%BC%8F%E6%96%87%E6%9C%AC/" itemprop="url" rel="index"><span itemprop="name">12.12 创建格式文本</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
    <span class="post-meta-item-icon">
      <i class="far fa-comment"></i>
    </span>
    <span class="post-meta-item-text">Waline：</span>
  
    <a title="waline" href="/JavaReadingNotes/3374add6/#waline-comments" itemprop="discussionUrl">
      <span class="post-comments-count waline-comment-count" id="/JavaReadingNotes/3374add6/" data-xid="/JavaReadingNotes/3374add6/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>2.7k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>2 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="12-12-4-使用"><a href="#12-12-4-使用" class="headerlink" title="12.12.4 使用"></a>12.12.4 使用</h1><p><code>Swing</code>提供了一个<code>JEditorPane</code>类,该类可以编辑各种文本内容,包括有格式的文本。在默认情况下,<code>JEditorPane</code>支持如下三种文本内容。</p>
<table>
<thead>
<tr>
<th align="left">JEditorPane支持的文本内容</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>text/plain</code></td>
<td align="left">纯文本,当<code>JEditorPane</code>无法识别给定内容的类型时,使用这种文本格式。在这种模式下,文本框的内容是带换行符的无格式文本。</td>
</tr>
<tr>
<td align="left"><code>text/html</code></td>
<td align="left"><code>HTML</code>文本格式。该文本组件仅支持<code>HTML3.2</code>格式,因此对互联网上复杂的网页支持非常有限。</td>
</tr>
<tr>
<td align="left"><code>text/rtf</code></td>
<td align="left"><code>RTF</code>(富文本格式)文本格式。实际上,它对<code>RTF</code>的支持非常有限。</td>
</tr>
</tbody></table>
<h2 id="JEditorPane用途有限"><a href="#JEditorPane用途有限" class="headerlink" title="JEditorPane用途有限"></a>JEditorPane用途有限</h2><p>通过上面介绍不难看出,其实<code>JEditorPane</code>类的用途非常有限,使用<code>JEditorPane</code>作为纯文本的编辑器,还不如使用<code>JTextArea;</code>如果使用<code>JEditorPane</code>来支持<code>RTF</code>文本格式,但它对这种文本格式的支持又相当有限;<strong><code>JEditorPane</code>唯一可能的用途就是显示自己的<code>HTML</code>文档,前提是这份<code>HTML</code>文档比较简单,只包含<code>HTML3.2</code>或更早的元素</strong>。</p>
<p><code>JEditorPane</code>组件支持三种方法来加载文本内容。</p>
<ul>
<li>使用<code>getText()</code>方法直接设置<code>JEditorPane</code>的文本内容。</li>
<li>使用<code>read()</code>方法从输入流中读取<code>JEditorPane</code>的文本内容。</li>
<li>使用<code>setPage()</code>方法来设置<code>JEditorPane</code>从哪个<code>URL</code>处读取文本内容。在这种情况下,将根据该<code>URL</code>来确定内容类型。</li>
</ul>
<p>在默认状态下,使用<code>JEditorPane</code>装载的文本内容是可编辑的,即使装载互联网上的网页也是如此,可以使用<code>JEditorPane</code>的<code>setEditable(false)</code>方法阻止用户编辑该<code>JEditorPane</code>里的内容。<br>当使用<code>JEditorPane</code>打开<code>HTML</code>页面时,该页面的超链接是活动的,用户可以单击超链接。如果程序想监听用户单击超链接的事件,则必须使用<code>addHyperlinkListener()</code>方法为<code>JEditorPane</code>添加一个<code>HyperlinkListener</code>监听器。</p>
<h2 id="程序"><a href="#程序" class="headerlink" title="程序"></a>程序</h2><p>从目前的功能来看,<code>JEditorPane</code>确实没有太大的实用价值,所以本书不打算给出此类的用法示例有兴趣的读者可以参考：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.awt.*;</span><br><span class="line"><span class="keyword">import</span> javax.swing.*;</span><br><span class="line"><span class="keyword">import</span> javax.swing.text.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JTextPaneTest</span> </span>&#123;</span><br><span class="line">    JFrame mainWin = <span class="keyword">new</span> JFrame(<span class="string">&quot;测试JTextPane&quot;</span>);</span><br><span class="line">    JTextPane txt = <span class="keyword">new</span> JTextPane();</span><br><span class="line">    StyledDocument doc = txt.getStyledDocument();</span><br><span class="line">    <span class="comment">// 定义三个SimpleAttributeSet对象</span></span><br><span class="line">    SimpleAttributeSet android = <span class="keyword">new</span> SimpleAttributeSet();</span><br><span class="line">    SimpleAttributeSet java = <span class="keyword">new</span> SimpleAttributeSet();</span><br><span class="line">    SimpleAttributeSet javaee = <span class="keyword">new</span> SimpleAttributeSet();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 为android属性集设置颜色、字体大小、字体和下划线</span></span><br><span class="line">        StyleConstants.setForeground(android, Color.RED);</span><br><span class="line">        StyleConstants.setFontSize(android, <span class="number">24</span>);</span><br><span class="line">        StyleConstants.setFontFamily(android, <span class="string">&quot;Dialog&quot;</span>);</span><br><span class="line">        StyleConstants.setUnderline(android, <span class="keyword">true</span>);</span><br><span class="line">        <span class="comment">// 为java属性集设置颜色、字体大小、字体和粗体字</span></span><br><span class="line">        StyleConstants.setForeground(java, Color.BLUE);</span><br><span class="line">        StyleConstants.setFontSize(java, <span class="number">30</span>);</span><br><span class="line">        StyleConstants.setFontFamily(java, <span class="string">&quot;Arial Black&quot;</span>);</span><br><span class="line">        StyleConstants.setBold(java, <span class="keyword">true</span>);</span><br><span class="line">        <span class="comment">// 为javaee属性集设置颜色、字体大小、斜体字</span></span><br><span class="line">        StyleConstants.setForeground(javaee, Color.GREEN);</span><br><span class="line">        StyleConstants.setFontSize(javaee, <span class="number">32</span>);</span><br><span class="line">        StyleConstants.setItalic(javaee, <span class="keyword">true</span>);</span><br><span class="line">        <span class="comment">// 设置不允许编辑</span></span><br><span class="line">        txt.setEditable(<span class="keyword">false</span>);</span><br><span class="line">        txt.setText(<span class="string">&quot;疯狂Android讲义\n&quot;</span> + <span class="string">&quot;疯狂Java讲义\n&quot;</span> + <span class="string">&quot;轻量级Java EE企业应用实战\n&quot;</span>);</span><br><span class="line">        <span class="comment">// 分别为文档中三段文字设置不同的外观样式</span></span><br><span class="line">        doc.setCharacterAttributes(<span class="number">0</span>, <span class="number">12</span>, android, <span class="keyword">true</span>);</span><br><span class="line">        doc.setCharacterAttributes(<span class="number">12</span>, <span class="number">12</span>, java, <span class="keyword">true</span>);</span><br><span class="line">        doc.setCharacterAttributes(<span class="number">24</span>, <span class="number">30</span>, javaee, <span class="keyword">true</span>);</span><br><span class="line">        mainWin.add(<span class="keyword">new</span> JScrollPane(txt), BorderLayout.CENTER);</span><br><span class="line">        <span class="comment">// 获取屏幕尺寸</span></span><br><span class="line">        Dimension screenSize = Toolkit.getDefaultToolkit().getScreenSize();</span><br><span class="line">        <span class="keyword">int</span> inset = <span class="number">100</span>;</span><br><span class="line">        <span class="comment">// 设置主窗口的大小</span></span><br><span class="line">        mainWin.setBounds(inset, inset, screenSize.width - inset * <span class="number">2</span>, screenSize.height - inset * <span class="number">2</span>);</span><br><span class="line">        mainWin.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);</span><br><span class="line">        mainWin.setVisible(<span class="keyword">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">new</span> JTextPaneTest().init();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>来学习该类的用法。相比之下,该类的子类<code>JTextPane</code>则功能丰富多了,下面详细介绍<code>JTextPane</code>类的用法。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://lanlan2017.github.io/JavaReadingNotes/93fa3225/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/JavaReadingNotes/images/avatar.gif">
      <meta itemprop="name" content="蓝蓝">
      <meta itemprop="description" content="好好学习，天天向上">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="蓝蓝站点">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/JavaReadingNotes/93fa3225/" class="post-title-link" itemprop="url">12.12.3 使用JFormattedTextField</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-02-26 09:42:17" itemprop="dateCreated datePublished" datetime="2020-02-26T09:42:17+08:00">2020-02-26</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2020-03-28 05:09:23" itemprop="dateModified" datetime="2020-03-28T05:09:23+08:00">2020-03-28</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JavaReadingNotes/categories/1-%E7%96%AF%E7%8B%82Java%E8%AE%B2%E4%B9%89-%E7%AC%AC4%E7%89%88/" itemprop="url" rel="index"><span itemprop="name">1 疯狂Java讲义 (第4版)</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JavaReadingNotes/categories/1-%E7%96%AF%E7%8B%82Java%E8%AE%B2%E4%B9%89-%E7%AC%AC4%E7%89%88/%E7%AC%AC12%E7%AB%A0-Swing%E7%BC%96%E7%A8%8B/" itemprop="url" rel="index"><span itemprop="name">第12章 Swing编程</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JavaReadingNotes/categories/1-%E7%96%AF%E7%8B%82Java%E8%AE%B2%E4%B9%89-%E7%AC%AC4%E7%89%88/%E7%AC%AC12%E7%AB%A0-Swing%E7%BC%96%E7%A8%8B/12-12-%E5%88%9B%E5%BB%BA%E6%A0%BC%E5%BC%8F%E6%96%87%E6%9C%AC/" itemprop="url" rel="index"><span itemprop="name">12.12 创建格式文本</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
    <span class="post-meta-item-icon">
      <i class="far fa-comment"></i>
    </span>
    <span class="post-meta-item-text">Waline：</span>
  
    <a title="waline" href="/JavaReadingNotes/93fa3225/#waline-comments" itemprop="discussionUrl">
      <span class="post-comments-count waline-comment-count" id="/JavaReadingNotes/93fa3225/" data-xid="/JavaReadingNotes/93fa3225/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>8.7k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>8 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="12-12-3-使用JFormattedTextField"><a href="#12-12-3-使用JFormattedTextField" class="headerlink" title="12.12.3 使用JFormattedTextField"></a>12.12.3 使用JFormattedTextField</h1><h2 id="合理输入问题"><a href="#合理输入问题" class="headerlink" title="合理输入问题"></a>合理输入问题</h2><p>在有些情况下,程序不希望用户在输入框内随意地输入,例如,程序需要用户输入一个有效的时间,或者需要用户输入一个有效的物品价格,<strong>如果用户输入不合理,程序应该阻止用户输入</strong>。</p>
<h3 id="使用事件监听实现"><a href="#使用事件监听实现" class="headerlink" title="使用事件监听实现"></a>使用事件监听实现</h3><p>对于这种需求,通常的做法是为该文本框添加失去焦点的监听器,再添加回车按键的监听器,当该文本框失去焦点时,或者该用户在该文本框内按回车键时,就检测用户输入是否合法。这种做法基本可以解决该问题,但编程比较烦琐!</p>
<h3 id="使用JFormattedTextField"><a href="#使用JFormattedTextField" class="headerlink" title="使用JFormattedTextField"></a>使用JFormattedTextField</h3><p><code>Swing</code>提供的<code>JFormattedTextField</code>可以更优雅地解决该问题。</p>
<h2 id="JFormattedTextField和普通文本行的区别"><a href="#JFormattedTextField和普通文本行的区别" class="headerlink" title="JFormattedTextField和普通文本行的区别"></a>JFormattedTextField和普通文本行的区别</h2><p>使用<code>JFormattedTextField</code>与使用普通文本行有一个区别:</p>
<ul>
<li>它需要指定一个文本格式,<strong>只有当用户的输入满足该格式时,<code>JFormattedTextField</code>才会接收用户输入</strong>。</li>
</ul>
<h2 id="JFormattedTextField格式分类"><a href="#JFormattedTextField格式分类" class="headerlink" title="JFormattedTextField格式分类"></a>JFormattedTextField格式分类</h2><p><code>JFormattedTextField</code>可以使用如下两种类型的格式。</p>
<ul>
<li><code>JFormattedTextField.AbstractFormatter</code>:该内部类有一个子类<code>DefaultFormatter</code>,而<code>DefaultFormatter</code>又有一个非常实用的<code>MaskFormatter</code>子类,允许程序以掩码的形式指定文本格式</li>
<li><code>Format</code>:主要由<code>DateFormat</code>和<code>NumberFormat</code>两个格式器组成,这两个格式器可以指定<code>JFormattedTextField</code>所能接收的格式字符串。</li>
</ul>
<h2 id="JFormattedTextField方法"><a href="#JFormattedTextField方法" class="headerlink" title="JFormattedTextField方法"></a>JFormattedTextField方法</h2><p>创建<code>JFormattedTextField</code>对象时可以传入上面任意一个格式器:</p>
<table>
<thead>
<tr>
<th align="left">构造器</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>JFormattedTextField(Format format)</code></td>
<td align="left">Creates a JFormattedTextField.</td>
</tr>
</tbody></table>
<p>成功地创建了<code>JFormattedTextField</code>对象之后,<code>JFormattedTextField</code>对象的用法和普通<code>TextField</code>的用法基本相似,一样可以调用<code>setColumns()</code>来设置该文本框的宽度,调用<code>setFont()</code>来设置该文本框内的字体等。<br>除此之外,<code>JFormattedTextField</code>还包含如下三个特殊方法</p>
<table>
<thead>
<tr>
<th align="left"><code>JFormattedTextField</code>类的方法</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>Object getValue()</code></td>
<td align="left">获取该格式化文本框里的值</td>
</tr>
<tr>
<td align="left"><code>void setValue(Object value)</code></td>
<td align="left">设置该格式化文本框的初始值</td>
</tr>
<tr>
<td align="left"><code>void setFocusLostBehavior(int behavior)</code></td>
<td align="left">设置该格式化文本框失去焦点时的行为。</td>
</tr>
</tbody></table>
<h3 id="getValue方法"><a href="#getValue方法" class="headerlink" title="getValue方法"></a>getValue方法</h3><p>上面三个方法中获取格式化文本框内容的<code>getValue</code>方法返回<code>Object</code>类型,而不是返回<code>String</code>类型;</p>
<h3 id="setValue方法"><a href="#setValue方法" class="headerlink" title="setValue方法"></a>setValue方法</h3><p>与之对应的是,设置格式化文本框初始值的<code>setValue</code>方法需要传入<code>Object</code>类型参数,而不是<code>String</code>类型参数。<br>这都是因为格式化文本框会将文本框内容转换成指定格式对应的对象,而不再是普通字符串。</p>
<h3 id="setFocusLostBehavior方法"><a href="#setFocusLostBehavior方法" class="headerlink" title="setFocusLostBehavior方法"></a>setFocusLostBehavior方法</h3><p>setFocusLostBehavior方法可以接收如下4个值:</p>
<table>
<thead>
<tr>
<th align="left">setFocusLostBehavior方法参数值</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>JFormattedTextField.COMMIT</code></td>
<td align="left">如果用户输入的内容满足格式器的要求,则该格式化文本框显示的文本变成用户输入的内容,调用<code>getValue()</code>方法返回的是该文本框内显示的内容;如果用户输入的内容不满足格式器的要求,则该格式化文本框显示的依然是用户输入的内容,但调用<code>getValue()</code>方法返回的不是该文本框内显示的内容,而是上一个满足要求的值</td>
</tr>
<tr>
<td align="left"><code>JFormattedTextField.COMMIT_OR_REVERT</code></td>
<td align="left"><strong>这是默认值</strong>。如果用户输入的内容满足格式器的要求,则该格式化文本框显示的文本、<code>getValue()</code>方法返回的都是用户输入的内容;如果用户输入的内容不满足格式器的要求,则该格式化文本框显示的文本、<code>getValue()</code>方法返回的都是上一个满足要求的值。</td>
</tr>
<tr>
<td align="left"><code>JFormattedTextField.REVERT</code></td>
<td align="left">不管用户输入的内容是否满足格式器的要求,该格式化文本框都显示用户输入的内容,<code>getValue()</code>方法返回的都是上一个满足要求的值。</td>
</tr>
<tr>
<td align="left"><code>JFormattedTextField.PERSIST</code></td>
<td align="left">不管用户输入的内容是否满足格式器的要求,该格式化文本框显示的内容、<code>getValue()</code>方法返回的都是上一个满足要求的值。在这种情况下,不管用户输入什么内容对该文本框都没有任何影响。</td>
</tr>
</tbody></table>
<h2 id="DefaultFormatter"><a href="#DefaultFormatter" class="headerlink" title="DefaultFormatter"></a>DefaultFormatter</h2><p><code>DefaultFormatter</code>是一个功能非常强大的格式器,它可以格式化任何类的实例,只要该类包含带一个字符串参数的构造器,并提供对应的<code>toString()</code>方法(该方法的返回值就是传入给构造器字符串参数的值)即可<br>例如,<code>URL</code>类包含一个<code>URL(String spec)</code>构造器,且<code>URL</code>对象的<code>toString()</code>方法恰好返回刚刚传入的<code>spec</code>参数,因此可以使用<code>DefaultFormatter</code>来格式化<code>URL</code>对象。当格式化文本框失去焦点时,该格式器就会调用带一个字符串参数的构造器来创建新的对象,如果构造器抛出了异常,即表明用户输入无效。<br><code>DefaultFormatter</code>格式器默认采用改写方式来处理用户输入,即当用户在格式化文本框内输入时,每输入一个字符就会替换文本框内原来的一个字符。如釆想关闭这种改写方式,采用插入方式,则可通过调用它的<code>setOverwriteMode(false)</code>方法来实现。</p>
<h2 id="MaskFormatter"><a href="#MaskFormatter" class="headerlink" title="MaskFormatter"></a>MaskFormatter</h2><p><code>MaskFormatter</code>格式器的功能有点类似于正则表达式,它要求用户在格式化文本框内输入的内容必须匹配一定的掩码格式。例如,若要匹配广州地区的电话号码,则可采用020-########的格式,这个掩码字符串和正则表达式有一定的区别,因为该掩码字符串只支持如下通配符。</p>
<ul>
<li>#:代表任何有效数字</li>
<li>‘:转义字符,用于转义具有特殊格式的字符。例如,若想匹配#,则应该写成’#</li>
<li>U:任何字符,将所有小写字母映射为大写。</li>
<li>L:任何字符,将所有大写字母映射为小写。</li>
<li>A:任何字符或数字。</li>
<li>?:任何字符。</li>
<li>*:可以匹配任何内容。</li>
<li>H:任何十六进制字符(<code>0~9</code>、<code>a~f</code>或<code>A~F</code>)。</li>
</ul>
<p>值得指出的是,格式化文本框内的字符串总是和掩码具有相同的格式,连长度也完全相同。如果用户删除了格式化文本框内的字符,这些被删除的字符将由占位符替代。默认使用空格作为占位符,当然也可以调用<code>MaskFormatter</code>的<code>setPlaceholderCharacter()</code>方法来设置该格式器的占位符。例如如下代码:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">formatter.setPlaceholdercharacter(<span class="string">&#x27; &#x27;</span>);</span><br></pre></td></tr></table></figure>
<h2 id="程序"><a href="#程序" class="headerlink" title="程序"></a>程序</h2><p>下面程序示范了关于<code>JFormattedTextField</code>的简单用法。</p>
<p>上面程序添加了6个格式化文本框,其中两个是基于<code>NumberFormat</code>生成的整数格式器、货币格式器,两个是基于<code>DateFormat</code>生成的日期格式器,一个是使用<code>DefaultFormatter</code>创建的<code>URL</code>格式器,最后一个是使用<code>MaskFormatter</code>创建的掩码格式器,程序中的粗体字代码是创建这些格式器的关键代码。<br>除此之外,程序还添加了4个单选按钮,用于控制这些格式化文本框失去焦点后的行为。运行上面程序,并选中“<code>COMMIT</code>”行为,将看到如图12.59所示的界面<br>从图12.59中可以看出,虽然用户向格式化文本框内输入的内容与该文本框所要求的格式不符,但该文本框依然显示了用户输入的内容,只是后面显示该文本框的<code>getValue()</code>方法返回值时看到的依然是100,即上一个符合格式的值。<br>大部分时候,使用基于<code>Format</code>的格式器,<code>DefaultFormatter</code>和<code>MaskFormatter</code>已经能满足绝大部分要求;但对于一些特殊的要求,则可以采用扩展<code>DefaultFormatter</code>的方式来定义自己的格式器。定义自己的格式器通常需要重写<code>DefaultFormatter</code>的如下两个方法</p>
<table>
<thead>
<tr>
<th align="left">方法</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>Object stringToValue(String string)</code></td>
<td align="left">根据格式化文本框内的字符串来创建符合指定格式的对象。</td>
</tr>
<tr>
<td align="left"><code>String valueToString(Object value)</code></td>
<td align="left">将符合格式的对象转换成文本框中显示的字符串</td>
</tr>
</tbody></table>
<p>例如,若需要创建一个只能接收<code>IP</code>地址的格式化文本框,则可以创建一个自定义的格式化文本框,因为IP地址是由4个0~255之间的整数表示的,所以程序采用长度为4的<code>byte</code>数组来保存<code>IP</code>地址,程序可以采用如下方法将用户输入的字符串转换成<code>byte</code>数组。</p>
<h2 id="如何保证用户输入的有效性"><a href="#如何保证用户输入的有效性" class="headerlink" title="如何保证用户输入的有效性"></a>如何保证用户输入的有效性</h2><p>除此之外,<code>Swing</code>还提供了如下两种机制来保证用户输入的有效性</p>
<ul>
<li>输入过滤:输入过滤机制允许程序拦截用户的插入、替换、删除等操作,并改变用户所做的修改。</li>
<li>输入校验:输入验证机制允许用户离开输入组件时,验证机制自动触发——如果用户输入不符合要求,校验器强制用户重新输入。</li>
</ul>
<h3 id="输入过滤器"><a href="#输入过滤器" class="headerlink" title="输入过滤器"></a>输入过滤器</h3><p>输入过滤器需要继承<code>DocumentFilter</code>类,程序可以重写该类的如下三个方法来拦截用户的插入、删除和替换等操作。</p>
<table>
<thead>
<tr>
<th align="left">方法</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>void insertString(DocumentFilter.FilterBypass fb, int offset, String string, AttributeSet attr)</code></td>
<td align="left">该方法会拦截用户向文档中插入字符串的操作。</td>
</tr>
<tr>
<td align="left"><code>void remove(DocumentFilter.FilterBypass fb, int offset, int length)</code></td>
<td align="left">该方法会拦截用户从文档中删除字符串的操作。</td>
</tr>
<tr>
<td align="left"><code>void replace(DocumentFilter.FilterBypass fb, int offset, int length, String text, AttributeSet attrs)</code></td>
<td align="left">该方法会拦截用户替换文档中字符串的操作。</td>
</tr>
</tbody></table>
<h3 id="输入校验器"><a href="#输入校验器" class="headerlink" title="输入校验器"></a>输入校验器</h3><p>为了创建自己的输入校验器,可以通过扩展<code>InputVerifier</code>类来实现。实际上,<code>InputVerifier</code>输入校验器可以绑定到任何输入组件,<code>InputVerifier</code>类里包含了一个<code>verify(JComponent component)</code>方法,当用户在该输入组件内输入完成,且该组件失去焦点时,该方法被调用,如果该方法返回<code>false</code>,即表明用户输入无效,该输入组件将自动得到焦点。也就是说,<strong>如果某个输入组件绑定了<code>InputVerifier</code>,则用户必须为该组件输入有效内容,否则用户无法离开该组件</strong>。<br>有一种情况例外,如果输入焦点离开了带<code>InputVerifier</code>输入校验器的组件后,立即单击某个按钮,则该按钮的事件监听器将会在焦点重新回到原组件之前被触发。</p>
<h2 id="程序-为格式化文本框-添加输入过滤器-输入校验器"><a href="#程序-为格式化文本框-添加输入过滤器-输入校验器" class="headerlink" title="程序 为格式化文本框 添加输入过滤器 输入校验器"></a>程序 为格式化文本框 添加输入过滤器 输入校验器</h2><p>下面程序示范了如何为格式化文本框添加输入过滤器、输入校验器,程序还自定义了一个<code>IP</code>地址格式器,该<code>IP</code>地址格式器扩展了<code>DefaultFormatter</code>格式器。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"><span class="keyword">import</span> java.text.*;</span><br><span class="line"><span class="keyword">import</span> java.net.*;</span><br><span class="line"><span class="keyword">import</span> java.awt.*;</span><br><span class="line"><span class="keyword">import</span> javax.swing.*;</span><br><span class="line"><span class="keyword">import</span> javax.swing.border.*;</span><br><span class="line"><span class="keyword">import</span> javax.swing.text.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JFormattedTextFieldTest</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> JFrame mainWin = <span class="keyword">new</span> JFrame(<span class="string">&quot;测试格式化文本框&quot;</span>);</span><br><span class="line">    <span class="keyword">private</span> JButton okButton = <span class="keyword">new</span> JButton(<span class="string">&quot;确定&quot;</span>);</span><br><span class="line">    <span class="comment">// 定义用于添加格式化文本框的容器</span></span><br><span class="line">    <span class="keyword">private</span> JPanel mainPanel = <span class="keyword">new</span> JPanel();</span><br><span class="line">    JFormattedTextField[] fields = <span class="keyword">new</span> JFormattedTextField[<span class="number">6</span>];</span><br><span class="line">    String[] behaviorLabels = <span class="keyword">new</span> String[]</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="string">&quot;COMMIT&quot;</span>,</span><br><span class="line">        <span class="string">&quot;COMMIT_OR_REVERT&quot;</span>,</span><br><span class="line">        <span class="string">&quot;PERSIST&quot;</span>,</span><br><span class="line">        <span class="string">&quot;REVERT&quot;</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">int</span>[] behaviors = <span class="keyword">new</span> <span class="keyword">int</span>[]</span><br><span class="line">    &#123;</span><br><span class="line">        JFormattedTextField.COMMIT,</span><br><span class="line">        JFormattedTextField.COMMIT_OR_REVERT,</span><br><span class="line">        JFormattedTextField.PERSIST,</span><br><span class="line">        JFormattedTextField.REVERT</span><br><span class="line">    &#125;;</span><br><span class="line">    ButtonGroup bg = <span class="keyword">new</span> ButtonGroup();</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// 添加按钮</span></span><br><span class="line">        JPanel buttonPanel = <span class="keyword">new</span> JPanel();</span><br><span class="line">        buttonPanel.add(okButton);</span><br><span class="line">        mainPanel.setLayout(<span class="keyword">new</span> GridLayout(<span class="number">0</span>, <span class="number">3</span>));</span><br><span class="line">        mainWin.add(mainPanel, BorderLayout.CENTER);</span><br><span class="line">        <span class="comment">// 使用NumberFormat的integerInstance创建一个JFormattedTextField</span></span><br><span class="line">        fields[<span class="number">0</span>] = <span class="keyword">new</span> JFormattedTextField(NumberFormat</span><br><span class="line">            .getIntegerInstance());</span><br><span class="line">        <span class="comment">// 设置初始值</span></span><br><span class="line">        fields[<span class="number">0</span>].setValue(<span class="number">100</span>);</span><br><span class="line">        addRow(<span class="string">&quot;整数格式文本框 :&quot;</span>, fields[<span class="number">0</span>]);</span><br><span class="line">        <span class="comment">// 使用NumberFormat的currencyInstance创建一个JFormattedTextField</span></span><br><span class="line">        fields[<span class="number">1</span>] = <span class="keyword">new</span> JFormattedTextField(NumberFormat</span><br><span class="line">            .getCurrencyInstance());</span><br><span class="line">        fields[<span class="number">1</span>].setValue(<span class="number">100.0</span>);</span><br><span class="line">        addRow(<span class="string">&quot;货币格式文本框:&quot;</span>, fields[<span class="number">1</span>]);</span><br><span class="line">        <span class="comment">// 使用默认的日期格式创建一个JFormattedTextField对象</span></span><br><span class="line">        fields[<span class="number">2</span>] = <span class="keyword">new</span> JFormattedTextField(DateFormat.getDateInstance());</span><br><span class="line">        fields[<span class="number">2</span>].setValue(<span class="keyword">new</span> Date());</span><br><span class="line">        addRow(<span class="string">&quot;默认的日期格式器:&quot;</span>, fields[<span class="number">2</span>]);</span><br><span class="line">        <span class="comment">// 使用SHORT类型的日期格式创建一个JFormattedTextField对象，</span></span><br><span class="line">        <span class="comment">// 且要求采用严格日期格式</span></span><br><span class="line">        DateFormat format = DateFormat.getDateInstance(DateFormat.SHORT);</span><br><span class="line">        <span class="comment">// 要求采用严格的日期格式语法</span></span><br><span class="line">        format.setLenient(<span class="keyword">false</span>);</span><br><span class="line">        fields[<span class="number">3</span>] = <span class="keyword">new</span> JFormattedTextField(format);</span><br><span class="line">        fields[<span class="number">3</span>].setValue(<span class="keyword">new</span> Date());</span><br><span class="line">        addRow(<span class="string">&quot;SHORT类型的日期格式器（语法严格）:&quot;</span>, fields[<span class="number">3</span>]);</span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 创建默认的DefaultFormatter对象</span></span><br><span class="line">            DefaultFormatter formatter = <span class="keyword">new</span> DefaultFormatter();</span><br><span class="line">            <span class="comment">// 关闭overwrite状态</span></span><br><span class="line">            formatter.setOverwriteMode(<span class="keyword">false</span>);</span><br><span class="line">            fields[<span class="number">4</span>] = <span class="keyword">new</span> JFormattedTextField(formatter);</span><br><span class="line">            <span class="comment">// 使用DefaultFormatter来格式化URL</span></span><br><span class="line">            fields[<span class="number">4</span>].setValue(<span class="keyword">new</span> URL(<span class="string">&quot;http://www.crazyit.org&quot;</span>));</span><br><span class="line">            addRow(<span class="string">&quot;URL:&quot;</span>, fields[<span class="number">4</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span> (MalformedURLException e)</span><br><span class="line">        &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        &#123;</span><br><span class="line">            MaskFormatter formatter = <span class="keyword">new</span> MaskFormatter(<span class="string">&quot;020-########&quot;</span>);</span><br><span class="line">            <span class="comment">// 设置占位符</span></span><br><span class="line">            formatter.setPlaceholderCharacter(<span class="string">&#x27;□&#x27;</span>);</span><br><span class="line">            fields[<span class="number">5</span>] = <span class="keyword">new</span> JFormattedTextField(formatter);</span><br><span class="line">            <span class="comment">// 设置初始值</span></span><br><span class="line">            fields[<span class="number">5</span>].setValue(<span class="string">&quot;020-28309378&quot;</span>);</span><br><span class="line">            addRow(<span class="string">&quot;电话号码：&quot;</span>, fields[<span class="number">5</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span> (ParseException ex)</span><br><span class="line">        &#123;</span><br><span class="line">            ex.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        JPanel focusLostPanel = <span class="keyword">new</span> JPanel();</span><br><span class="line">        <span class="comment">// 采用循环方式加入失去焦点行为的单选按钮</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; behaviorLabels.length ; i++ )</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">final</span> <span class="keyword">int</span> index = i;</span><br><span class="line">            <span class="keyword">final</span> JRadioButton radio = <span class="keyword">new</span> JRadioButton(behaviorLabels[i]);</span><br><span class="line">            <span class="comment">// 默认选中第二个单选按钮</span></span><br><span class="line">            <span class="keyword">if</span> (i == <span class="number">1</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                radio.setSelected(<span class="keyword">true</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            focusLostPanel.add(radio);</span><br><span class="line">            bg.add(radio);</span><br><span class="line">            <span class="comment">// 为所有单选按钮添加事件监听器</span></span><br><span class="line">            radio.addActionListener(e -&gt; &#123;</span><br><span class="line">                <span class="comment">// 如果当前该单选按钮处于选中状态，</span></span><br><span class="line">                <span class="keyword">if</span> (radio.isSelected())</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="comment">// 设置所有的格式化文本框的失去焦点的行为</span></span><br><span class="line">                    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span> ; j &lt; fields.length ; j++)</span><br><span class="line">                    &#123;</span><br><span class="line">                        fields[j].setFocusLostBehavior(behaviors[index]);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">        focusLostPanel.setBorder(<span class="keyword">new</span> TitledBorder(<span class="keyword">new</span> EtchedBorder(),</span><br><span class="line">            <span class="string">&quot;请选择焦点失去后的行为&quot;</span>));</span><br><span class="line">        JPanel p = <span class="keyword">new</span> JPanel();</span><br><span class="line">        p.setLayout(<span class="keyword">new</span> BorderLayout());</span><br><span class="line">        p.add(focusLostPanel , BorderLayout.NORTH);</span><br><span class="line">        p.add(buttonPanel , BorderLayout.SOUTH);</span><br><span class="line"></span><br><span class="line">        mainWin.add(p , BorderLayout.SOUTH);</span><br><span class="line">        mainWin.pack();</span><br><span class="line">        mainWin.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);</span><br><span class="line">        mainWin.setVisible(<span class="keyword">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 定义添加一行格式化文本框的方法</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">addRow</span><span class="params">(String labelText, <span class="keyword">final</span> JFormattedTextField field)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        mainPanel.add(<span class="keyword">new</span> JLabel(labelText));</span><br><span class="line">        mainPanel.add(field);</span><br><span class="line">        <span class="keyword">final</span> JLabel valueLabel = <span class="keyword">new</span> JLabel();</span><br><span class="line">        mainPanel.add(valueLabel);</span><br><span class="line">        <span class="comment">// 为&quot;确定&quot;按钮添加事件监听器</span></span><br><span class="line">        <span class="comment">// 当用户单击“确定”按钮时，文本框后</span></span><br><span class="line">        okButton.addActionListener(event -&gt; &#123;</span><br><span class="line">            Object value = field.getValue();</span><br><span class="line">            <span class="comment">// 输出格式化文本框的值</span></span><br><span class="line">            valueLabel.setText(value.toString());</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">new</span> JFormattedTextFieldTest().init();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行上面程序,会看到窗口中出现三个格式化文本框,其中第一个格式化文本框只能输入数字,其他字符无法输入到该文本框内;第二个格式化文本框有输入校验器,只有当用户输入的内容符合该文本框的要求时,用户才可以离开该文本框;第三个格式化文本框的格式器是自定义的格式器,它要求用户输入的内容是一个合法的IP地址。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://lanlan2017.github.io/JavaReadingNotes/59de7684/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/JavaReadingNotes/images/avatar.gif">
      <meta itemprop="name" content="蓝蓝">
      <meta itemprop="description" content="好好学习，天天向上">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="蓝蓝站点">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/JavaReadingNotes/59de7684/" class="post-title-link" itemprop="url">12.12.2 使用JPasswordField</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-02-26 09:38:12" itemprop="dateCreated datePublished" datetime="2020-02-26T09:38:12+08:00">2020-02-26</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2020-03-28 04:52:57" itemprop="dateModified" datetime="2020-03-28T04:52:57+08:00">2020-03-28</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JavaReadingNotes/categories/1-%E7%96%AF%E7%8B%82Java%E8%AE%B2%E4%B9%89-%E7%AC%AC4%E7%89%88/" itemprop="url" rel="index"><span itemprop="name">1 疯狂Java讲义 (第4版)</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JavaReadingNotes/categories/1-%E7%96%AF%E7%8B%82Java%E8%AE%B2%E4%B9%89-%E7%AC%AC4%E7%89%88/%E7%AC%AC12%E7%AB%A0-Swing%E7%BC%96%E7%A8%8B/" itemprop="url" rel="index"><span itemprop="name">第12章 Swing编程</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JavaReadingNotes/categories/1-%E7%96%AF%E7%8B%82Java%E8%AE%B2%E4%B9%89-%E7%AC%AC4%E7%89%88/%E7%AC%AC12%E7%AB%A0-Swing%E7%BC%96%E7%A8%8B/12-12-%E5%88%9B%E5%BB%BA%E6%A0%BC%E5%BC%8F%E6%96%87%E6%9C%AC/" itemprop="url" rel="index"><span itemprop="name">12.12 创建格式文本</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
    <span class="post-meta-item-icon">
      <i class="far fa-comment"></i>
    </span>
    <span class="post-meta-item-text">Waline：</span>
  
    <a title="waline" href="/JavaReadingNotes/59de7684/#waline-comments" itemprop="discussionUrl">
      <span class="post-comments-count waline-comment-count" id="/JavaReadingNotes/59de7684/" data-xid="/JavaReadingNotes/59de7684/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>815</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>1 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="12-12-2-使用JPasswordField"><a href="#12-12-2-使用JPasswordField" class="headerlink" title="12.12.2 使用JPasswordField"></a>12.12.2 使用JPasswordField</h1><p><code>JPasswordField</code>是<code>JTextField</code>的一个子类,它是<code>Swing</code>的<code>MVC</code>设计的产品:<code>JPasswordField</code>和<code>JTextField</code>的各种特征几乎完全一样,只是<strong>当用户向<code>JPasswordField</code>输入内容时,<code>JPasswordField</code>并不会显示出用户输入的内容,而是以<code>echo</code>字符(通常是星号和黑点)来代替用户输入的所有字符</strong>。<br><code>JPasswordField</code>和<code>JTextField</code>的用法几乎完全一样,连构造器的个数和参数都完全一样。但是<code>JPasswordField</code>多了一个<code>setEchoChar(Char ch)</code>方法,该方法用于设置该密码框的<code>echo</code>字符——当用户在密码输入框内输入时,每个字符都会使用该<code>echo</code>字符代替。<br>除此之外,<code>JPasswordField</code>重写了<code>JTextComponent</code>的<code>getText()</code>方法,并且不再推荐使用<code>getText</code>方法返回字符串密码框的字符串,因为<code>getText</code>方法所返回的字符串会一直停留在虚拟机中,直到垃圾回收,这可能导致存在一些安全隐患,所以**<code>JPasswordField</code>提供了一个<code>getPassword()</code>方法,该方法返回个字符数组,而不是返回字符串**,从而提供了更好的安全机制.<br><strong>当程序使用完<code>getPassword()</code>方法返回的字符数组后,应该立即清空该字符数组的内容,以防该数组泄露密码信息</strong>.</p>
<table>
<thead>
<tr>
<th align="left"><code>JPasswordField</code>类的方法</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>void setEchoChar(char c)</code></td>
<td align="left">Sets the echo character for this JPasswordField.</td>
</tr>
<tr>
<td align="left"><code>char[] getPassword()</code></td>
<td align="left">Returns the text contained in this TextComponent.</td>
</tr>
<tr>
<td align="left"><code>String getText()</code></td>
<td align="left"><strong>Deprecated</strong>. As of Java 2 platform v1.2, replaced by getPassword.</td>
</tr>
</tbody></table>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://lanlan2017.github.io/JavaReadingNotes/f36b64c4/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/JavaReadingNotes/images/avatar.gif">
      <meta itemprop="name" content="蓝蓝">
      <meta itemprop="description" content="好好学习，天天向上">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="蓝蓝站点">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/JavaReadingNotes/f36b64c4/" class="post-title-link" itemprop="url">12.12 使用FormattedTextField和JTextPanel创建格式文本 12.11 使用JTable和TableModel创建表格</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-02-26 06:06:26" itemprop="dateCreated datePublished" datetime="2020-02-26T06:06:26+08:00">2020-02-26</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2020-03-28 04:46:02" itemprop="dateModified" datetime="2020-03-28T04:46:02+08:00">2020-03-28</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JavaReadingNotes/categories/1-%E7%96%AF%E7%8B%82Java%E8%AE%B2%E4%B9%89-%E7%AC%AC4%E7%89%88/" itemprop="url" rel="index"><span itemprop="name">1 疯狂Java讲义 (第4版)</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JavaReadingNotes/categories/1-%E7%96%AF%E7%8B%82Java%E8%AE%B2%E4%B9%89-%E7%AC%AC4%E7%89%88/%E7%AC%AC12%E7%AB%A0-Swing%E7%BC%96%E7%A8%8B/" itemprop="url" rel="index"><span itemprop="name">第12章 Swing编程</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JavaReadingNotes/categories/1-%E7%96%AF%E7%8B%82Java%E8%AE%B2%E4%B9%89-%E7%AC%AC4%E7%89%88/%E7%AC%AC12%E7%AB%A0-Swing%E7%BC%96%E7%A8%8B/12-12-%E5%88%9B%E5%BB%BA%E6%A0%BC%E5%BC%8F%E6%96%87%E6%9C%AC/" itemprop="url" rel="index"><span itemprop="name">12.12 创建格式文本</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
    <span class="post-meta-item-icon">
      <i class="far fa-comment"></i>
    </span>
    <span class="post-meta-item-text">Waline：</span>
  
    <a title="waline" href="/JavaReadingNotes/f36b64c4/#waline-comments" itemprop="discussionUrl">
      <span class="post-comments-count waline-comment-count" id="/JavaReadingNotes/f36b64c4/" data-xid="/JavaReadingNotes/f36b64c4/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>5.4k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>5 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="12-12-使用FormattedTextField和JTextPanel创建格式文本"><a href="#12-12-使用FormattedTextField和JTextPanel创建格式文本" class="headerlink" title="12.12 使用FormattedTextField和JTextPanel创建格式文本"></a>12.12 使用FormattedTextField和JTextPanel创建格式文本</h1><p><img data-src="https://raw.githubusercontent.com/lanlan2017/images/master/CrazyJavaHandout4/Chapter12/12.2.1/1.png" alt="这里有一张图片"><br><strong><code>Swing</code>使用<code>JtextComponent</code>作为所有文本输入组件的父类</strong>,从图12.1中可以看出:<br><code>Swing</code>为<code>JtextComponent</code>类提供了三个子类:<code>JTextArea</code>、<code>JTextField</code>和<code>JEditorPane</code>.</p>
<h2 id="JEditorPane"><a href="#JEditorPane" class="headerlink" title="JEditorPane"></a>JEditorPane</h2><p>为<code>JEditorPane</code>提供了一个<code>JTextPane</code>子类,<strong><code>JEditorPane</code>和<code>JTextPane</code>是两个典型的格式文本编辑器</strong>,也是本节介绍的重点。<br><code>JTextArea</code>和<code>JTextField</code>是两个常见的文本组件,比较简单,本节不会再次介绍它们。</p>
<h2 id="JTextField"><a href="#JTextField" class="headerlink" title="JTextField"></a>JTextField</h2><p><code>JTextField</code>派生了两个子类:<code>JPasswordField</code>和<code>JFormattedTextField</code>,它们代表<strong>密码输入框</strong>和<strong>格式化文本输入框</strong>。</p>
<h2 id="文本输入组件的model是Document接口"><a href="#文本输入组件的model是Document接口" class="headerlink" title="文本输入组件的model是Document接口"></a>文本输入组件的model是Document接口</h2><p>与其他的<code>Swing</code>组件类似,所有的文本输入组件也遵循了<code>MVC</code>的设计模式,即<strong>每个文本输入组件都有对应的<code>model</code>来保存其状态数据</strong>;<br>与其他的<code>Swing</code>组件不同的是,文本输入组件的<code>model</code>接口不是<code>XxxModel</code>接口,而是<code>Document</code>接口。<br><code>Document</code>既包括有格式的文本,也包括无格式的文本。不同的文本输入组件对应的<code>Document</code>不同。</p>
<h1 id="12-12-1-监听Document的变化"><a href="#12-12-1-监听Document的变化" class="headerlink" title="12.12.1 监听Document的变化"></a>12.12.1 监听Document的变化</h1><p>如果希望检测到任何文本输入组件里所输入内容的变化,则可以通过监听该组件对应的<code>Document</code>来实现。</p>
<h2 id="如何获取文本输入组件的Document对象"><a href="#如何获取文本输入组件的Document对象" class="headerlink" title="如何获取文本输入组件的Document对象"></a>如何获取文本输入组件的Document对象</h2><p><code>JTextComponent</code>类里提供了一个<code>getDocument()</code>方法,该方法用于获取所有文本输入组件对应的<code>Document</code>对象。</p>
<table>
<thead>
<tr>
<th align="left"><code>JTextComponent</code>类的方法</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>Document getDocument()</code></td>
<td align="left">Fetches the model associated with the editor.</td>
</tr>
</tbody></table>
<h2 id="为Document添加监听器"><a href="#为Document添加监听器" class="headerlink" title="为Document添加监听器"></a>为Document添加监听器</h2><p><code>Document</code>提供了一个<code>addDocumentListener()</code>方法来为<code>Document</code>添加监听器,该监听器必须实现<code>DocumentListener</code>接口.</p>
<table>
<thead>
<tr>
<th align="left"><code>Document</code>接口的方法</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>void addDocumentListener(DocumentListener listener)</code></td>
<td align="left">Registers the given observer to begin receiving notifications when changes are made to the document.</td>
</tr>
</tbody></table>
<h3 id="DocumentListener接口方法"><a href="#DocumentListener接口方法" class="headerlink" title="DocumentListener接口方法"></a>DocumentListener接口方法</h3><p><code>DocumentListener</code>接口里提供了如下三个方法。</p>
<table>
<thead>
<tr>
<th align="left">方法</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>void changedUpdate(DocumentEvent e)</code></td>
<td align="left">当<code>Document</code>里的属性或属性集发生了变化时触发该方法。</td>
</tr>
<tr>
<td align="left"><code>void insertUpdate(DocumentEvent e)</code></td>
<td align="left">当向<code>Document</code>中插入文本时触发该方法。</td>
</tr>
<tr>
<td align="left"><code>void removeUpdate(DocumentEvent e)</code></td>
<td align="left">当从<code>Document</code>中删除文本时触发该方法。</td>
</tr>
</tbody></table>
<p>对于上面的三个方法而言,如果仅需要检测文本的变化,则无须实现第一个方法。但<code>Swing</code>并没有为<code>DocumentListener</code>接口提供适配器,所以程序依然要为第一个方法提供空实现。</p>
<h2 id="撤销监听器"><a href="#撤销监听器" class="headerlink" title="撤销监听器"></a>撤销监听器</h2><p>除此之外,还可以为文件输入组件添加一个撤销监听器,这样就<strong>允许用户撤销以前的修改</strong>。添加撤销监听器的方法是<code>addUndoableEditListener</code>:</p>
<table>
<thead>
<tr>
<th align="left"><code>Document</code>接口的方法</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>void addUndoableEditListener(UndoableEditListener listener)</code></td>
<td align="left">Registers the given observer to begin receiving notifications when undoable edits are made to the document.</td>
</tr>
</tbody></table>
<h3 id="UndoableEditListener"><a href="#UndoableEditListener" class="headerlink" title="UndoableEditListener"></a>UndoableEditListener</h3><p>该方法需要接收一个<code>UndoableEditListener</code>监听器,该监听器里包含了<code>undoableEditHappened()</code>方法:</p>
<table>
<thead>
<tr>
<th align="left"><code>UndoableEditListener</code>接口的方法</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>void undoableEditHappened(UndoableEditEvent e)</code></td>
<td align="left">当文档里发生了可撤销的编辑操作时将会触发该方法</td>
</tr>
</tbody></table>
<h2 id="程序-为文本域的Document添加监听器"><a href="#程序-为文本域的Document添加监听器" class="headerlink" title="程序 为文本域的Document添加监听器"></a>程序 为文本域的Document添加监听器</h2><p>下面程序示范了如何为一个普通文本域的<code>Document</code>添加监听器,当用户在目标文本域里输入、删除文本时,程序会显示出用户所做的修改。该文本域还支持撤销操作,当用户按“<code>Ctrl+Z</code>”键时,该文本域会撤销用户刚刚输入的内容。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.LinkedList;</span><br><span class="line"><span class="keyword">import</span> java.awt.event.*;</span><br><span class="line"><span class="keyword">import</span> javax.swing.*;</span><br><span class="line"><span class="keyword">import</span> javax.swing.text.*;</span><br><span class="line"><span class="keyword">import</span> javax.swing.undo.*;</span><br><span class="line"><span class="keyword">import</span> javax.swing.event.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MonitorText</span> </span>&#123;</span><br><span class="line">    JFrame mainWin = <span class="keyword">new</span> JFrame(<span class="string">&quot;监听Document对象&quot;</span>);</span><br><span class="line">    JTextArea target = <span class="keyword">new</span> JTextArea(<span class="number">4</span>, <span class="number">35</span>);</span><br><span class="line">    JTextArea msg = <span class="keyword">new</span> JTextArea(<span class="number">5</span>, <span class="number">35</span>);</span><br><span class="line">    JLabel label = <span class="keyword">new</span> JLabel(<span class="string">&quot;文本域的修改信息&quot;</span>);</span><br><span class="line">    Document doc = target.getDocument();</span><br><span class="line">    <span class="comment">// 保存撤销操作的List对象</span></span><br><span class="line">    LinkedList&lt;UndoableEdit&gt; undoList = <span class="keyword">new</span> LinkedList&lt;&gt;();</span><br><span class="line">    <span class="comment">// 最多允许撤销多少次</span></span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">int</span> UNDO_COUNT = <span class="number">20</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        msg.setEditable(<span class="keyword">false</span>);</span><br><span class="line">        <span class="comment">// 添加DocumentListener</span></span><br><span class="line">        doc.addDocumentListener(<span class="keyword">new</span> DocumentListener() &#123;</span><br><span class="line">            <span class="comment">// 当Document的属性或属性集发生了改变时触发该方法</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">changedUpdate</span><span class="params">(DocumentEvent e)</span> </span>&#123;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 当向Document中插入文本时触发该方法</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">insertUpdate</span><span class="params">(DocumentEvent e)</span> </span>&#123;</span><br><span class="line">                <span class="keyword">int</span> offset = e.getOffset();</span><br><span class="line">                <span class="keyword">int</span> len = e.getLength();</span><br><span class="line">                <span class="comment">// 取得插入事件的位置</span></span><br><span class="line">                msg.append(<span class="string">&quot;插入文本的长度：&quot;</span> + len + <span class="string">&quot;\n&quot;</span>);</span><br><span class="line">                msg.append(<span class="string">&quot;插入文本的起始位置：&quot;</span> + offset + <span class="string">&quot;\n&quot;</span>);</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    msg.append(<span class="string">&quot;插入文本内容：&quot;</span> + doc.getText(offset, len) + <span class="string">&quot;\n&quot;</span>);</span><br><span class="line">                &#125; <span class="keyword">catch</span> (BadLocationException evt) &#123;</span><br><span class="line">                    evt.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 当从Document中删除文本时触发该方法</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">removeUpdate</span><span class="params">(DocumentEvent e)</span> </span>&#123;</span><br><span class="line">                <span class="keyword">int</span> offset = e.getOffset();</span><br><span class="line">                <span class="keyword">int</span> len = e.getLength();</span><br><span class="line">                <span class="comment">// 取得插入事件的位置</span></span><br><span class="line">                msg.append(<span class="string">&quot;删除文本的长度：&quot;</span> + len + <span class="string">&quot;\n&quot;</span>);</span><br><span class="line">                msg.append(<span class="string">&quot;删除文本的起始位置：&quot;</span> + offset + <span class="string">&quot;\n&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="comment">// 添加可撤销操作的监听器</span></span><br><span class="line">        doc.addUndoableEditListener(e -&gt; &#123;</span><br><span class="line">            <span class="comment">// 每次发生可撤销操作都会触发该代码块 // ①</span></span><br><span class="line">            UndoableEdit edit = e.getEdit();</span><br><span class="line">            <span class="keyword">if</span> (edit.canUndo() &amp;&amp; undoList.size() &lt; UNDO_COUNT) &#123;</span><br><span class="line">                <span class="comment">// 将撤销操作装入List内</span></span><br><span class="line">                undoList.add(edit);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 已经达到了最大撤销次数</span></span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (edit.canUndo() &amp;&amp; undoList.size() &gt;= UNDO_COUNT) &#123;</span><br><span class="line">                <span class="comment">// 弹出第一个撤销操作</span></span><br><span class="line">                undoList.pop();</span><br><span class="line">                <span class="comment">// 将撤销操作装入List内</span></span><br><span class="line">                undoList.add(edit);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="comment">// 为Ctrl+Z添加监听器</span></span><br><span class="line">        target.addKeyListener(<span class="keyword">new</span> KeyAdapter() &#123;</span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">keyTyped</span><span class="params">(KeyEvent e)</span> <span class="comment">// ②</span></span></span><br><span class="line"><span class="function">            </span>&#123;</span><br><span class="line">                System.out.println(e.getKeyChar() + <span class="number">0</span>);</span><br><span class="line">                <span class="comment">// 如果按键是Ctrl + Z或Ctrl + z</span></span><br><span class="line">                <span class="keyword">if</span> (e.getKeyChar() == <span class="number">26</span>) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (undoList.size() &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                        <span class="comment">// 移出最后一个可撤销操作，并取消该操作</span></span><br><span class="line">                        undoList.removeLast().undo();</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        Box box = <span class="keyword">new</span> Box(BoxLayout.Y_AXIS);</span><br><span class="line">        box.add(<span class="keyword">new</span> JScrollPane(target));</span><br><span class="line">        JPanel panel = <span class="keyword">new</span> JPanel();</span><br><span class="line">        panel.add(label);</span><br><span class="line">        box.add(panel);</span><br><span class="line">        box.add(<span class="keyword">new</span> JScrollPane(msg));</span><br><span class="line">        mainWin.add(box);</span><br><span class="line">        mainWin.pack();</span><br><span class="line">        mainWin.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);</span><br><span class="line">        mainWin.setVisible(<span class="keyword">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="keyword">new</span> MonitorText().init();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="代码分析"><a href="#代码分析" class="headerlink" title="代码分析"></a>代码分析</h3><p>上面程序中的两段粗体字代码实现了<code>Document</code>中插入文本、删除文本的事件处理器,当用户向<code>Document</code>中插入文本、删除文本时,程序将会把这些修改信息添加到下面的一个文本域里</p>
<h4 id="添加可撤销操作监听器"><a href="#添加可撤销操作监听器" class="headerlink" title="添加可撤销操作监听器"></a>添加可撤销操作监听器</h4><p>程序中①号代码:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 添加可撤销操作的监听器</span></span><br><span class="line">doc.addUndoableEditListener(e -&gt; &#123;</span><br><span class="line">    <span class="comment">// 每次发生可撤销操作都会触发该代码块 // ①</span></span><br><span class="line">    UndoableEdit edit = e.getEdit();</span><br><span class="line">    <span class="keyword">if</span> (edit.canUndo() &amp;&amp; undoList.size() &lt; UNDO_COUNT) &#123;</span><br><span class="line">        <span class="comment">// 将撤销操作装入List内</span></span><br><span class="line">        undoList.add(edit);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 已经达到了最大撤销次数</span></span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (edit.canUndo() &amp;&amp; undoList.size() &gt;= UNDO_COUNT) &#123;</span><br><span class="line">        <span class="comment">// 弹出第一个撤销操作</span></span><br><span class="line">        undoList.pop();</span><br><span class="line">        <span class="comment">// 将撤销操作装入List内</span></span><br><span class="line">        undoList.add(edit);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>是可撤销操作的事件处理器,当用户在该文本域内进行可撤销操作时,这段代码将会被触发,这段代码把用户刚刚进行的可撤销操作以<code>List</code>保存起来,以便在合适的时候撤销用户所做的修改。</p>
<h4 id="添加Ctrl-Z监听器"><a href="#添加Ctrl-Z监听器" class="headerlink" title="添加Ctrl+Z监听器"></a>添加Ctrl+Z监听器</h4><p>程序中②号代码:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 为Ctrl+Z添加监听器</span></span><br><span class="line">target.addKeyListener(<span class="keyword">new</span> KeyAdapter() &#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">keyTyped</span><span class="params">(KeyEvent e)</span> <span class="comment">// ②</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        System.out.println(e.getKeyChar() + <span class="number">0</span>);</span><br><span class="line">        <span class="comment">// 如果按键是Ctrl + Z或Ctrl + z</span></span><br><span class="line">        <span class="keyword">if</span> (e.getKeyChar() == <span class="number">26</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (undoList.size() &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="comment">// 移出最后一个可撤销操作，并取消该操作</span></span><br><span class="line">                undoList.removeLast().undo();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>主要用于为“<code>Ctrl+Z</code>”按键添加按键监听器,当用户按下“<code>Ctrl+Z</code>”键时,程序从保存可撤销操作的<code>List</code>中取岀最后一个可撤销操作,并撤销该操作的修改。<br>运行上面程序,会看到如图12.58所示的运行结果。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://lanlan2017.github.io/JavaReadingNotes/58080c96/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/JavaReadingNotes/images/avatar.gif">
      <meta itemprop="name" content="蓝蓝">
      <meta itemprop="description" content="好好学习，天天向上">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="蓝蓝站点">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/JavaReadingNotes/58080c96/" class="post-title-link" itemprop="url">12.11.6 编辑单元格內容</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-02-26 05:46:39" itemprop="dateCreated datePublished" datetime="2020-02-26T05:46:39+08:00">2020-02-26</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2020-03-03 04:57:54" itemprop="dateModified" datetime="2020-03-03T04:57:54+08:00">2020-03-03</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JavaReadingNotes/categories/1-%E7%96%AF%E7%8B%82Java%E8%AE%B2%E4%B9%89-%E7%AC%AC4%E7%89%88/" itemprop="url" rel="index"><span itemprop="name">1 疯狂Java讲义 (第4版)</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JavaReadingNotes/categories/1-%E7%96%AF%E7%8B%82Java%E8%AE%B2%E4%B9%89-%E7%AC%AC4%E7%89%88/%E7%AC%AC12%E7%AB%A0-Swing%E7%BC%96%E7%A8%8B/" itemprop="url" rel="index"><span itemprop="name">第12章 Swing编程</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JavaReadingNotes/categories/1-%E7%96%AF%E7%8B%82Java%E8%AE%B2%E4%B9%89-%E7%AC%AC4%E7%89%88/%E7%AC%AC12%E7%AB%A0-Swing%E7%BC%96%E7%A8%8B/12-11-%E4%BD%BF%E7%94%A8JTable%E5%92%8CTableModel%E5%88%9B%E5%BB%BA%E8%A1%A8%E6%A0%BC/" itemprop="url" rel="index"><span itemprop="name">12.11 使用JTable和TableModel创建表格</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
    <span class="post-meta-item-icon">
      <i class="far fa-comment"></i>
    </span>
    <span class="post-meta-item-text">Waline：</span>
  
    <a title="waline" href="/JavaReadingNotes/58080c96/#waline-comments" itemprop="discussionUrl">
      <span class="post-comments-count waline-comment-count" id="/JavaReadingNotes/58080c96/" data-xid="/JavaReadingNotes/58080c96/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>7k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>6 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="12-11-6-编辑单元格內容"><a href="#12-11-6-编辑单元格內容" class="headerlink" title="12.11.6 编辑单元格內容"></a>12.11.6 编辑单元格內容</h1><p>如果用户双击<code>JTable</code>表格的指定单元格,系统将会开始编辑该单元格的内容。在默认情况下,系统会使用文本框来编辑该单元格的内容,包括如图12.54所示表格的图标单元格。<br><img data-src="https://raw.githubusercontent.com/lanlan2017/images/master/CrazyJavaHandout4/Chapter12/12.11.5/1.png"><br>与此类似的是,如果用户双击<code>JTree</code>的节点,默认也会采用文本框来编辑节点的内容。<br>但如果单元格内容不是文字内容,而是如图12.54所示的图形类型时,用户当然不希望使用文本编辑器来编辑该单元格的内容,因为这种编辑方式非常不直观,用户体验相当差。为了避免这种情况,可以实现自己的单元格编辑器,从而可以给用户提供更好的操作界面。<br>实现<code>JTable</code>的单元格编辑器应该实现<code>TableCellEditor</code>接口,实现<code>JTree</code>的节点编辑器需要实现<code>TreeCelleditor</code>接口,<code>TableCellEditor</code>和<code>TreeCelleditor</code>这两个接口有非常紧密的联系。它们有一个共同的父接口:<code>CellEditor</code>;而且它们有一个共同的实现类:<code>DefaultCellEditor</code>。</p>
<p>关于<code>TableCellEditor</code>和<code>TreeCellEditor</code>两个接口及其实现类之间的关系如图12.55所示。</p>
<p>从图12.55中可以看出,<code>Swing</code>为<code>TableCellEditor</code>提供了<code>DefaultCellEditor</code>实现类(也可作为<code>TreeCellEditor</code>的实现类),<code>DefaultCellEditor</code>类有三个构造器,它们分别使用文本框、复选框和<code>ComboBox</code>作为单元格编辑器,其中</p>
<ul>
<li>使用文本框编辑器是最常见的情形,</li>
<li>如果单元格的值是<code>Boolean</code>类型,则系统默认使用复选框编辑器(如图12.54中最右边一列所示),这两种情形都是前面见过的情形。</li>
<li>如果想指定某列使用<code>JComboBox</code>作为单元格编</li>
</ul>
<p>实现<code>TableCellEditor</code>接口可以开发自己的单元格编辑器,但这种做法比较烦琐:通常会使用扩展<code>DefaultCellEditor</code>类的方式,这种方式比较简单。</p>
<p><code>TableCellEditor</code>接口定义了一个<code>getTableCellEditorComponent</code>方法,该方法返回一个<code>Component</code>对象,该对象就是该单元格的编辑器。</p>
<h2 id="安装单元格编辑器的两种方式"><a href="#安装单元格编辑器的两种方式" class="headerlink" title="安装单元格编辑器的两种方式"></a>安装单元格编辑器的两种方式</h2><p>一旦实现了自己的单元格编辑器,就可以为<code>JTable</code>对象安装该单元格编辑器,与安装单元格绘制器类似,安装单元格编辑器也有两种方式</p>
<ul>
<li>局部方式(列级):为特定列指定单元格编辑器,通过调用<code>TableColumn</code>的<code>setCellEditor()</code>方法为该列安装单元格编辑器</li>
<li>全局方式(表级):调用<code>JTable</code>的<code>setDefaultEditor()</code>方法为该表格安装默认的单元格编辑器。该方法需要两个参数,即列类型和单元格编辑器,这两个参数表明对于指定类型的数据列使用该单元格编辑器。</li>
</ul>
<h2 id="局部覆盖全局"><a href="#局部覆盖全局" class="headerlink" title="局部覆盖全局"></a>局部覆盖全局</h2><p>与单元格绘制器相似的是,如果有一列同时满足列级单元格编辑器和表级单元格编辑器的要求,系统将采用列级单元格编辑器。</p>
<h2 id="程序"><a href="#程序" class="headerlink" title="程序"></a>程序</h2><p>下面程序实现了一个<code>ImageCellEditor</code>编辑器,该编辑器由一个不可直接编辑的文本框和一个按钮组成,当用户单击该按钮时,该编辑器弹出一个文件选择器,方便用户选择图标文件。除此之外,下面程序还创建了一个基于<code>JComboBox</code>的<code>DefaultcellEditor</code>类,该编辑器允许用户通过下拉列表来选择图标。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.awt.*;</span><br><span class="line"><span class="keyword">import</span> javax.swing.*;</span><br><span class="line"><span class="keyword">import</span> javax.swing.table.*;</span><br><span class="line"><span class="keyword">import</span> javax.swing.filechooser.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TableCellEditorTest</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    JFrame jf = <span class="keyword">new</span> JFrame(<span class="string">&quot;使用单元格编辑器&quot;</span>);</span><br><span class="line">    JTable table;</span><br><span class="line">    <span class="comment">// 定义二维数组作为表格数据</span></span><br><span class="line">    Object[][] tableData =</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">new</span> Object[]&#123;<span class="string">&quot;李清照&quot;</span> , <span class="number">29</span> , <span class="string">&quot;女&quot;</span> , <span class="keyword">new</span> ImageIcon(<span class="string">&quot;icon/3.gif&quot;</span>)</span><br><span class="line">            , <span class="keyword">new</span> ImageIcon(<span class="string">&quot;icon/3.gif&quot;</span>) , <span class="keyword">true</span>&#125;,</span><br><span class="line">        <span class="keyword">new</span> Object[]&#123;<span class="string">&quot;苏格拉底&quot;</span>, <span class="number">56</span> , <span class="string">&quot;男&quot;</span> , <span class="keyword">new</span> ImageIcon(<span class="string">&quot;icon/1.gif&quot;</span>)</span><br><span class="line">            , <span class="keyword">new</span> ImageIcon(<span class="string">&quot;icon/1.gif&quot;</span>) , <span class="keyword">false</span>&#125;,</span><br><span class="line">        <span class="keyword">new</span> Object[]&#123;<span class="string">&quot;李白&quot;</span>, <span class="number">35</span> , <span class="string">&quot;男&quot;</span> , <span class="keyword">new</span> ImageIcon(<span class="string">&quot;icon/4.gif&quot;</span>)</span><br><span class="line">            , <span class="keyword">new</span> ImageIcon(<span class="string">&quot;icon/4.gif&quot;</span>) , <span class="keyword">true</span>&#125;,</span><br><span class="line">        <span class="keyword">new</span> Object[]&#123;<span class="string">&quot;弄玉&quot;</span>, <span class="number">18</span> , <span class="string">&quot;女&quot;</span> , <span class="keyword">new</span> ImageIcon(<span class="string">&quot;icon/2.gif&quot;</span>)</span><br><span class="line">            , <span class="keyword">new</span> ImageIcon(<span class="string">&quot;icon/2.gif&quot;</span>) , <span class="keyword">true</span>&#125;,</span><br><span class="line">        <span class="keyword">new</span> Object[]&#123;<span class="string">&quot;虎头&quot;</span> , <span class="number">2</span> , <span class="string">&quot;男&quot;</span> , <span class="keyword">new</span> ImageIcon(<span class="string">&quot;icon/5.gif&quot;</span>)</span><br><span class="line">            , <span class="keyword">new</span> ImageIcon(<span class="string">&quot;icon/5.gif&quot;</span>) , <span class="keyword">false</span>&#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="comment">// 定义一维数据作为列标题</span></span><br><span class="line">    String[] columnTitle = &#123;<span class="string">&quot;姓名&quot;</span> , <span class="string">&quot;年龄&quot;</span> , <span class="string">&quot;性别&quot;</span> , <span class="string">&quot;主头像&quot;</span></span><br><span class="line">        , <span class="string">&quot;次头像&quot;</span> , <span class="string">&quot;是否中国人&quot;</span>&#125;;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// 以二维数组和一维数组来创建一个ExtendedTableModel对象</span></span><br><span class="line">        ExtendedTableModel model = <span class="keyword">new</span> ExtendedTableModel(</span><br><span class="line">            columnTitle , tableData);</span><br><span class="line">        <span class="comment">// 以ExtendedTableModel来创建JTable</span></span><br><span class="line">        table = <span class="keyword">new</span> JTable(model);</span><br><span class="line">        table.setRowSelectionAllowed(<span class="keyword">false</span>);</span><br><span class="line">        table.setRowHeight(<span class="number">40</span>);</span><br><span class="line">        <span class="comment">// 为该表格指定默认的编辑器</span></span><br><span class="line">        table.setDefaultEditor(ImageIcon.class, <span class="keyword">new</span> ImageCellEditor());</span><br><span class="line">        <span class="comment">// 获取第五列</span></span><br><span class="line">        TableColumn lastColumn = table.getColumnModel().getColumn(<span class="number">4</span>);</span><br><span class="line">        <span class="comment">// 创建JComboBox对象，并添加多个图标列表项</span></span><br><span class="line">        JComboBox&lt;ImageIcon&gt; editCombo = <span class="keyword">new</span> JComboBox&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">10</span>; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            editCombo.addItem(<span class="keyword">new</span> ImageIcon(<span class="string">&quot;icon/&quot;</span> + i + <span class="string">&quot;.gif&quot;</span>));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 设置第五列使用基于JComboBox的DefaultCellEditor</span></span><br><span class="line">        lastColumn.setCellEditor(<span class="keyword">new</span> DefaultCellEditor(editCombo));</span><br><span class="line">        <span class="comment">// 将JTable对象放在JScrollPane中，并将该JScrollPane放在窗口中显示出来</span></span><br><span class="line">        jf.add(<span class="keyword">new</span> JScrollPane(table));</span><br><span class="line">        jf.pack();</span><br><span class="line">        jf.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);</span><br><span class="line">        jf.setVisible(<span class="keyword">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">new</span> TableCellEditorTest().init();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ExtendedTableModel</span> <span class="keyword">extends</span> <span class="title">DefaultTableModel</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="comment">// 重新提供一个构造器，该构造器的实现委托给DefaultTableModel父类</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ExtendedTableModel</span><span class="params">(String[] columnNames , Object[][] cells)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(cells , columnNames);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 重写getColumnClass方法，根据每列的第一个值返回该列真实的数据类型</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Class <span class="title">getColumnClass</span><span class="params">(<span class="keyword">int</span> c)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> getValueAt(<span class="number">0</span> , c).getClass();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 扩展DefaultCellEditor来实现TableCellEditor类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ImageCellEditor</span> <span class="keyword">extends</span> <span class="title">DefaultCellEditor</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="comment">// 定义文件选择器</span></span><br><span class="line">    <span class="keyword">private</span> JFileChooser fDialog = <span class="keyword">new</span> JFileChooser(); ;</span><br><span class="line">    <span class="keyword">private</span> JTextField field = <span class="keyword">new</span> JTextField(<span class="number">15</span>);</span><br><span class="line">    <span class="keyword">private</span> JButton button = <span class="keyword">new</span> JButton(<span class="string">&quot;...&quot;</span>);</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ImageCellEditor</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// 因为DefaultCellEditor没有无参数的构造器</span></span><br><span class="line">        <span class="comment">// 所以这里显式调用父类有参数的构造器。</span></span><br><span class="line">        <span class="keyword">super</span>(<span class="keyword">new</span> JTextField());</span><br><span class="line">        initEditor();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">initEditor</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        field.setEditable(<span class="keyword">false</span>);</span><br><span class="line">        <span class="comment">// 为按钮添加监听器，当用户单击该按钮时，</span></span><br><span class="line">        <span class="comment">// 系统将出现一个文件选择器让用户选择图标文件。</span></span><br><span class="line">        button.addActionListener(e -&gt; browse());</span><br><span class="line">        <span class="comment">// 为文件选择器安装文件过滤器</span></span><br><span class="line">        fDialog.addChoosableFileFilter(<span class="keyword">new</span> FileFilter()</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">accept</span><span class="params">(File f)</span></span></span><br><span class="line"><span class="function">            </span>&#123;</span><br><span class="line">                <span class="keyword">if</span> (f.isDirectory())</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                String extension = Utils.getExtension(f);</span><br><span class="line">                <span class="keyword">if</span> (extension != <span class="keyword">null</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">if</span> (extension.equals(Utils.tiff)</span><br><span class="line">                        || extension.equals(Utils.tif)</span><br><span class="line">                        || extension.equals(Utils.gif)</span><br><span class="line">                        || extension.equals(Utils.jpeg)</span><br><span class="line">                        || extension.equals(Utils.jpg)</span><br><span class="line">                        || extension.equals(Utils.png))</span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">else</span></span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="function"><span class="keyword">public</span> String <span class="title">getDescription</span><span class="params">()</span></span></span><br><span class="line"><span class="function">            </span>&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&quot;有效的图片文件&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        fDialog.setAcceptAllFileFilterUsed(<span class="keyword">false</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 重写TableCellEditor接口的getTableCellEditorComponent方法</span></span><br><span class="line">    <span class="comment">// 该方法返回单元格编辑器，该编辑器是一个JPanel，</span></span><br><span class="line">    <span class="comment">// 该容器包含一个文本框和一个按钮</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Component <span class="title">getTableCellEditorComponent</span><span class="params">(JTable table</span></span></span><br><span class="line"><span class="params"><span class="function">        , Object value , <span class="keyword">boolean</span> isSelected , <span class="keyword">int</span> row , <span class="keyword">int</span> column)</span>  <span class="comment">// ①</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.button.setPreferredSize(<span class="keyword">new</span> Dimension(<span class="number">20</span>, <span class="number">20</span>));</span><br><span class="line">        JPanel panel = <span class="keyword">new</span> JPanel();</span><br><span class="line">        panel.setLayout(<span class="keyword">new</span> BorderLayout());</span><br><span class="line">        field.setText(value.toString());</span><br><span class="line">        panel.add(<span class="keyword">this</span>.field, BorderLayout.CENTER);</span><br><span class="line">        panel.add(<span class="keyword">this</span>.button, BorderLayout.EAST);</span><br><span class="line">        <span class="keyword">return</span> panel;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">getCellEditorValue</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ImageIcon(field.getText());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">browse</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// 设置、打开文件选择器</span></span><br><span class="line">        fDialog.setCurrentDirectory(<span class="keyword">new</span> File(<span class="string">&quot;icon&quot;</span>));</span><br><span class="line">        <span class="keyword">int</span> result = fDialog.showOpenDialog(<span class="keyword">null</span>);</span><br><span class="line">        <span class="comment">// 如果单击了文件选择器的“取消”按钮</span></span><br><span class="line">        <span class="keyword">if</span> (result == JFileChooser.CANCEL_OPTION)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 取消编辑</span></span><br><span class="line">            <span class="keyword">super</span>.cancelCellEditing();</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 如果单击了文件选择器的“确定”按钮</span></span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 设置field的内容</span></span><br><span class="line">            field.setText(<span class="string">&quot;icon/&quot;</span> + fDialog.getSelectedFile().getName());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Utils</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">static</span> String jpeg = <span class="string">&quot;jpeg&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">static</span> String jpg = <span class="string">&quot;jpg&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">static</span> String gif = <span class="string">&quot;gif&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">static</span> String tiff = <span class="string">&quot;tiff&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">static</span> String tif = <span class="string">&quot;tif&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">static</span> String png = <span class="string">&quot;png&quot;</span>;</span><br><span class="line">    <span class="comment">// 获取文件扩展名的方法</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">getExtension</span><span class="params">(File f)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        String ext = <span class="keyword">null</span>;</span><br><span class="line">        String s = f.getName();</span><br><span class="line">        <span class="keyword">int</span> i = s.lastIndexOf(<span class="string">&#x27;.&#x27;</span>);</span><br><span class="line">        <span class="keyword">if</span> (i &gt; <span class="number">0</span> &amp;&amp;  i &lt; s.length() - <span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            ext = s.substring(i + <span class="number">1</span>).toLowerCase();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ext;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>上面程序中实现了一个<code>ImageCellEditor</code>编辑器,程序中的粗体字代码将该单元格编辑器注册成<code>Imagelcon</code>类型的单元格编辑器,如果某一列的数据类型是<code>ImageIcon</code>,则默认使用该单元格编辑器。<code>ImageCellEditor</code>扩展了<code>DefaultCellEditor</code>基类,重写<code>getTableCellEditorComponent</code>方法返回一个<code>JPanel</code>,该<code>JPanel</code>里包含一个文本框和一个按钮。<br>除此之外,程序中的粗体字代码还为最后一列安装了一个基于<code>JComboBox</code>的<code>DefaultCellEditor</code>。<br>运行上面程序,双击倒数第3列的任意单元格,开始编辑该单元格,将看到如图12.56所示的窗口。<br><img data-src="https://raw.githubusercontent.com/lanlan2017/images/master/CrazyJavaHandout4/Chapter12/12.11.6/1.png"><br>双击第5列的任意单元格,开始编辑该单元格,将看到如图12.57所示的窗口。<br><img data-src="https://raw.githubusercontent.com/lanlan2017/images/master/CrazyJavaHandout4/Chapter12/12.11.6/2.png"><br>通过图12.56和图12.57可以看岀,如果单元格的值需要从多个枚举值之中选择,则使用<code>DefaultCellEditor</code>即可。使用自定义的单元格编辑器则非常灵活,可以取得单元格编辑器的全部控制权。</p>
<!-- CrazyJavaHandout4/Chapter12/12.11.6/2 -->

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://lanlan2017.github.io/JavaReadingNotes/91e4c8a7/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/JavaReadingNotes/images/avatar.gif">
      <meta itemprop="name" content="蓝蓝">
      <meta itemprop="description" content="好好学习，天天向上">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="蓝蓝站点">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/JavaReadingNotes/91e4c8a7/" class="post-title-link" itemprop="url">12.11.5 绘制单元格内容</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-02-26 04:53:02" itemprop="dateCreated datePublished" datetime="2020-02-26T04:53:02+08:00">2020-02-26</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2020-03-03 04:57:54" itemprop="dateModified" datetime="2020-03-03T04:57:54+08:00">2020-03-03</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JavaReadingNotes/categories/1-%E7%96%AF%E7%8B%82Java%E8%AE%B2%E4%B9%89-%E7%AC%AC4%E7%89%88/" itemprop="url" rel="index"><span itemprop="name">1 疯狂Java讲义 (第4版)</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JavaReadingNotes/categories/1-%E7%96%AF%E7%8B%82Java%E8%AE%B2%E4%B9%89-%E7%AC%AC4%E7%89%88/%E7%AC%AC12%E7%AB%A0-Swing%E7%BC%96%E7%A8%8B/" itemprop="url" rel="index"><span itemprop="name">第12章 Swing编程</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JavaReadingNotes/categories/1-%E7%96%AF%E7%8B%82Java%E8%AE%B2%E4%B9%89-%E7%AC%AC4%E7%89%88/%E7%AC%AC12%E7%AB%A0-Swing%E7%BC%96%E7%A8%8B/12-11-%E4%BD%BF%E7%94%A8JTable%E5%92%8CTableModel%E5%88%9B%E5%BB%BA%E8%A1%A8%E6%A0%BC/" itemprop="url" rel="index"><span itemprop="name">12.11 使用JTable和TableModel创建表格</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
    <span class="post-meta-item-icon">
      <i class="far fa-comment"></i>
    </span>
    <span class="post-meta-item-text">Waline：</span>
  
    <a title="waline" href="/JavaReadingNotes/91e4c8a7/#waline-comments" itemprop="discussionUrl">
      <span class="post-comments-count waline-comment-count" id="/JavaReadingNotes/91e4c8a7/" data-xid="/JavaReadingNotes/91e4c8a7/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>5.6k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>5 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="12-11-5-绘制单元格内容"><a href="#12-11-5-绘制单元格内容" class="headerlink" title="12.11.5 绘制单元格内容"></a>12.11.5 绘制单元格内容</h1><p>前面看到的所有表格的单元格内容都是字符串,实际上表格的单元格内容也可以是更复杂的内容,<code>JTable</code>使用<code>TableCellRenderer</code>绘制单元格,<code>Swing</code>为该接口提供了一个实现类:<code>DefaultTableCellRenderer</code>,该单元格绘制器可以绘制如下三种类型的单元格值(根据其<code>TableModel</code>的<code>getColumnClass</code>方法来决定该单元格值的类型)。</p>
<ul>
<li><code>Icon</code>:默认的单元格绘制器会把该类型的单元格值绘制成该<code>Icon</code>对象所代表的图标。</li>
<li><code>Boolean</code>:默认的单元格绘制器会把该类型的单元格值绘制成复选按钮</li>
<li><code>Object</code>:默认的单元格绘制器在单元格内绘制出该对象的<code>toString()</code>方法返回的字符串</li>
</ul>
<p>在默认情况下,如果程序直接使用二维数组或<code>Vector</code>来创建<code>JTable</code>,程序将会使用<code>JTable</code>的匿名内部类或<code>DefaultTableModel</code>充当该表格的<code>mode</code>对象,这两个<code>TableModel</code>的<code>getColumnClass</code>方法的返回值都是<code>Object</code>。这意味着,即使该二维数组里值的类型是<code>Icon</code>,但由于两个默认的<code>TableModel</code>实现类的<code>getColumnClass</code>方法总是返回<code>Object</code>,这将导致默认的单元格绘制器把<code>Icon</code>值当成<code>Object</code>值处理——只是绘制出其<code>toString</code>方法返回的字符串。</p>
<p>为了让默认的单元格绘制器可以将<code>Icon</code>类型的值绘制成图标,把<code>Boolean</code>类型的值绘制成复选框,创建<code>JTable</code>时所使用的<code>TableModel</code>绝不能采用默认的<code>TableModel</code>,必须采用扩展后的<code>TableModel</code>类,如下所示。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//定义一个DefaultTableCellRenderer类的子类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ExtendedTableModel</span> <span class="keyword">extends</span> <span class="title">DefaultTableCellRenderer</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="comment">//重写 getco1 umnclass方法,根据每列的第一个值来返回每列真实的数据类型</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Class <span class="title">getColumnClass</span><span class="params">(<span class="keyword">int</span> c)</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> getValueAt(<span class="number">0</span>,c).getclass();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>提供了上面的<code>ExtendedTableModel</code>类之后,程序应该先创建<code>ExtendedTableModel</code>对象,再利用该对象来创建<code>Table</code>,这样就可以保证<code>JTable</code>的<code>model</code>对象的<code>getColumnClass</code>方法会返回每列真实的数据类型,默认的单元格绘制器就会将<code>Icon</code>类型的单元格值绘制成图标,将<code>Boolean</code>类型的单元格值绘制成复选框。</p>
<h2 id="自定义表格单元格绘制器"><a href="#自定义表格单元格绘制器" class="headerlink" title="自定义表格单元格绘制器"></a>自定义表格单元格绘制器</h2><p>如果希望程序采用自己定制的单元格绘制器,则必须实现自己的单元格绘制器,单元格绘制器必须实现<code>TableCellRenderer</code>接口。与前面的<code>TreeCellRenderer</code>接口完全相似,该接口里也只包含一个<code>getTableCellrendererComponent()</code>方法,该方法返回的<code>Component</code>将会作为指定单元格绘制的组件。</p>
<h2 id="单元格绘制器模型"><a href="#单元格绘制器模型" class="headerlink" title="单元格绘制器模型"></a>单元格绘制器模型</h2><p><code>Swing</code>提供了一致的编程模型,不管是<code>JList</code>、<code>JTree</code>还是<code>JTable</code>,它们所使用的单元格绘制器都有一致的编程模型,分别需要扩展<code>ListCellRenderer</code>、<code>TreeCellRenderer</code>或<code>TableCellRenderer</code>,扩展这三个基类时都需要重写<code>getXxeCellRendererComponent()</code>方法,该方法的返回值将作为被绘制的组件</p>
<h2 id="单元格绘制器的两种方式"><a href="#单元格绘制器的两种方式" class="headerlink" title="单元格绘制器的两种方式"></a>单元格绘制器的两种方式</h2><p>一旦实现了自己的单元格绘制器之后,还必须将该单元格绘制器安装到指定的<code>JTable</code>对象上,为指定的<code>JTable</code>对象安装单元格绘制器有如下两种方式。</p>
<ul>
<li>局部方式(列级):调用<code>TableColumn</code>的<code>setCellRenderer()</code>方法为指定列安装指定的单元格绘制器</li>
<li>全局方式(表级):调用<code>JTable</code>的<code>setDefaultRenderer()</code>方法为指定的<code>JTable</code>对象安装单元格绘制器。<code>setDefaultRenderer()</code>方法需要传入两个参数,即列类型和单元格绘制器,表明指定类型的数据列才会使用该单元格绘制器。</li>
</ul>
<h3 id="局部绘制器优先级更高"><a href="#局部绘制器优先级更高" class="headerlink" title="局部绘制器优先级更高"></a>局部绘制器优先级更高</h3><p>当某一列既符合全局绘制器的规则,又符合局部绘制器的规则时,局部绘制器将会负责绘制该单元格,全局绘制器不会产生任何作用。</p>
<h2 id="列头单元格绘制器"><a href="#列头单元格绘制器" class="headerlink" title="列头单元格绘制器"></a>列头单元格绘制器</h2><p>除此之外,<code>TableColumn</code>还包含了一个<code>setHeaderRenderer()</code>方法,该方法可以为指定列的列头安装单元格绘制器。</p>
<h2 id="程序"><a href="#程序" class="headerlink" title="程序"></a>程序</h2><p>下面程序提供了一个<code>ExtendedTablemodel</code>类,该类扩展了<code>DefaultTableModel</code>,重写了父类的<code>getColumnClass()</code>方法,该方法根据每列的第一个值来决定该列的数据类型;下面程序还提供了一个定制的单元格绘制器,它使用图标来形象地表明每个好友的性别</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.awt.*;</span><br><span class="line"><span class="keyword">import</span> javax.swing.*;</span><br><span class="line"><span class="keyword">import</span> javax.swing.table.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TableCellRendererTest</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    JFrame jf = <span class="keyword">new</span> JFrame(<span class="string">&quot;使用单元格绘制器&quot;</span>);</span><br><span class="line">    JTable table;</span><br><span class="line">    <span class="comment">// 定义二维数组作为表格数据</span></span><br><span class="line">    Object[][] tableData =</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">new</span> Object[]&#123;<span class="string">&quot;李清照&quot;</span> , <span class="number">29</span> , <span class="string">&quot;女&quot;</span></span><br><span class="line">            , <span class="keyword">new</span> ImageIcon(<span class="string">&quot;icon/3.gif&quot;</span>) , <span class="keyword">true</span>&#125;,</span><br><span class="line">        <span class="keyword">new</span> Object[]&#123;<span class="string">&quot;苏格拉底&quot;</span>, <span class="number">56</span> , <span class="string">&quot;男&quot;</span></span><br><span class="line">            , <span class="keyword">new</span> ImageIcon(<span class="string">&quot;icon/1.gif&quot;</span>) , <span class="keyword">false</span>&#125;,</span><br><span class="line">        <span class="keyword">new</span> Object[]&#123;<span class="string">&quot;李白&quot;</span>, <span class="number">35</span> , <span class="string">&quot;男&quot;</span></span><br><span class="line">            , <span class="keyword">new</span> ImageIcon(<span class="string">&quot;icon/4.gif&quot;</span>) , <span class="keyword">true</span>&#125;,</span><br><span class="line">        <span class="keyword">new</span> Object[]&#123;<span class="string">&quot;弄玉&quot;</span>, <span class="number">18</span> , <span class="string">&quot;女&quot;</span></span><br><span class="line">            , <span class="keyword">new</span> ImageIcon(<span class="string">&quot;icon/2.gif&quot;</span>) , <span class="keyword">true</span>&#125;,</span><br><span class="line">        <span class="keyword">new</span> Object[]&#123;<span class="string">&quot;虎头&quot;</span> , <span class="number">2</span> , <span class="string">&quot;男&quot;</span></span><br><span class="line">            , <span class="keyword">new</span> ImageIcon(<span class="string">&quot;icon/5.gif&quot;</span>) , <span class="keyword">false</span>&#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="comment">// 定义一维数据作为列标题</span></span><br><span class="line">    String[] columnTitle = &#123;<span class="string">&quot;姓名&quot;</span> , <span class="string">&quot;年龄&quot;</span> , <span class="string">&quot;性别&quot;</span></span><br><span class="line">        , <span class="string">&quot;主头像&quot;</span> , <span class="string">&quot;是否中国人&quot;</span>&#125;;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// 以二维数组和一维数组来创建一个ExtendedTableModel对象</span></span><br><span class="line">        ExtendedTableModel model = <span class="keyword">new</span> ExtendedTableModel(columnTitle</span><br><span class="line">            , tableData);</span><br><span class="line">        <span class="comment">// 以ExtendedTableModel来创建JTable</span></span><br><span class="line">        table = <span class="keyword">new</span> JTable( model);</span><br><span class="line">        table.setRowSelectionAllowed(<span class="keyword">false</span>);</span><br><span class="line">        table.setRowHeight(<span class="number">40</span>);</span><br><span class="line">        <span class="comment">// 获取第三列</span></span><br><span class="line">        TableColumn lastColumn = table.getColumnModel().getColumn(<span class="number">2</span>);</span><br><span class="line">        <span class="comment">// 对第三列采用自定义的单元格绘制器</span></span><br><span class="line">        lastColumn.setCellRenderer(<span class="keyword">new</span> GenderTableCellRenderer());</span><br><span class="line">        <span class="comment">// 将JTable对象放在JScrollPane中，并将该JScrollPane显示出来</span></span><br><span class="line">        jf.add(<span class="keyword">new</span> JScrollPane(table));</span><br><span class="line">        jf.pack();</span><br><span class="line">        jf.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);</span><br><span class="line">        jf.setVisible(<span class="keyword">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">new</span> TableCellRendererTest().init();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ExtendedTableModel</span> <span class="keyword">extends</span> <span class="title">DefaultTableModel</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="comment">// 重新提供一个构造器，该构造器的实现委托给DefaultTableModel父类</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ExtendedTableModel</span><span class="params">(String[] columnNames , Object[][] cells)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(cells , columnNames);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 重写getColumnClass方法，根据每列的第一个值来返回其真实的数据类型</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Class <span class="title">getColumnClass</span><span class="params">(<span class="keyword">int</span> c)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> getValueAt(<span class="number">0</span> , c).getClass();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 定义自定义的单元格绘制器</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">GenderTableCellRenderer</span> <span class="keyword">extends</span> <span class="title">JPanel</span></span></span><br><span class="line"><span class="class">    <span class="keyword">implements</span> <span class="title">TableCellRenderer</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String cellValue;</span><br><span class="line">    <span class="comment">// 定义图标的宽度和高度</span></span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">int</span> ICON_WIDTH = <span class="number">23</span>;</span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">int</span> ICON_HEIGHT = <span class="number">21</span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Component <span class="title">getTableCellRendererComponent</span><span class="params">(JTable table</span></span></span><br><span class="line"><span class="params"><span class="function">        , Object value , <span class="keyword">boolean</span> isSelected , <span class="keyword">boolean</span> hasFocus</span></span></span><br><span class="line"><span class="params"><span class="function">        , <span class="keyword">int</span> row , <span class="keyword">int</span> column)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        cellValue = (String)value;</span><br><span class="line">        <span class="comment">// 设置选中状态下绘制边框</span></span><br><span class="line">        <span class="keyword">if</span> (hasFocus)</span><br><span class="line">        &#123;</span><br><span class="line">            setBorder(UIManager.getBorder(<span class="string">&quot;Table.focusCellHighlightBorder&quot;</span>));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            setBorder(<span class="keyword">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 重写paint()方法，负责绘制该单元格内容</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">paint</span><span class="params">(Graphics g)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// 如果表格值为&quot;男&quot;或&quot;male&quot;，则绘制一个男性图标</span></span><br><span class="line">        <span class="keyword">if</span> (cellValue.equalsIgnoreCase(<span class="string">&quot;男&quot;</span>)</span><br><span class="line">            || cellValue.equalsIgnoreCase(<span class="string">&quot;male&quot;</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            drawImage(g , <span class="keyword">new</span> ImageIcon(<span class="string">&quot;icon/male.gif&quot;</span>).getImage());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 如果表格值为&quot;女&quot;或&quot;female&quot;，则绘制一个女性图标</span></span><br><span class="line">        <span class="keyword">if</span> (cellValue.equalsIgnoreCase(<span class="string">&quot;女&quot;</span>)</span><br><span class="line">            || cellValue.equalsIgnoreCase(<span class="string">&quot;female&quot;</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            drawImage(g , <span class="keyword">new</span> ImageIcon(<span class="string">&quot;icon/female.gif&quot;</span>).getImage());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 绘制图标的方法</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">drawImage</span><span class="params">(Graphics g , Image image)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        g.drawImage(image, (getWidth() - ICON_WIDTH ) / <span class="number">2</span></span><br><span class="line">            , (getHeight() - ICON_HEIGHT) / <span class="number">2</span> , <span class="keyword">null</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>上面程序中没有直接使用二维数组和一维数组来创建<code>JTable</code>对象,而是采用<code>ExtendedTableModel</code>对象来创建<code>JTable</code>对象(如第一段粗体字代码所示)。<code>ExtendedTableModel</code>类重写了父类的<code>getColumnClass</code>方法,该方法将会根据每列实际的值来返回该列的类型(如第二段粗体字代码所示)。<br>程序提供了一个<code>GenderTableCellRenderer</code>类,该类实现了<code>Tablecellrenderer</code>接口,可以作为单元格绘制器使用。该类继承了<code>JPanel</code>容器,重写<code>getTableCelIRendererComponent()</code>方法时返回<code>this</code>,这表明它会使用<code>JPanel</code>对象作为单元格绘制器。<br>读者可以将<code>ExtendedTableModel</code>补充得更加完整——主要是将<code>DefaultTableModel</code>中的几个构造器重新暴露出来,以后程序中可以使用<code>ExtendedTablemodel</code>类作为<code>JTable</code>的<code>model</code>类,这样创建的<code>JTable</code>就可以将<code>Icon</code>列、<code>Boolean</code>列绘制成图标和复选框。<br>运行上面程序,会看到如图12.54所示的效果。<br><img data-src="https://raw.githubusercontent.com/lanlan2017/images/master/CrazyJavaHandout4/Chapter12/12.11.5/1.png"></p>
<!-- CrazyJavaHandout4/Chapter12/12.11.5/2 -->

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://lanlan2017.github.io/JavaReadingNotes/914dd4b9/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/JavaReadingNotes/images/avatar.gif">
      <meta itemprop="name" content="蓝蓝">
      <meta itemprop="description" content="好好学习，天天向上">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="蓝蓝站点">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/JavaReadingNotes/914dd4b9/" class="post-title-link" itemprop="url">12.11.4 实现排序</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-02-26 04:37:13" itemprop="dateCreated datePublished" datetime="2020-02-26T04:37:13+08:00">2020-02-26</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2020-03-03 04:57:54" itemprop="dateModified" datetime="2020-03-03T04:57:54+08:00">2020-03-03</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JavaReadingNotes/categories/1-%E7%96%AF%E7%8B%82Java%E8%AE%B2%E4%B9%89-%E7%AC%AC4%E7%89%88/" itemprop="url" rel="index"><span itemprop="name">1 疯狂Java讲义 (第4版)</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JavaReadingNotes/categories/1-%E7%96%AF%E7%8B%82Java%E8%AE%B2%E4%B9%89-%E7%AC%AC4%E7%89%88/%E7%AC%AC12%E7%AB%A0-Swing%E7%BC%96%E7%A8%8B/" itemprop="url" rel="index"><span itemprop="name">第12章 Swing编程</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JavaReadingNotes/categories/1-%E7%96%AF%E7%8B%82Java%E8%AE%B2%E4%B9%89-%E7%AC%AC4%E7%89%88/%E7%AC%AC12%E7%AB%A0-Swing%E7%BC%96%E7%A8%8B/12-11-%E4%BD%BF%E7%94%A8JTable%E5%92%8CTableModel%E5%88%9B%E5%BB%BA%E8%A1%A8%E6%A0%BC/" itemprop="url" rel="index"><span itemprop="name">12.11 使用JTable和TableModel创建表格</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
    <span class="post-meta-item-icon">
      <i class="far fa-comment"></i>
    </span>
    <span class="post-meta-item-text">Waline：</span>
  
    <a title="waline" href="/JavaReadingNotes/914dd4b9/#waline-comments" itemprop="discussionUrl">
      <span class="post-comments-count waline-comment-count" id="/JavaReadingNotes/914dd4b9/" data-xid="/JavaReadingNotes/914dd4b9/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>4.5k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>4 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="12-11-4-实现排序"><a href="#12-11-4-实现排序" class="headerlink" title="12.11.4 实现排序"></a>12.11.4 实现排序</h1><p>使用<code>JTable</code>实现的表格并没有实现根据指定列排序的功能,但开发者可以利用<code>AbstractTableModel</code>类来实现该功能。由于<code>TableModel</code>不强制要求保存表格里的数据,只要<code>TableModel</code>实现了<code>getValueAt()</code>,<code>getColumnCount()</code>和<code>getRowCount()</code>三个方法,<code>JTable</code>就可以根据该<code>TableModel</code>生成表格。因此可以创建个<code>SortableTableModel</code>实现类,它可以将原<code>TableModel</code>包装起来,并实现根据指定列排序的功能。</p>
<p>程序创建的<code>SortableTableModel</code>实现类会对原<code>TableModel</code>进行包装,但它实际上并不保存仼何数据,它会把所有的方法实现委托给原<code>TableModel</code>完成。<code>SortableTableModel</code>仅保存原<code>TableModel</code>里每行的行索引,当程序对<code>SortableTableModel</code>的指定列排序时,实际上仅仅对<code>SortableTableModel</code>里的行索引进行排序,这样造成的结果是:<code>SortableTableModel</code>里的数据行的行索引与原<code>TableModel</code>里数据行的行索引不一致,所以对于<code>TableModel</code>的那些涉及行索引的方法都需要进行相应的转换。</p>
<h2 id="程序-表格排序"><a href="#程序-表格排序" class="headerlink" title="程序 表格排序"></a>程序 表格排序</h2><p>下面程序实现了<code>SortableTableModel</code>类,并使用该类来实现对表格根据指定列排序的功能。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.awt.event.*;</span><br><span class="line"><span class="keyword">import</span> javax.swing.*;</span><br><span class="line"><span class="keyword">import</span> javax.swing.table.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SortTable</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    JFrame jf = <span class="keyword">new</span> JFrame(<span class="string">&quot;可按列排序的表格&quot;</span>);</span><br><span class="line">    <span class="comment">// 定义二维数组作为表格数据</span></span><br><span class="line">    Object[][] tableData =</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">new</span> Object[]&#123;<span class="string">&quot;李清照&quot;</span> , <span class="number">29</span> , <span class="string">&quot;女&quot;</span>&#125;,</span><br><span class="line">        <span class="keyword">new</span> Object[]&#123;<span class="string">&quot;苏格拉底&quot;</span>, <span class="number">56</span> , <span class="string">&quot;男&quot;</span>&#125;,</span><br><span class="line">        <span class="keyword">new</span> Object[]&#123;<span class="string">&quot;李白&quot;</span>, <span class="number">35</span> , <span class="string">&quot;男&quot;</span>&#125;,</span><br><span class="line">        <span class="keyword">new</span> Object[]&#123;<span class="string">&quot;弄玉&quot;</span>, <span class="number">18</span> , <span class="string">&quot;女&quot;</span>&#125;,</span><br><span class="line">        <span class="keyword">new</span> Object[]&#123;<span class="string">&quot;虎头&quot;</span> , <span class="number">2</span> , <span class="string">&quot;男&quot;</span>&#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="comment">// 定义一维数据作为列标题</span></span><br><span class="line">    Object[] columnTitle = &#123;<span class="string">&quot;姓名&quot;</span> , <span class="string">&quot;年龄&quot;</span> , <span class="string">&quot;性别&quot;</span>&#125;;</span><br><span class="line">    <span class="comment">// 以二维数组和一维数组来创建一个JTable对象</span></span><br><span class="line">    JTable table = <span class="keyword">new</span> JTable(tableData , columnTitle);</span><br><span class="line">    <span class="comment">// 将原表格里的model包装成新的SortableTableModel对象</span></span><br><span class="line">    SortableTableModel sorterModel = <span class="keyword">new</span> SortableTableModel(</span><br><span class="line">        table.getModel());</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// 使用包装后SortableTableModel对象作为JTable的model对象</span></span><br><span class="line">        table.setModel(sorterModel);</span><br><span class="line">        <span class="comment">// 为每列的列头增加鼠标监听器</span></span><br><span class="line">        table.getTableHeader().addMouseListener(<span class="keyword">new</span> MouseAdapter()</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">mouseClicked</span><span class="params">(MouseEvent event)</span>    <span class="comment">// ①</span></span></span><br><span class="line"><span class="function">            </span>&#123;</span><br><span class="line">                <span class="comment">//  如果单击次数小于2，即不是双击，直接返回</span></span><br><span class="line">                <span class="keyword">if</span> (event.getClickCount() &lt; <span class="number">2</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">return</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">// 找出鼠标双击事件所在的列索引</span></span><br><span class="line">                <span class="keyword">int</span> tableColumn = table.columnAtPoint(event.getPoint());</span><br><span class="line">                <span class="comment">// 将JTable中的列索引转换成对应TableModel中的列索引</span></span><br><span class="line">                <span class="keyword">int</span> modelColumn = table.convertColumnIndexToModel(tableColumn);</span><br><span class="line">                <span class="comment">// 根据指定列进行排序</span></span><br><span class="line">                sorterModel.sort(modelColumn);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="comment">// 将JTable对象放在JScrollPane中，并将该JScrollPane显示出来</span></span><br><span class="line">        jf.add(<span class="keyword">new</span> JScrollPane(table));</span><br><span class="line">        jf.pack();</span><br><span class="line">        jf.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);</span><br><span class="line">        jf.setVisible(<span class="keyword">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">new</span> SortTable().init();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SortableTableModel</span> <span class="keyword">extends</span> <span class="title">AbstractTableModel</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> TableModel model;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> sortColumn;</span><br><span class="line">    <span class="keyword">private</span> Row[] rows;</span><br><span class="line">    <span class="comment">// 将一个已经存在TableModel对象包装成SortableTableModel对象</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">SortableTableModel</span><span class="params">(TableModel m)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// 将被封装的TableModel传入</span></span><br><span class="line">        model = m;</span><br><span class="line">        rows = <span class="keyword">new</span> Row[model.getRowCount()];</span><br><span class="line">        <span class="comment">// 将原TableModel中的每行记录的索引使用Row数组保存起来</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; rows.length; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            rows[i] = <span class="keyword">new</span> Row(i);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 实现根据指定列进行排序</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sort</span><span class="params">(<span class="keyword">int</span> c)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        sortColumn = c;</span><br><span class="line">        java.util.Arrays.sort(rows);</span><br><span class="line">        fireTableDataChanged();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 下面三个方法需要访问model中的数据，所以涉及本model中数据</span></span><br><span class="line">    <span class="comment">// 和被包装model数据中的索引转换，程序使用rows数组完成这种转换。</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">getValueAt</span><span class="params">(<span class="keyword">int</span> r, <span class="keyword">int</span> c)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> model.getValueAt(rows[r].index, c);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isCellEditable</span><span class="params">(<span class="keyword">int</span> r, <span class="keyword">int</span> c)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> model.isCellEditable(rows[r].index, c);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setValueAt</span><span class="params">(Object aValue, <span class="keyword">int</span> r, <span class="keyword">int</span> c)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        model.setValueAt(aValue, rows[r].index, c);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 下面方法的实现把该model的方法委托为原封装的model来实现</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getRowCount</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> model.getRowCount();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getColumnCount</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> model.getColumnCount();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getColumnName</span><span class="params">(<span class="keyword">int</span> c)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> model.getColumnName(c);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Class <span class="title">getColumnClass</span><span class="params">(<span class="keyword">int</span> c)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> model.getColumnClass(c);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 定义一个Row类，该类用于封装JTable中的一行</span></span><br><span class="line">    <span class="comment">// 实际上它并不封装行数据，它只封装行索引</span></span><br><span class="line">    <span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">Row</span> <span class="keyword">implements</span> <span class="title">Comparable</span>&lt;<span class="title">Row</span>&gt;</span></span><br><span class="line"><span class="class">    </span>&#123;</span><br><span class="line">        <span class="comment">// 该index保存着被封装Model里每行记录的行索引</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">int</span> index;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">Row</span><span class="params">(<span class="keyword">int</span> index)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.index = index;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 实现两行之间的大小比较</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compareTo</span><span class="params">(Row other)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            Object a = model.getValueAt(index, sortColumn);</span><br><span class="line">            Object b = model.getValueAt(other.index, sortColumn);</span><br><span class="line">            <span class="keyword">if</span> (a <span class="keyword">instanceof</span> Comparable)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> ((Comparable)a).compareTo(b);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> a.toString().compareTo(b.toString());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>上面程序是在<code>SimpleTable</code>程序的基础上改变而来的,改变的部分就是增加了两行粗体字代码和①号粗体字代码块。其中粗体字代码负责把原<code>JTable</code>的<code>model</code>对象包装成<code>SortableTableModel</code>实例,并设置原<code>JTable</code>使用<code>SortableTableModel</code>实例作为对应的<code>mode</code>对象;<br>而①号粗体宇代码部分则用于为该表格的列头增加鼠标监听器:当用鼠标双击指定列时,<code>SortableTableModel</code>对象根据指定列进行排序。<br>程序中还使用了<code>convertColumnIndexToModel()</code>方法把<code>JTable</code>中的列索引转换成<code>TableModel</code>中的列索引。这是因为<code>JTable</code>中的列允许用户随意拖动,因此可能造成<code>JTable</code>中的列索引与<code>TableModel</code>中的列索引不一致。<br>运行上面程序,并双击“年龄”列头,将看到如图12.53所示的排序效果。<br><img data-src="https://raw.githubusercontent.com/lanlan2017/images/master/CrazyJavaHandout4/Chapter12/12.11.4/1.png"></p>
<!-- CrazyJavaHandout4/Chapter12/12.11.4/1 -->
<p>实际上,上面程序的关键在于<code>SortableTableModel</code>类,该类使用<code>rows</code>数组来保存原<code>TableModel</code>里的行索引。为了让程序可以对<code>rows</code>数组元素根据指定列排序,程序使用了<code>Row</code>类来封装行索引,并实现了<code>compareTo()</code>方法,该方法实现了根据指定列来比较两行大小的功能,从而允许程序根据指定列对<code>rows</code>[数组元素进行排序。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://lanlan2017.github.io/JavaReadingNotes/19c3521a/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/JavaReadingNotes/images/avatar.gif">
      <meta itemprop="name" content="蓝蓝">
      <meta itemprop="description" content="好好学习，天天向上">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="蓝蓝站点">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/JavaReadingNotes/19c3521a/" class="post-title-link" itemprop="url">12.11 使用JTable和TableModel创建表格</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-02-24 11:30:14" itemprop="dateCreated datePublished" datetime="2020-02-24T11:30:14+08:00">2020-02-24</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2020-03-03 04:57:54" itemprop="dateModified" datetime="2020-03-03T04:57:54+08:00">2020-03-03</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JavaReadingNotes/categories/1-%E7%96%AF%E7%8B%82Java%E8%AE%B2%E4%B9%89-%E7%AC%AC4%E7%89%88/" itemprop="url" rel="index"><span itemprop="name">1 疯狂Java讲义 (第4版)</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JavaReadingNotes/categories/1-%E7%96%AF%E7%8B%82Java%E8%AE%B2%E4%B9%89-%E7%AC%AC4%E7%89%88/%E7%AC%AC12%E7%AB%A0-Swing%E7%BC%96%E7%A8%8B/" itemprop="url" rel="index"><span itemprop="name">第12章 Swing编程</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JavaReadingNotes/categories/1-%E7%96%AF%E7%8B%82Java%E8%AE%B2%E4%B9%89-%E7%AC%AC4%E7%89%88/%E7%AC%AC12%E7%AB%A0-Swing%E7%BC%96%E7%A8%8B/12-11-%E4%BD%BF%E7%94%A8JTable%E5%92%8CTableModel%E5%88%9B%E5%BB%BA%E8%A1%A8%E6%A0%BC/" itemprop="url" rel="index"><span itemprop="name">12.11 使用JTable和TableModel创建表格</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
    <span class="post-meta-item-icon">
      <i class="far fa-comment"></i>
    </span>
    <span class="post-meta-item-text">Waline：</span>
  
    <a title="waline" href="/JavaReadingNotes/19c3521a/#waline-comments" itemprop="discussionUrl">
      <span class="post-comments-count waline-comment-count" id="/JavaReadingNotes/19c3521a/" data-xid="/JavaReadingNotes/19c3521a/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>10k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>9 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="12-11-使用JTable和TableModel创建表格"><a href="#12-11-使用JTable和TableModel创建表格" class="headerlink" title="12.11 使用JTable和TableModel创建表格"></a>12.11 使用JTable和TableModel创建表格</h1><p>表格也是<code>GUI</code>程序中常用的组件,表格是一个由多行、多列组成的二维显示区。<code>Swing</code>的<code>JTable</code>以及相关类提供了这种表格支持,通过使用<code>JTable</code>以及相关类,程序既可以使用简单的代码创建岀表格来显示二维数据,也可以开发出功能丰富的表格,还可以为表格定制各种显示外观、编辑特性。</p>
<h1 id="12-11-1-创建表格"><a href="#12-11-1-创建表格" class="headerlink" title="12.11.1 创建表格"></a>12.11.1 创建表格</h1><p>使用<code>JTable</code>来创建表格是非常容易的事情,<code>JTable</code>可以把一个二维数据包装成一个表格,这个二维数据既可以是一个二维数组,也可以是集合元素为<code>Vector</code>的<code>Vector</code>对象(<code>Vector</code>里包含<code>Vector</code>形成二维数据)。除此之外,为了给该表格的每一列指定列标题,还需要传入一个一维数据作为列标题,这个维数据既可以是一维数组,也可以是<code>Vector</code>对象。</p>
<h2 id="程序-使用二维数组和一维数组创建简单表格"><a href="#程序-使用二维数组和一维数组创建简单表格" class="headerlink" title="程序 使用二维数组和一维数组创建简单表格"></a>程序 使用二维数组和一维数组创建简单表格</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> javax.swing.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SimpleTable</span> </span>&#123;</span><br><span class="line">    JFrame jf = <span class="keyword">new</span> JFrame(<span class="string">&quot;简单表格&quot;</span>);</span><br><span class="line">    JTable table;</span><br><span class="line">    <span class="comment">// 定义二维数组作为表格数据</span></span><br><span class="line">    Object[][] tableData = &#123;</span><br><span class="line">            <span class="keyword">new</span> Object[] &#123; <span class="string">&quot;李清照&quot;</span>, <span class="number">29</span>, <span class="string">&quot;女&quot;</span> &#125;, </span><br><span class="line">            <span class="keyword">new</span> Object[] &#123; <span class="string">&quot;苏格拉底&quot;</span>, <span class="number">56</span>, <span class="string">&quot;男&quot;</span> &#125;,</span><br><span class="line">            <span class="keyword">new</span> Object[] &#123; <span class="string">&quot;李白&quot;</span>, <span class="number">35</span>, <span class="string">&quot;男&quot;</span> &#125;, </span><br><span class="line">            <span class="keyword">new</span> Object[] &#123; <span class="string">&quot;弄玉&quot;</span>, <span class="number">18</span>, <span class="string">&quot;女&quot;</span> &#125;, </span><br><span class="line">            <span class="keyword">new</span> Object[] &#123; <span class="string">&quot;虎头&quot;</span>, <span class="number">2</span>, <span class="string">&quot;男&quot;</span> &#125; </span><br><span class="line">        &#125;;</span><br><span class="line">    <span class="comment">// 定义一维数据作为列标题</span></span><br><span class="line">    Object[] columnTitle = &#123; <span class="string">&quot;姓名&quot;</span>, <span class="string">&quot;年龄&quot;</span>, <span class="string">&quot;性别&quot;</span> &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 以二维数组和一维数组来创建一个JTable对象</span></span><br><span class="line">        table = <span class="keyword">new</span> JTable(tableData, columnTitle);</span><br><span class="line">        <span class="comment">// 将JTable对象放在JScrollPane中，</span></span><br><span class="line">        <span class="comment">// 并将该JScrollPane放在窗口中显示出来</span></span><br><span class="line">        jf.add(<span class="keyword">new</span> JScrollPane(table));</span><br><span class="line">        jf.pack();</span><br><span class="line">        jf.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);</span><br><span class="line">        jf.setVisible(<span class="keyword">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">new</span> SimpleTable().init();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>上面程序中的粗体字代码创建了两个<code>Object</code>数组,第一个二维数组作为<code>JTable</code>的数据,第二个维数组作为<code>JTable</code>的列标题。创建二维数组时利用了<code>JDK1.5</code>提供的自动装箱功能—虽然直接指定的数组元素是<code>int</code>类型的整数,但系统会将它包装成<code>Integer</code>对象。</p>
<h2 id="JTable表格数据是字符串"><a href="#JTable表格数据是字符串" class="headerlink" title="JTable表格数据是字符串"></a>JTable表格数据是字符串</h2><p>在默认情况下,<code>JTable</code>的表格数据、表格列标题全部是字符串内容,因此<code>JTable</code>会使用这些<code>Object</code>对象的<code>toString()</code>方法的返回值作为表格数据、表格列标题。</p>
<h2 id="通过TableModel处理特殊的表格数据"><a href="#通过TableModel处理特殊的表格数据" class="headerlink" title="通过TableModel处理特殊的表格数据"></a>通过TableModel处理特殊的表格数据</h2><p>如果需要特殊对待某些表格数据,例如把它们当成图标或其他类型的对象来处理,则可以通过特定的<code>TableModel</code>或指定自己的单元格绘制器来实现。<br>在默认情况下,<code>JTable</code>的所有单元格、列标题显示的全部是字符串内容。除此之外,通常应该将<code>JTable</code>对象放在<code>JScrollPane</code>容器中,由<code>JScrollPane</code>为<code>JTable</code>提供<code>ViewPort</code>。<br>运行上面程序,会看到如图12.47所示的简单表格。<br><img data-src="https://raw.githubusercontent.com/lanlan2017/images/master/CrazyJavaHandout4/Chapter12/12.11.1/1.png"></p>
<ul>
<li>虽然生成如图12.47所示表格的代码非常简单,但这个表格已经表现出丰富的功能。该表格具有如下几个功能。</li>
<li>当表格高度不足以显示所有的数据行时,该表格会自动显示滚动条。</li>
<li>当把鼠标移动到两列之间的分界符时,鼠标形状会变成可调整大小的形状,表明用户可以自由调整表格列的大小。</li>
<li>当在表格列上按下鼠标并拖动时,可以将表格的整列拖动到其他位置</li>
<li>当单击某一个单元格时,系统会自动选中该单元格所在的行。</li>
<li>当双击某一个单元格时,系统会自动进入该单元格的修改状态</li>
</ul>
<h2 id="设置JTable列宽调整方式-setAutoResizeMode方法"><a href="#设置JTable列宽调整方式-setAutoResizeMode方法" class="headerlink" title="设置JTable列宽调整方式 setAutoResizeMode方法"></a>设置JTable列宽调整方式 setAutoResizeMode方法</h2><p>在上面的程序中,<strong>当拖动两列分界线来调整某列的列宽时,将看到该列后面的所有列的列宽都会发生相应的改变,但该列前面的所有列的列宽都不会发生改变,整个表格的宽度不会发生改变</strong></p>
<!-- CrazyJavaHandout4/Chapter12/12.11.1/1 -->
<p><code>JTable</code>提供了一个<code>setAutoResizeMode()</code>方法来控制这种调整方式:</p>
<table>
<thead>
<tr>
<th align="left">方法</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>void setAutoResizeMode(int mode)</code></td>
<td align="left">Sets the table’s auto resize mode when the table is resized.</td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th align="left"><code>setAutoResizeMode</code>方法<code>mode</code>参数值</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>JTable.AUTO_RESIZE_OFF</code></td>
<td align="left">关闭<code>JTable</code>的自动调整功能,当调整某一列的宽度时,其他列的宽度不会发生改变,<strong>只有表格的宽度会随之改变</strong>。</td>
</tr>
<tr>
<td align="left"><code>JTable.AUTO_RESIZE_NEXT_COLUMN</code></td>
<td align="left">只调整下一列的宽度,其他列及表格的宽度不会发生改变。</td>
</tr>
<tr>
<td align="left"><code>JTable.AUTO_RESIZE_SUBSEQUENT_COLUMNS</code></td>
<td align="left"><strong>平均调整当前列后面所有列的宽度,当前列的前面所有列及表格的宽度都不会发生变化</strong>,这是<strong>默认的调整方式</strong>。</td>
</tr>
<tr>
<td align="left"><code>JTable.AUTO_RESIZE_LAST_COLUMN</code></td>
<td align="left">只调整最后一列的宽度,其他列及表格的宽度不会发生改变。</td>
</tr>
<tr>
<td align="left"><code>JTable.AUTO_RESIZE_ALL_COLUMNS</code></td>
<td align="left"><strong>平均调整表格中所有列的宽度</strong>,表格的宽度不会发生改变。</td>
</tr>
</tbody></table>
<p><code>JTable</code>默认采用平均调整当前列后面所有列的宽度的方式,这种方式允许用户从左到右依次调整每列的宽度,以达到最好的显示效果。<br>尽量避免使用<strong>平均调整表格中所有列的宽度</strong>的方式,这种方式将会导致用户调整某列时,其余所有列都随之发生改变,从而使得用户很难把毎一列的宽度都调整到具有最好的显示效果</p>
<h2 id="TableColumn"><a href="#TableColumn" class="headerlink" title="TableColumn"></a>TableColumn</h2><p>如果需要精确控制每一列的宽度,则可通过<code>TableColumn</code>对象来实现。**<code>JTable</code>使用<code>TableColumn</code>来表示表格中的每一列,<code>JTable</code>中表格列的所有属性,如最佳宽度、是否可调整宽度、最小和最大宽度等都保存在该<code>TableColumn</code>中**。此外,<code>TableColumn</code>还允许为该列指定特定的单元格绘制器和单元格编辑器(这些内容将在后面讲解)。<br><code>TableColumn</code>具有如下方法。</p>
<table>
<thead>
<tr>
<th align="left"><code>TableColumn</code>类方法</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>void setMaxWidth(int maxWidth)</code></td>
<td align="left">设置该列的最大宽度。如果指定的<code>maxWidth</code>小于该列的最小宽度,则<code>maxWidth</code>被设置成最小宽度。</td>
</tr>
<tr>
<td align="left"><code>void setMinWidth(int minWidth)</code></td>
<td align="left">设置该列的最小宽度。</td>
</tr>
<tr>
<td align="left"><code>void setPreferredWidth(int preferredWidth)</code></td>
<td align="left">设置该列的最佳宽度。</td>
</tr>
<tr>
<td align="left"><code>void setResizable(boolean isResizable)</code></td>
<td align="left">设置是否可以调整该列的宽度。</td>
</tr>
<tr>
<td align="left"><code>void sizeWidthToFit()</code></td>
<td align="left">调整该列的宽度,以适合其标题单元格的宽度。</td>
</tr>
</tbody></table>
<h2 id="设置是否选中整行"><a href="#设置是否选中整行" class="headerlink" title="设置是否选中整行"></a>设置是否选中整行</h2><p>在默认情况下,当用户单击<code>JTable</code>的任意一个单元格时,系统默认会选中该单元格所在行的的x也就是说,<code>JTable</code>表格默认的选择单元是行。当然也可通过<code>JTable</code>提供的<code>setRowSelectionAllowed()</code>方来改变这种设置,如果为该方法传入<code>false</code>参数,则可以关闭这种每次选择一行的方式。</p>
<h2 id="设置是否选中整列"><a href="#设置是否选中整列" class="headerlink" title="设置是否选中整列"></a>设置是否选中整列</h2><p>除此之外,<code>JTable</code>还提供了一个<code>setColumnSelectionAllowed()</code>方法,该方法用于控制选择单元是否是列,如果为该方法传入<code>true</code>参数,则当用户单击某个单元格时,系统会选中该单元格所在的列。</p>
<h2 id="选中单元格"><a href="#选中单元格" class="headerlink" title="选中单元格"></a>选中单元格</h2><p>如果同时调用<code>setColumnSelectionAllowed(true)</code>和<code>setRowSelectionAllowed(true)</code>方法,则该表格的选择单元是单元格。</p>
<p>实际上,同时调用这两个方法相当于调用<code>setCellSelectionEnabled(true)</code>方法。与此相反,如果调用<code>setCellSelectionEnabled(false)</code>方法,则相当于同时调用<code>setColumnSelectionAllowed(false)</code>和<code>setRow Allowed(false)</code>方法,即用户无法选中该表格的任何地方。</p>
<table>
<thead>
<tr>
<th align="left"><code>JTable</code>的方法</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>void setRowSelectionAllowed(boolean rowSelectionAllowed)</code></td>
<td align="left">Sets whether the rows in this model can be selected.</td>
</tr>
<tr>
<td align="left"><code>void setColumnSelectionAllowed(boolean columnSelectionAllowed)</code></td>
<td align="left">Sets whether the columns in this model can be selected.</td>
</tr>
<tr>
<td align="left"><code>void setCellSelectionEnabled(boolean cellSelectionEnabled)</code></td>
<td align="left">Sets whether this table allows both a column selection and a row selection to exist simultaneously.</td>
</tr>
</tbody></table>
<h2 id="ListSelectionModel"><a href="#ListSelectionModel" class="headerlink" title="ListSelectionModel"></a>ListSelectionModel</h2><p>与<code>JList</code>、<code>JTree</code>类似的是,<strong><code>JTable</code>使用了一个<code>ListSelectionModel</code>表示该表格的选择状态</strong>,程序可以通过<code>ListSelectionModel</code>来控制<code>JTable</code>的选择模式。</p>
<p><strong>注意</strong>:保存<code>JTable</code>选择状态的<code>model</code>类就是<code>ListselectionModel</code>,这并不是笔误。</p>
<h3 id="JTable的选择模式"><a href="#JTable的选择模式" class="headerlink" title="JTable的选择模式"></a><code>JTable</code>的选择模式</h3><p><code>JTable</code>的选择模式有如下三种</p>
<table>
<thead>
<tr>
<th align="left"><code>ListselectionModel</code>属性</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>static int MULTIPLE_INTERVAL_SELECTION</code></td>
<td align="left">没有任何限制,可以选择表格中任何表格单元,这是默认的选择模式。通过<code>Shift</code>和<code>Ctrl</code>辅助键的帮助可以选择多个表格单元</td>
</tr>
<tr>
<td align="left"><code>static int SINGLE_INTERVAL_SELECTION</code></td>
<td align="left">选择单个连续区域,该选项可以选择多个表格单元,但多个表格单元之间必须是连续的。通过<code>Shift</code>辅助键的帮助来选择连续区域。</td>
</tr>
<tr>
<td align="left"><code>static int SINGLE_SELECTION</code></td>
<td align="left">只能选择单个表格单元。</td>
</tr>
</tbody></table>
<h2 id="代码-改变JTable的选择模式"><a href="#代码-改变JTable的选择模式" class="headerlink" title="代码 改变JTable的选择模式"></a>代码 改变JTable的选择模式</h2><p>程序通常通过如下代码来改变<code>JTable</code>的选择模式。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//设置该表格只能选中单个表格单元</span></span><br><span class="line">jTable.getSelectionModel().setSelectionMode(ListselectionMode.SINGLE_SELECTION);</span><br></pre></td></tr></table></figure>
<h2 id="程序"><a href="#程序" class="headerlink" title="程序"></a>程序</h2><p>下面程序示范了如何控制每列的宽度、控制表格的宽度调整模式、改变表格的选择单元和表格的选择模式。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> javax.swing.*;</span><br><span class="line"><span class="keyword">import</span> javax.swing.table.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AdjustingWidth</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    JFrame jf = <span class="keyword">new</span> JFrame(<span class="string">&quot;调整表格列宽&quot;</span>);</span><br><span class="line">    JMenuBar menuBar = <span class="keyword">new</span> JMenuBar();</span><br><span class="line">    JMenu adjustModeMenu = <span class="keyword">new</span> JMenu(<span class="string">&quot;调整方式&quot;</span>);</span><br><span class="line">    JMenu selectUnitMenu = <span class="keyword">new</span> JMenu(<span class="string">&quot;选择单元&quot;</span>);</span><br><span class="line">    JMenu selectModeMenu = <span class="keyword">new</span> JMenu(<span class="string">&quot;选择方式&quot;</span>);</span><br><span class="line">    <span class="comment">// 定义5个单选框按钮，用以控制表格的宽度调整方式</span></span><br><span class="line">    JRadioButtonMenuItem[] adjustModesItem = <span class="keyword">new</span> JRadioButtonMenuItem[<span class="number">5</span>];</span><br><span class="line">    <span class="comment">// 定义3个单选框按钮，用以控制表格的选择方式</span></span><br><span class="line">    JRadioButtonMenuItem[] selectModesItem = <span class="keyword">new</span> JRadioButtonMenuItem[<span class="number">3</span>];</span><br><span class="line">    JCheckBoxMenuItem rowsItem = <span class="keyword">new</span> JCheckBoxMenuItem(<span class="string">&quot;选择行&quot;</span>);</span><br><span class="line">    JCheckBoxMenuItem columnsItem = <span class="keyword">new</span> JCheckBoxMenuItem(<span class="string">&quot;选择列&quot;</span>);</span><br><span class="line">    JCheckBoxMenuItem cellsItem = <span class="keyword">new</span> JCheckBoxMenuItem(<span class="string">&quot;选择单元格&quot;</span>);</span><br><span class="line">    ButtonGroup adjustBg = <span class="keyword">new</span> ButtonGroup();</span><br><span class="line">    ButtonGroup selectBg = <span class="keyword">new</span> ButtonGroup();</span><br><span class="line">    <span class="comment">// 定义一个int类型的数组，用于保存表格所有的宽度调整方式</span></span><br><span class="line">    <span class="keyword">int</span>[] adjustModes = <span class="keyword">new</span> <span class="keyword">int</span>[]&#123;</span><br><span class="line">        JTable.AUTO_RESIZE_OFF</span><br><span class="line">        , JTable.AUTO_RESIZE_NEXT_COLUMN</span><br><span class="line">        , JTable.AUTO_RESIZE_SUBSEQUENT_COLUMNS</span><br><span class="line">        , JTable.AUTO_RESIZE_LAST_COLUMN</span><br><span class="line">        , JTable.AUTO_RESIZE_ALL_COLUMNS</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">int</span>[] selectModes = <span class="keyword">new</span> <span class="keyword">int</span>[]&#123;</span><br><span class="line">        ListSelectionModel.MULTIPLE_INTERVAL_SELECTION</span><br><span class="line">        , ListSelectionModel.SINGLE_INTERVAL_SELECTION</span><br><span class="line">        , ListSelectionModel.SINGLE_SELECTION</span><br><span class="line">    &#125;;</span><br><span class="line">    JTable table;</span><br><span class="line">    <span class="comment">// 定义二维数组作为表格数据</span></span><br><span class="line">    Object[][] tableData =</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">new</span> Object[]&#123;<span class="string">&quot;李清照&quot;</span> , <span class="number">29</span> , <span class="string">&quot;女&quot;</span>&#125;,</span><br><span class="line">        <span class="keyword">new</span> Object[]&#123;<span class="string">&quot;苏格拉底&quot;</span>, <span class="number">56</span> , <span class="string">&quot;男&quot;</span>&#125;,</span><br><span class="line">        <span class="keyword">new</span> Object[]&#123;<span class="string">&quot;李白&quot;</span>, <span class="number">35</span> , <span class="string">&quot;男&quot;</span>&#125;,</span><br><span class="line">        <span class="keyword">new</span> Object[]&#123;<span class="string">&quot;弄玉&quot;</span>, <span class="number">18</span> , <span class="string">&quot;女&quot;</span>&#125;,</span><br><span class="line">        <span class="keyword">new</span> Object[]&#123;<span class="string">&quot;虎头&quot;</span> , <span class="number">2</span> , <span class="string">&quot;男&quot;</span>&#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="comment">// 定义一维数据作为列标题</span></span><br><span class="line">    Object[] columnTitle = &#123;<span class="string">&quot;姓名&quot;</span> , <span class="string">&quot;年龄&quot;</span> , <span class="string">&quot;性别&quot;</span>&#125;;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// 以二维数组和一维数组来创建一个JTable对象</span></span><br><span class="line">        table = <span class="keyword">new</span> JTable(tableData , columnTitle);</span><br><span class="line">        <span class="comment">// -----------为窗口安装设置表格调整方式的菜单-----------</span></span><br><span class="line">        adjustModesItem[<span class="number">0</span>] = <span class="keyword">new</span> JRadioButtonMenuItem(<span class="string">&quot;只调整表格&quot;</span>);</span><br><span class="line">        adjustModesItem[<span class="number">1</span>] = <span class="keyword">new</span> JRadioButtonMenuItem(<span class="string">&quot;只调整下一列&quot;</span>);</span><br><span class="line">        adjustModesItem[<span class="number">2</span>] = <span class="keyword">new</span> JRadioButtonMenuItem(<span class="string">&quot;平均调整余下列&quot;</span>);</span><br><span class="line">        adjustModesItem[<span class="number">3</span>] = <span class="keyword">new</span> JRadioButtonMenuItem(<span class="string">&quot;只调整最后一列&quot;</span>);</span><br><span class="line">        adjustModesItem[<span class="number">4</span>] = <span class="keyword">new</span> JRadioButtonMenuItem(<span class="string">&quot;平均调整所有列&quot;</span>);</span><br><span class="line">        menuBar.add(adjustModeMenu);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; adjustModesItem.length ; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 默认选中第三个菜单项，即对应表格默认的宽度调整方式</span></span><br><span class="line">            <span class="keyword">if</span> (i == <span class="number">2</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                adjustModesItem[i].setSelected(<span class="keyword">true</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            adjustBg.add(adjustModesItem[i]);</span><br><span class="line">            adjustModeMenu.add(adjustModesItem[i]);</span><br><span class="line">            <span class="keyword">final</span> <span class="keyword">int</span> index = i;</span><br><span class="line">            <span class="comment">// 为设置调整方式的菜单项添加监听器</span></span><br><span class="line">            adjustModesItem[i].addActionListener(evt -&gt;</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 如果当前菜单项处于选中状态，表格使用对应的调整方式</span></span><br><span class="line">                <span class="keyword">if</span> (adjustModesItem[index].isSelected())</span><br><span class="line">                &#123;</span><br><span class="line">                    table.setAutoResizeMode(adjustModes[index]);   <span class="comment">//①</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// -----------为窗口安装设置表格选择方式的菜单-----------</span></span><br><span class="line">        selectModesItem[<span class="number">0</span>] = <span class="keyword">new</span> JRadioButtonMenuItem(<span class="string">&quot;无限制&quot;</span>);</span><br><span class="line">        selectModesItem[<span class="number">1</span>] = <span class="keyword">new</span> JRadioButtonMenuItem(<span class="string">&quot;单独的连续区&quot;</span>);</span><br><span class="line">        selectModesItem[<span class="number">2</span>] = <span class="keyword">new</span> JRadioButtonMenuItem(<span class="string">&quot;单选&quot;</span>);</span><br><span class="line">        menuBar.add(selectModeMenu);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; selectModesItem.length ; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 默认选中第一个菜单项，即对应表格默认的选择方式</span></span><br><span class="line">            <span class="keyword">if</span> (i == <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">            selectModesItem[i].setSelected(<span class="keyword">true</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            selectBg.add(selectModesItem[i]);</span><br><span class="line">            selectModeMenu.add(selectModesItem[i]);</span><br><span class="line">            <span class="keyword">final</span> <span class="keyword">int</span> index = i;</span><br><span class="line">            <span class="comment">// 为设置选择方式的菜单项添加监听器</span></span><br><span class="line">            selectModesItem[i].addActionListener(evt -&gt; &#123;</span><br><span class="line">                <span class="comment">// 如果当前菜单项处于选中状态，表格使用对应的选择方式s</span></span><br><span class="line">                <span class="keyword">if</span> (selectModesItem[index].isSelected())</span><br><span class="line">                &#123;</span><br><span class="line">                    table.getSelectionModel().setSelectionMode</span><br><span class="line">                        (selectModes[index]);     <span class="comment">//②</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">        menuBar.add(selectUnitMenu);</span><br><span class="line">        <span class="comment">// -----为窗口安装设置表格选择单元的菜单-----</span></span><br><span class="line">        rowsItem.setSelected(table.getRowSelectionAllowed());</span><br><span class="line">        columnsItem.setSelected(table.getColumnSelectionAllowed());</span><br><span class="line">        cellsItem.setSelected(table.getCellSelectionEnabled());</span><br><span class="line">        rowsItem.addActionListener(event -&gt; &#123;</span><br><span class="line">            table.clearSelection();</span><br><span class="line">            <span class="comment">// 如果该菜单项处于选中状态，设置表格的选择单元是行</span></span><br><span class="line">            table.setRowSelectionAllowed(rowsItem.isSelected());</span><br><span class="line">            <span class="comment">// 如果选择行、选择列同时被选中，其实质是选择单元格</span></span><br><span class="line">            cellsItem.setSelected(table.getCellSelectionEnabled());</span><br><span class="line">        &#125;);</span><br><span class="line">        selectUnitMenu.add(rowsItem);</span><br><span class="line">        columnsItem.addActionListener(event -&gt; &#123;</span><br><span class="line">            table.clearSelection();</span><br><span class="line">            <span class="comment">// 如果该菜单项处于选中状态，设置表格的选择单元是列</span></span><br><span class="line">            table.setColumnSelectionAllowed(columnsItem.isSelected());</span><br><span class="line">            <span class="comment">// 如果选择行、选择列同时被选中，其实质是选择单元格</span></span><br><span class="line">            cellsItem.setSelected(table.getCellSelectionEnabled());</span><br><span class="line">        &#125;);</span><br><span class="line">        selectUnitMenu.add(columnsItem);</span><br><span class="line">        cellsItem.addActionListener(event -&gt; &#123;</span><br><span class="line">            table.clearSelection();</span><br><span class="line">            <span class="comment">// 如果该菜单项处于选中状态，设置表格的选择单元是单元格</span></span><br><span class="line">            table.setCellSelectionEnabled(cellsItem.isSelected());</span><br><span class="line">            <span class="comment">// 该选项的改变会同时影响选择行、选择列两个菜单</span></span><br><span class="line">            rowsItem.setSelected(table.getRowSelectionAllowed());</span><br><span class="line">            columnsItem.setSelected(table.getColumnSelectionAllowed());</span><br><span class="line">        &#125;);</span><br><span class="line">        selectUnitMenu.add(cellsItem);</span><br><span class="line">        jf.setJMenuBar(menuBar);</span><br><span class="line">        <span class="comment">// 分别获取表格的三个表格列，并设置三列的最小宽度，最佳宽度和最大宽度</span></span><br><span class="line">        TableColumn nameColumn = table.getColumn(columnTitle[<span class="number">0</span>]);</span><br><span class="line">        nameColumn.setMinWidth(<span class="number">40</span>);</span><br><span class="line">        TableColumn ageColumn = table.getColumn(columnTitle[<span class="number">1</span>]);</span><br><span class="line">        ageColumn.setPreferredWidth(<span class="number">50</span>);</span><br><span class="line">        TableColumn genderColumn = table.getColumn(columnTitle[<span class="number">2</span>]);</span><br><span class="line">        genderColumn.setMaxWidth(<span class="number">50</span>);</span><br><span class="line">        <span class="comment">// 将JTable对象放在JScrollPane中，并将该JScrollPane放在窗口中显示出来</span></span><br><span class="line">        jf.add(<span class="keyword">new</span> JScrollPane(table));</span><br><span class="line">        jf.pack();</span><br><span class="line">        jf.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);</span><br><span class="line">        jf.setVisible(<span class="keyword">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">new</span> AdjustingWidth().init();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>上面程序中的①号粗体字代码根据单选钮菜单来设置表格的宽度调整方式,②号粗体字代码根据单选钮菜单来设置表格的选择模式,最后一段粗体字代码通过<code>JTable</code>的<code>getColumn()</code>方法获取指定列,并分别设置三列的最佳、最大、最小宽度。如果选中“只调整表格”菜单项,并把第一列宽度拖大,将看到如图12.48所示的界面<br>上面程序中还有三段粗体字代码,分别用于为三个复选框菜单添加监听器,根据复选框菜单的选中状态来决定表格的选择单元。如果程序采用<code>JTable</code>默认的选择模式(无限制的选择模式),并设置表格的选择单元是单元格,则可看到如图12.49所示的界面。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://lanlan2017.github.io/JavaReadingNotes/c3dd988/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/JavaReadingNotes/images/avatar.gif">
      <meta itemprop="name" content="蓝蓝">
      <meta itemprop="description" content="好好学习，天天向上">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="蓝蓝站点">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/JavaReadingNotes/c3dd988/" class="post-title-link" itemprop="url">12.11.3 TableColumnMode和监听器</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-02-24 05:09:39" itemprop="dateCreated datePublished" datetime="2020-02-24T05:09:39+08:00">2020-02-24</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2020-03-03 04:57:54" itemprop="dateModified" datetime="2020-03-03T04:57:54+08:00">2020-03-03</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JavaReadingNotes/categories/1-%E7%96%AF%E7%8B%82Java%E8%AE%B2%E4%B9%89-%E7%AC%AC4%E7%89%88/" itemprop="url" rel="index"><span itemprop="name">1 疯狂Java讲义 (第4版)</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JavaReadingNotes/categories/1-%E7%96%AF%E7%8B%82Java%E8%AE%B2%E4%B9%89-%E7%AC%AC4%E7%89%88/%E7%AC%AC12%E7%AB%A0-Swing%E7%BC%96%E7%A8%8B/" itemprop="url" rel="index"><span itemprop="name">第12章 Swing编程</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JavaReadingNotes/categories/1-%E7%96%AF%E7%8B%82Java%E8%AE%B2%E4%B9%89-%E7%AC%AC4%E7%89%88/%E7%AC%AC12%E7%AB%A0-Swing%E7%BC%96%E7%A8%8B/12-11-%E4%BD%BF%E7%94%A8JTable%E5%92%8CTableModel%E5%88%9B%E5%BB%BA%E8%A1%A8%E6%A0%BC/" itemprop="url" rel="index"><span itemprop="name">12.11 使用JTable和TableModel创建表格</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
    <span class="post-meta-item-icon">
      <i class="far fa-comment"></i>
    </span>
    <span class="post-meta-item-text">Waline：</span>
  
    <a title="waline" href="/JavaReadingNotes/c3dd988/#waline-comments" itemprop="discussionUrl">
      <span class="post-comments-count waline-comment-count" id="/JavaReadingNotes/c3dd988/" data-xid="/JavaReadingNotes/c3dd988/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>4.6k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>4 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="12-11-3-TableColumnMode和监听器"><a href="#12-11-3-TableColumnMode和监听器" class="headerlink" title="12.11.3 TableColumnMode和监听器"></a>12.11.3 TableColumnMode和监听器</h1><p><code>JTable</code>使用<code>TableModel</code>来保存该表格所有数据列的状态数据,如果程序需要访问<code>JTable</code>的所有列状态信息,则可以通过获取该<code>JTable</code>的<code>TableColumnModel</code>来实现。<code>TableColumnModel</code>提供了如下几个方法来增加、删除和移动数据列:</p>
<table>
<thead>
<tr>
<th align="left">方法</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>void addColumn(TableColumn aColumn)</code></td>
<td align="left">该方法用于为<code>TableModel</code>添加一列。该方法主要用于将原来隐藏的数据列显示出来</td>
</tr>
<tr>
<td align="left"><code>void moveColumn(int columnIndex, int newIndex)</code></td>
<td align="left">该方法用于将指定列移动到其他位置。</td>
</tr>
<tr>
<td align="left"><code>void removeColumn(TableColumn column)</code></td>
<td align="left">该方法用于从<code>TableModel</code>中删除指定列。实际上,该方法并未真正删除指定列,只是将该列在<code>TableColumnModel</code>中隐藏起来,使之不可见。</td>
</tr>
</tbody></table>
<p>注意:当调用<code>removeColumn</code>删除指定列之后,调用<code>TableColumnModel</code>的<code>getColumnCount()</code>方法也会看到返回的列数减少了,看起来很像真正删除了该列。但使用<code>setValueAt()</code>方法为该列设置值时,依然可以设置成功,这表明调用<code>removeColumn</code>删除指定列之后,这些列依然是存在的<br>实际上,<code>JTable</code>也提供了对应的方法来增加、删除和移动数据列,不过<code>JTable</code>的这些方法实际上还是需要委托给它所对应的<code>TableColumnModel</code>来完成。<br>图12.51显示了<code>JTable</code>及其主要辅助类之间的关系:</p>
<p>未完待续</p>
<h2 id="程序"><a href="#程序" class="headerlink" title="程序"></a>程序</h2><p>下面程序示范了如何通过<code>DefaultTableModel</code>和<code>TableColumnModel</code>动态地改变表格的行、列。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.awt.BorderLayout;</span><br><span class="line"><span class="keyword">import</span> javax.swing.*;</span><br><span class="line"><span class="keyword">import</span> javax.swing.table.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DefaultTableModelTest</span> </span>&#123;</span><br><span class="line">    JFrame mainWin = <span class="keyword">new</span> JFrame(<span class="string">&quot;管理数据行、数据列&quot;</span>);</span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">int</span> COLUMN_COUNT = <span class="number">5</span>;</span><br><span class="line">    DefaultTableModel model;</span><br><span class="line">    JTable table;</span><br><span class="line">    <span class="comment">// 用于保存被隐藏列的List集合</span></span><br><span class="line">    ArrayList&lt;TableColumn&gt; hiddenColumns = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        model = <span class="keyword">new</span> DefaultTableModel(COLUMN_COUNT, COLUMN_COUNT);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; COLUMN_COUNT; i++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; COLUMN_COUNT; j++) &#123;</span><br><span class="line">                model.setValueAt(<span class="string">&quot;老单元格值 &quot;</span> + i + <span class="string">&quot; &quot;</span> + j, i, j);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        table = <span class="keyword">new</span> JTable(model);</span><br><span class="line">        mainWin.add(<span class="keyword">new</span> JScrollPane(table), BorderLayout.CENTER);</span><br><span class="line">        <span class="comment">// 为窗口安装菜单</span></span><br><span class="line">        JMenuBar menuBar = <span class="keyword">new</span> JMenuBar();</span><br><span class="line">        mainWin.setJMenuBar(menuBar);</span><br><span class="line">        JMenu tableMenu = <span class="keyword">new</span> JMenu(<span class="string">&quot;管理&quot;</span>);</span><br><span class="line">        menuBar.add(tableMenu);</span><br><span class="line">        JMenuItem hideColumnsItem = <span class="keyword">new</span> JMenuItem(<span class="string">&quot;隐藏选中列&quot;</span>);</span><br><span class="line">        hideColumnsItem.addActionListener(event -&gt; &#123;</span><br><span class="line">            <span class="comment">// 获取所有选中列的索引</span></span><br><span class="line">            <span class="keyword">int</span>[] selected = table.getSelectedColumns();</span><br><span class="line">            TableColumnModel columnModel = table.getColumnModel();</span><br><span class="line">            <span class="comment">// 依次把每一个选中的列隐藏起来，并使用List保存这些列</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = selected.length - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">                TableColumn column = columnModel.getColumn(selected[i]);</span><br><span class="line">                <span class="comment">// 隐藏指定列</span></span><br><span class="line">                table.removeColumn(column);</span><br><span class="line">                <span class="comment">// 把隐藏的列保存起来，确保以后可以显示出来</span></span><br><span class="line">                hiddenColumns.add(column);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        tableMenu.add(hideColumnsItem);</span><br><span class="line">        JMenuItem showColumnsItem = <span class="keyword">new</span> JMenuItem(<span class="string">&quot;显示隐藏列&quot;</span>);</span><br><span class="line">        showColumnsItem.addActionListener(event -&gt; &#123;</span><br><span class="line">            <span class="comment">// 把所有隐藏列依次显示出来</span></span><br><span class="line">            <span class="keyword">for</span> (TableColumn tc : hiddenColumns) &#123;</span><br><span class="line">                <span class="comment">// 依次把所有隐藏的列显示出来</span></span><br><span class="line">                table.addColumn(tc);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 清空保存隐藏列的List集合</span></span><br><span class="line">            hiddenColumns.clear();</span><br><span class="line">        &#125;);</span><br><span class="line">        tableMenu.add(showColumnsItem);</span><br><span class="line">        JMenuItem addColumnItem = <span class="keyword">new</span> JMenuItem(<span class="string">&quot;插入选中列&quot;</span>);</span><br><span class="line">        addColumnItem.addActionListener(event -&gt; &#123;</span><br><span class="line">            <span class="comment">// 获取所有选中列的索引</span></span><br><span class="line">            <span class="keyword">int</span>[] selected = table.getSelectedColumns();</span><br><span class="line">            TableColumnModel columnModel = table.getColumnModel();</span><br><span class="line">            <span class="comment">// 依次把选中的列添加到JTable之后</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = selected.length - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">                TableColumn column = columnModel.getColumn(selected[i]);</span><br><span class="line">                table.addColumn(column);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        tableMenu.add(addColumnItem);</span><br><span class="line">        JMenuItem addRowItem = <span class="keyword">new</span> JMenuItem(<span class="string">&quot;增加行&quot;</span>);</span><br><span class="line">        addRowItem.addActionListener(event -&gt; &#123;</span><br><span class="line">            <span class="comment">// 创建一个String数组作为新增行的内容</span></span><br><span class="line">            String[] newCells = <span class="keyword">new</span> String[COLUMN_COUNT];</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; newCells.length; i++) &#123;</span><br><span class="line">                newCells[i] = <span class="string">&quot;新单元格值 &quot;</span> + model.getRowCount() + <span class="string">&quot; &quot;</span> + i;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 向TableModel中新增一行。</span></span><br><span class="line">            model.addRow(newCells);</span><br><span class="line">        &#125;);</span><br><span class="line">        tableMenu.add(addRowItem);</span><br><span class="line">        JMenuItem removeRowsItem = <span class="keyword">new</span> JMenuItem(<span class="string">&quot;删除选中行&quot;</span>);</span><br><span class="line">        removeRowsItem.addActionListener(event -&gt; &#123;</span><br><span class="line">            <span class="comment">// 获取所有选中行</span></span><br><span class="line">            <span class="keyword">int</span>[] selected = table.getSelectedRows();</span><br><span class="line">            <span class="comment">// 依次删除所有选中行</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = selected.length - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">                model.removeRow(selected[i]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        tableMenu.add(removeRowsItem);</span><br><span class="line">        mainWin.pack();</span><br><span class="line">        mainWin.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);</span><br><span class="line">        mainWin.setVisible(<span class="keyword">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">new</span> DefaultTableModelTest().init();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>上面程序中的粗体字代码部分就是程序控制隐藏列、显示隐藏列、增加数据行和删除数据行的代码。除此之外,程序还实现了一个功能:当用户选中某个数据列之后,还可以将该数据列添加到该表格的后面——但不要忘记了<code>add()</code>方法的功能,<code>add</code>方法只是将已有的数据列显示出来,并不是真正添加数据列。运行上面程序,会看到如图12.52所示的界面。<br>从图12.52中可以看出,虽然程序新增了一列,但新增列的列名依然是B,如果修改新增列内的单元格的值时,看到原来的B列的值也随之改变,由此可见,<strong><code>addColumn</code>方法只是将原有的列显示出来而已</strong>。程序还允许新增数据行,当执行<code>addRows()</code>方法时需要传入数组或<code>Vector</code>参数,该参数里包含的多个数值将作为新增行的数据。</p>
<h2 id="监听JTable里列状态的改变"><a href="#监听JTable里列状态的改变" class="headerlink" title="监听JTable里列状态的改变"></a>监听JTable里列状态的改变</h2><p>如果程序需要监听<code>JTable</code>里<strong>列状态的改变</strong>,例如监听列的增加、删除、移动等改变,则必须使用该<code>JTable</code>所对应的<code>TableColumnModel</code>对象。</p>
<p><code>TableColumnModel</code>对象提供了一个<code>addColumnModelListener()</code>方法来添加监听器(<code>TableColumnModelListener</code>),监</p>
<p><code>TableColumnModelListener</code>听器接口里包含如下几个方法:</p>
<table>
<thead>
<tr>
<th align="left">方法</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>void columnAdded(TableColumnModelEvent e)</code></td>
<td align="left">当向<code>TableColumnModel</code>里添加数据列时将会触发该方法</td>
</tr>
<tr>
<td align="left"><code>void columnMarginChanged(ChangeEvent e)</code></td>
<td align="left">当由于页面距(<code>Margin</code>)的改变引起列状态改变时将会触发该方法</td>
</tr>
<tr>
<td align="left"><code>void columnMoved(TableColumnModelEvent e)</code></td>
<td align="left">当移动<code>TableColumnMode</code>里的数据列时将会触发该方法</td>
</tr>
<tr>
<td align="left"><code>void columnRemoved(TableColumnModelEvent e)</code></td>
<td align="left">当删除<code>TableColumnModel</code>里的数据列时将会触发该方法。</td>
</tr>
<tr>
<td align="left"><code>void columnSelectionChanged(ListSelectionEvent e)</code></td>
<td align="left">当改变表格的选择模式时将会触发该方法。</td>
</tr>
</tbody></table>
<p>但表格的数据列通常需要程序来控制增加、删除,用户操作通常无法直接为表格增加、删除数据列,所以使用监听器来监听<code>TableColumnModel</code>改变的情况比较少见。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/JavaReadingNotes/page/71/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/JavaReadingNotes/">1</a><span class="space">&hellip;</span><a class="page-number" href="/JavaReadingNotes/page/71/">71</a><span class="page-number current">72</span><a class="page-number" href="/JavaReadingNotes/page/73/">73</a><span class="space">&hellip;</span><a class="page-number" href="/JavaReadingNotes/page/188/">188</a><a class="extend next" rel="next" href="/JavaReadingNotes/page/73/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 2018 – 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">蓝蓝</span>
</div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
      <span>站点总字数：</span>
    <span title="站点总字数">5.8m</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span>站点阅读时长 &asymp;</span>
    <span title="站点阅读时长">88:01</span>
  </span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@next-theme/pjax@0.5.0/pjax.min.js" integrity="sha256-3NkoLDrmHLTYj7csHIZSr0MHAFTXth7Ua/DDt4MRUAg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/lozad@1.16.0/dist/lozad.min.js" integrity="sha256-mOFREFhqmHeQbXpK2lp4nA3qooVgACfh88fpJftLBbc=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/pangu@4.0.7/dist/browser/pangu.min.js" integrity="sha256-j+yj56cdEY2CwkVtGyz18fNybFGpMGJ8JxG3GSyO2+I=" crossorigin="anonymous"></script>
<script src="/JavaReadingNotes/js/comments.js"></script><script src="/JavaReadingNotes/js/utils.js"></script><script src="/JavaReadingNotes/js/motion.js"></script><script src="/JavaReadingNotes/js/next-boot.js"></script><script src="/JavaReadingNotes/js/bookmark.js"></script><script src="/JavaReadingNotes/js/pjax.js"></script>

  
<script src="https://cdn.jsdelivr.net/npm/hexo-generator-searchdb@1.4.0/dist/search.js" integrity="sha256-vXZMYLEqsROAXkEw93GGIvaB2ab+QW6w3+1ahD9nXXA=" crossorigin="anonymous"></script>
<script src="/JavaReadingNotes/js/third-party/search/local-search.js"></script>



  <script src="/JavaReadingNotes/js/third-party/fancybox.js"></script>

  <script src="/JavaReadingNotes/js/third-party/pace.js"></script>

  




  

  <script class="next-config" data-name="enableMath" type="application/json">false</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js","integrity":"sha256-r+3itOMtGGjap0x+10hu6jW/gZCzxHsoKrOd7gyRSGY="}}</script>
<script src="/JavaReadingNotes/js/third-party/math/mathjax.js"></script>


  <script src="https://cdn.jsdelivr.net/npm/quicklink@2.2.0/dist/quicklink.umd.js" integrity="sha256-4kQf9z5ntdQrzsBC3YSHnEz02Z9C1UeW/E9OgnvlzSY=" crossorigin="anonymous"></script>
  <script class="next-config" data-name="quicklink" type="application/json">{"enable":true,"home":true,"archive":true,"delay":true,"timeout":3000,"priority":true,"url":"https://lanlan2017.github.io/JavaReadingNotes/page/72/"}</script>
  <script src="/JavaReadingNotes/js/third-party/quicklink.js"></script>
<script class="next-config" data-name="waline" type="application/json">{"lang":null,"enable":true,"serverURL":"https://waline-test-lanlan2017.vercel.app","placeholder":"填写邮箱可接收回复通知 填写个人网址可为您引流","avatar":"mm","pageSize":10,"visitor":false,"comment_count":true,"requiredFields":[],"meta":["nick","mail","link"],"libUrl":"https://cdn.jsdelivr.net/npm/@waline/client/dist/Waline.min.js","el":"#waline-comments","path":"/JavaReadingNotes/page/72/"}</script>
<script>
document.addEventListener('page:loaded', () => {
  NexT.utils.loadComments(CONFIG.waline.el).then(() => 
    NexT.utils.getScript(CONFIG.waline.libUrl, { condition: window.Waline })
  ).then(() => {
    new Waline(CONFIG.waline);
  });
});
</script>
</body>
</html>
