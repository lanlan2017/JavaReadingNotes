<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 6.1.0">

<link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>
  <link rel="apple-touch-icon" sizes="180x180" href="/JavaReadingNotes/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/JavaReadingNotes/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/JavaReadingNotes/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/JavaReadingNotes/images/logo.svg" color="#222">
  <meta name="google-site-verification" content="_Sly-yzHYmALHXzjFpPWsodMrjBSphw7bfRbMUH80Qc">
  <meta name="msvalidate.01" content="B1CFD346B8DEBBFE0C983C2AF8955531">
  <meta name="baidu-site-verification" content="vkMTwK56xr">

<link rel="stylesheet" href="/JavaReadingNotes/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css" integrity="sha256-DfWjNxDkM94fVBWx1H5BMMp0Zq7luBlV8QRcSES7s+0=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/themes/blue/pace-theme-minimal.css">
  <script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"lanlan2017.github.io","root":"/JavaReadingNotes/","images":"/JavaReadingNotes/images","scheme":"Gemini","darkmode":true,"version":"8.11.0","exturl":false,"sidebar":{"position":"right","display":"post","padding":18,"offset":12},"copycode":true,"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":true,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/JavaReadingNotes/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/JavaReadingNotes/js/config.js"></script>

    <meta name="description" content="好好学习，天天向上">
<meta property="og:type" content="website">
<meta property="og:title" content="蓝蓝站点">
<meta property="og:url" content="https://lanlan2017.github.io/JavaReadingNotes/page/154/index.html">
<meta property="og:site_name" content="蓝蓝站点">
<meta property="og:description" content="好好学习，天天向上">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="蓝蓝">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://lanlan2017.github.io/JavaReadingNotes/page/154/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"zh-CN","comments":"","permalink":"","path":"page/154/index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>蓝蓝站点</title>
  

  <script src="/JavaReadingNotes/js/third-party/analytics/baidu-analytics.js"></script>
  <script async src="https://hm.baidu.com/hm.js?dadeb188eb14ccde0b25a19230c429b5"></script>



<link rel="dns-prefetch" href="https://waline-test-lanlan2017.vercel.app">
  <noscript>
    <link rel="stylesheet" href="/JavaReadingNotes/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/JavaReadingNotes/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">蓝蓝站点</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">Java读书笔记</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/JavaReadingNotes/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-dir"><a href="/JavaReadingNotes/dir/" rel="section"><i class="fa fa-sitemap fa-fw"></i>目录</a></li><li class="menu-item menu-item-categories"><a href="/JavaReadingNotes/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/JavaReadingNotes/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li><li class="menu-item menu-item-tags"><a href="/JavaReadingNotes/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="蓝蓝"
      src="/JavaReadingNotes/images/avatar.gif">
  <p class="site-author-name" itemprop="name">蓝蓝</p>
  <div class="site-description" itemprop="description">好好学习，天天向上</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/JavaReadingNotes/archives/">
          <span class="site-state-item-count">1875</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/JavaReadingNotes/categories/">
        <span class="site-state-item-count">630</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://lanlan2017.github.io/todo/" title="todo → https:&#x2F;&#x2F;lanlan2017.github.io&#x2F;todo&#x2F;"><i class="fa fa-check-square fa-fw"></i>todo</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://lanlan2017.github.io/links/" title="links → https:&#x2F;&#x2F;lanlan2017.github.io&#x2F;links&#x2F;"><i class="fa fa-link fa-fw"></i>links</a>
      </span>
  </div>
  <div class="cc-license site-overview-item animated" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" class="cc-opacity" rel="noopener" target="_blank"><img src="https://cdn.jsdelivr.net/npm/@creativecommons/vocabulary@2020.11.3/assets/license_badges/small/by_nc_sa.svg" alt="Creative Commons"></a>
  </div>



        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="返回顶部">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="reading-progress-bar"></div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://lanlan2017.github.io/JavaReadingNotes/748f82f1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/JavaReadingNotes/images/avatar.gif">
      <meta itemprop="name" content="蓝蓝">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="蓝蓝站点">
      <meta itemprop="description" content="好好学习，天天向上">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 蓝蓝站点">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/JavaReadingNotes/748f82f1/" class="post-title-link" itemprop="url">8.8 操作集合的工具类Collections 8.8.1 排序操作</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2019-07-11 23:03:19" itemprop="dateCreated datePublished" datetime="2019-07-11T23:03:19+08:00">2019-07-11</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2020-03-09 10:34:04" itemprop="dateModified" datetime="2020-03-09T10:34:04+08:00">2020-03-09</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JavaReadingNotes/categories/1-%E7%96%AF%E7%8B%82Java%E8%AE%B2%E4%B9%89-%E7%AC%AC4%E7%89%88/" itemprop="url" rel="index"><span itemprop="name">1 疯狂Java讲义 (第4版)</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JavaReadingNotes/categories/1-%E7%96%AF%E7%8B%82Java%E8%AE%B2%E4%B9%89-%E7%AC%AC4%E7%89%88/%E7%AC%AC8%E7%AB%A0-Java%E9%9B%86%E5%90%88/" itemprop="url" rel="index"><span itemprop="name">第8章 Java集合</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JavaReadingNotes/categories/1-%E7%96%AF%E7%8B%82Java%E8%AE%B2%E4%B9%89-%E7%AC%AC4%E7%89%88/%E7%AC%AC8%E7%AB%A0-Java%E9%9B%86%E5%90%88/8-8-%E6%93%8D%E4%BD%9C%E9%9B%86%E5%90%88%E7%9A%84%E5%B7%A5%E5%85%B7%E7%B1%BBCollections/" itemprop="url" rel="index"><span itemprop="name">8.8 操作集合的工具类Collections</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
    <span class="post-meta-item-icon">
      <i class="far fa-comment"></i>
    </span>
    <span class="post-meta-item-text">Waline：</span>
  
    <a title="waline" href="/JavaReadingNotes/748f82f1/#waline-comments" itemprop="discussionUrl">
      <span class="post-comments-count waline-comment-count" id="/JavaReadingNotes/748f82f1/" data-xid="/JavaReadingNotes/748f82f1/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>1.4k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>1 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="8-8-操作集合的工具类Collections"><a href="#8-8-操作集合的工具类Collections" class="headerlink" title="8.8 操作集合的工具类Collections"></a>8.8 操作集合的工具类Collections</h1><h2 id="Collections提供了什么功能"><a href="#Collections提供了什么功能" class="headerlink" title="Collections提供了什么功能"></a>Collections提供了什么功能</h2><p><code>Java</code>提供了一个操作<code>Set</code>、<code>List</code>和<code>Map</code>等集合的工具类：<code>Collections</code>,该工具类里提供了大量方法对集合元素进行<strong>排序</strong>、<strong>查询</strong>和<strong>修改</strong>等操作,还提供了<strong>将集合对象设置为不可变</strong>、<strong>对集合对象实现同步控制</strong>等方法。</p>
<h1 id="8-8-1-排序操作"><a href="#8-8-1-排序操作" class="headerlink" title="8.8.1 排序操作"></a>8.8.1 排序操作</h1><h2 id="常用排序方法"><a href="#常用排序方法" class="headerlink" title="常用排序方法"></a>常用排序方法</h2><p><code>Collections</code>提供了如下常用的类方法用于对<code>List</code>集合元素进行排序。</p>
<table>
<thead>
<tr>
<th align="left">方法</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>static void reverse(List&lt;?&gt; list)</code></td>
<td align="left"><strong>反转方法</strong>：反转指定<code>List</code>集合中元素的顺序。</td>
</tr>
<tr>
<td align="left"><code>static void shuffle(List&lt;?&gt; list)</code></td>
<td align="left"><strong>随机打乱方法</strong>：对<code>List</code>集合元素进行随机排序(<code>shuffle</code>方法模拟了“洗牌”动作)。</td>
</tr>
<tr>
<td align="left"><code>static &lt;T extends Comparable&lt;? super T&gt;&gt; void sort(List&lt;T&gt; list)</code></td>
<td align="left"><strong>自然升序排序方法</strong>：根据元素的<code>自然顺序</code>对指定<code>List</code>集合的元素<code>按升序进行排序</code>。</td>
</tr>
<tr>
<td align="left"><code>static &lt;T&gt; void sort(List&lt;T&gt; list, Comparator&lt;? super T&gt; c)</code></td>
<td align="left"><strong>定制排序方法</strong>：根据指定<code>Comparator</code>产生的顺序对<code>List</code>集合元素进行排序。</td>
</tr>
<tr>
<td align="left"><code>static void swap(List&lt;?&gt; list, int i, int j)</code></td>
<td align="left">交换两个元素的方法：将指定<code>List</code>集合中的i处元素和j处元素进行交换。</td>
</tr>
<tr>
<td align="left"><code>static void rotate(List&lt;?&gt; list, int distance)</code></td>
<td align="left"><strong>循环移动方法</strong>,<ul class='ul_in_table'><li>当<code>distance</code>为正数时,将<code>list</code>集合的后<code>distance</code>个元素“整体”移到前面;</li><li>当<code>distance</code>为负数时,将<code>list</code>集合的前<code>distance</code>个元素“整体”移到后面。</li></ul>该方法不会改变集合的长度。</td>
</tr>
</tbody></table>
<h2 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h2><p>下面程序简单示范了利用<code>Collections</code>工具类来操作<code>List</code>集合。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SortTest</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">ArrayList</span> <span class="variable">nums</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ArrayList</span>();</span><br><span class="line">        nums.add(<span class="number">2</span>);</span><br><span class="line">        nums.add(-<span class="number">5</span>);</span><br><span class="line">        nums.add(<span class="number">3</span>);</span><br><span class="line">        nums.add(<span class="number">0</span>);</span><br><span class="line">        <span class="comment">// 输出:[2, -5, 3, 0]</span></span><br><span class="line">        System.out.println(nums); </span><br><span class="line">        <span class="comment">// 将List集合元素的次序反转</span></span><br><span class="line">        Collections.reverse(nums); </span><br><span class="line">        <span class="comment">// 输出:[0, 3, -5, 2]</span></span><br><span class="line">        System.out.println(nums); </span><br><span class="line">        <span class="comment">// 将List集合元素的按自然顺序排序</span></span><br><span class="line">        Collections.sort(nums); </span><br><span class="line">        <span class="comment">// 输出:[-5, 0, 2, 3]</span></span><br><span class="line">        System.out.println(nums); </span><br><span class="line">        <span class="comment">// 将List集合元素的按随机顺序排序</span></span><br><span class="line">        Collections.shuffle(nums); </span><br><span class="line">        <span class="comment">// 每次输出的次序不固定</span></span><br><span class="line">        System.out.println(nums); </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>一次运行效果如下:</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">2</span>, -<span class="number">5</span>, <span class="number">3</span>, <span class="number">0</span>]</span><br><span class="line">[<span class="number">0</span>, <span class="number">3</span>, -<span class="number">5</span>, <span class="number">2</span>]</span><br><span class="line">[-<span class="number">5</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line">[<span class="number">3</span>, -<span class="number">5</span>, <span class="number">2</span>, <span class="number">0</span>]</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://lanlan2017.github.io/JavaReadingNotes/7de181a0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/JavaReadingNotes/images/avatar.gif">
      <meta itemprop="name" content="蓝蓝">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="蓝蓝站点">
      <meta itemprop="description" content="好好学习，天天向上">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 蓝蓝站点">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/JavaReadingNotes/7de181a0/" class="post-title-link" itemprop="url">8.7 HashSet和HashMap的性能选项</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2019-07-11 22:35:17" itemprop="dateCreated datePublished" datetime="2019-07-11T22:35:17+08:00">2019-07-11</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2020-03-09 10:34:04" itemprop="dateModified" datetime="2020-03-09T10:34:04+08:00">2020-03-09</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JavaReadingNotes/categories/1-%E7%96%AF%E7%8B%82Java%E8%AE%B2%E4%B9%89-%E7%AC%AC4%E7%89%88/" itemprop="url" rel="index"><span itemprop="name">1 疯狂Java讲义 (第4版)</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JavaReadingNotes/categories/1-%E7%96%AF%E7%8B%82Java%E8%AE%B2%E4%B9%89-%E7%AC%AC4%E7%89%88/%E7%AC%AC8%E7%AB%A0-Java%E9%9B%86%E5%90%88/" itemprop="url" rel="index"><span itemprop="name">第8章 Java集合</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JavaReadingNotes/categories/1-%E7%96%AF%E7%8B%82Java%E8%AE%B2%E4%B9%89-%E7%AC%AC4%E7%89%88/%E7%AC%AC8%E7%AB%A0-Java%E9%9B%86%E5%90%88/8-7-HashSet%E5%92%8CHashMap%E7%9A%84%E6%80%A7%E8%83%BD%E9%80%89%E9%A1%B9/" itemprop="url" rel="index"><span itemprop="name">8.7 HashSet和HashMap的性能选项</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
    <span class="post-meta-item-icon">
      <i class="far fa-comment"></i>
    </span>
    <span class="post-meta-item-text">Waline：</span>
  
    <a title="waline" href="/JavaReadingNotes/7de181a0/#waline-comments" itemprop="discussionUrl">
      <span class="post-comments-count waline-comment-count" id="/JavaReadingNotes/7de181a0/" data-xid="/JavaReadingNotes/7de181a0/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>1.4k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>1 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="8-7-HashSet和HashMap的性能选项"><a href="#8-7-HashSet和HashMap的性能选项" class="headerlink" title="8.7 HashSet和HashMap的性能选项"></a>8.7 HashSet和HashMap的性能选项</h1><p>对于<code>HashSet</code>及其子类而言,它们<strong>采用<code>hash</code>算法来决定集合中元素的存储位置</strong>,并通过<code>hash</code>算法来控制集合的大小;<br>对于<code>HashMap</code>、<code>Hashtable</code>及其子类而言,它们采用<code>hash</code>算法来决定<code>Map</code>中<code>key</code>的存储,并通过<code>hash</code>算法来增加<code>key</code>集合的大小。</p>
<h2 id="hash存储示意图"><a href="#hash存储示意图" class="headerlink" title="hash存储示意图"></a>hash存储示意图</h2><p><code>hash</code>表里可以存储元素的位置被称为”桶(<code>bucket</code>)”,在通常情况下,单个”桶”里存储一个元素,此时有最好的性能:<br><code>hash</code>算法可以根据<code>hashCode</code>值计算出”桶”的存储位置,接着从”桶”中取出元素。但<code>hash</code>表的状态是<code>open</code>的:在发生”<code>hash</code>冲突”的情况下,单个桶会存储多个元素,这些元素以<code>链表</code>形式存储,必须按顺序搜索。如图8.8所示是<code>hash</code>表保存各元素,且发生”<code>hash</code>冲突”的示意图。<br><img data-src="https://image-1257720033.cos.ap-shanghai.myqcloud.com/blog/readbooknote/fangkuangJavaJiangYi3/8/6.png" alt="这里有一张图片"></p>
<h2 id="hash表中的属性"><a href="#hash表中的属性" class="headerlink" title="hash表中的属性"></a>hash表中的属性</h2><p>因为<code>HashSet</code>和<code>HashMap</code>、<code>Hashtable</code>都使用<code>hash</code>算法来决定其元素(<code>HashMap</code>则只考虑<code>key)</code>的存储,因此<code>HashSet</code>、<code>HashMap</code>的<code>hash</code>表包含如下属性:</p>
<table>
<thead>
<tr>
<th align="left">hash表属性</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left">容量(<code>capacity</code>)</td>
<td align="left"><code>hash</code>表中桶的数量。</td>
</tr>
<tr>
<td align="left">初始化容量(<code>initial capacity</code>)</td>
<td align="left">创建<code>hash</code>表时桶的数量。<code>HashMap</code>和<code>HashSet</code>都允许在构造器中指定初始化容量</td>
</tr>
<tr>
<td align="left">尺寸(<code>size</code>)</td>
<td align="left">当前<code>hash</code>表中记录的数量。</td>
</tr>
<tr>
<td align="left">负载因子(<code>load factor)</code></td>
<td align="left">负载因子等于”<code>size除以capacity</code>“。<ul><li>负载因子为0,表示空的<code>hash</code>表,</li><li>负载因子为<code>0.5</code>表示半满的<code>hash</code>表,依此类推。</li></ul>轻负载的<code>hash</code>表具有<code>冲突少</code>、<code>适宜插入</code>与<code>查询</code>的特点(但是使用<code>Iterator</code>迭代元素时比较慢)。</td>
</tr>
</tbody></table>
<h3 id="负载极限"><a href="#负载极限" class="headerlink" title="负载极限"></a>负载极限</h3><p>除此之外,<code>hash</code>表里还有一个”负载极限”,”负载极限”是一个0到1的数值,”负载极限”决定了<code>hash</code>表的最大填满程度。当<code>hash</code>表中的负载因子达到指定的”负载极限”时,<code>hash</code>表会自动<strong>成倍</strong>地增加容量(桶的数量),**并将原有的对象重新分配,放入新的桶内,这称为<code>rehashing</code>**。<br><code>HashSet</code>和<code>HashMap</code>、<code>Hashtable</code>的构造器允许指定一个负载极限,<code>HashSet</code>和<code>HashMap</code>、<code>Hashtable</code>默认的”负载极限”为<code>0.75</code>,这表明默认情况下,当该<code>hash</code>表的<code>4分之3</code>已经被填满时,<code>hash</code>表会发生<code>rehashing</code>。</p>
<h3 id="负载极限如何取舍"><a href="#负载极限如何取舍" class="headerlink" title="负载极限如何取舍"></a>负载极限如何取舍</h3><p>“负载极限”的默认值(0.75)是时间和空间成本上的一种折中:<br>较高的”负载极限”可以降低<code>hash</code>表所占用的内存空间,但会增加查询数据的时间开销,而<code>查询是最频繁的操作</code>(<code>HashMa</code>的<code>get()</code>与<code>put()</code>方法都要用到查询);<br>较低的”负载极限”会提高查询数据的性能,但会增加<code>hash</code>表所占用的内存开销。</p>
<p>程序员可以根据实际情况来调整<code>HashSet</code>和<code>HashMap</code>的”负载极限”值</p>
<p>如果开始就知道<code>HashSet</code>和<code>HashMap</code>、<code>Hashtable</code>会保存很多记录,则可以<code>在创建时就使用较大的初始化容量</code>,如果初始化容量始终大于<code>HashSet</code>和<code>HashMap</code>、<code>Hashtable</code>所包含的最大记录数除以”负载极限”,就不会发生<code>rehashing</code>。使用足够大的初始化容量创建<code>HashSet</code>和<code>HashMap</code>、<code>Hashtable</code>时,可以更高效地增加记录,但将初始化容量设置太高可能会浪费空间,因此通常不要将初始化容量设置得过高。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://lanlan2017.github.io/JavaReadingNotes/9d572b77/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/JavaReadingNotes/images/avatar.gif">
      <meta itemprop="name" content="蓝蓝">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="蓝蓝站点">
      <meta itemprop="description" content="好好学习，天天向上">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 蓝蓝站点">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/JavaReadingNotes/9d572b77/" class="post-title-link" itemprop="url">8.6.9 各Map实现类的性能分析</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2019-07-11 22:25:44" itemprop="dateCreated datePublished" datetime="2019-07-11T22:25:44+08:00">2019-07-11</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2020-03-09 10:34:04" itemprop="dateModified" datetime="2020-03-09T10:34:04+08:00">2020-03-09</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JavaReadingNotes/categories/1-%E7%96%AF%E7%8B%82Java%E8%AE%B2%E4%B9%89-%E7%AC%AC4%E7%89%88/" itemprop="url" rel="index"><span itemprop="name">1 疯狂Java讲义 (第4版)</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JavaReadingNotes/categories/1-%E7%96%AF%E7%8B%82Java%E8%AE%B2%E4%B9%89-%E7%AC%AC4%E7%89%88/%E7%AC%AC8%E7%AB%A0-Java%E9%9B%86%E5%90%88/" itemprop="url" rel="index"><span itemprop="name">第8章 Java集合</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JavaReadingNotes/categories/1-%E7%96%AF%E7%8B%82Java%E8%AE%B2%E4%B9%89-%E7%AC%AC4%E7%89%88/%E7%AC%AC8%E7%AB%A0-Java%E9%9B%86%E5%90%88/8-6-Java-8%E5%A2%9E%E5%BC%BA%E7%9A%84Map%E9%9B%86%E5%90%88/" itemprop="url" rel="index"><span itemprop="name">8.6 Java 8增强的Map集合</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
    <span class="post-meta-item-icon">
      <i class="far fa-comment"></i>
    </span>
    <span class="post-meta-item-text">Waline：</span>
  
    <a title="waline" href="/JavaReadingNotes/9d572b77/#waline-comments" itemprop="discussionUrl">
      <span class="post-comments-count waline-comment-count" id="/JavaReadingNotes/9d572b77/" data-xid="/JavaReadingNotes/9d572b77/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>841</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>1 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="8-6-9-各Map实现类的性能分析"><a href="#8-6-9-各Map实现类的性能分析" class="headerlink" title="8.6.9 各Map实现类的性能分析"></a>8.6.9 各Map实现类的性能分析</h1><h2 id="Hashtable比HashMap慢"><a href="#Hashtable比HashMap慢" class="headerlink" title="Hashtable比HashMap慢"></a>Hashtable比HashMap慢</h2><p>对于<code>Map</code>的常用实现类而言,虽然<code>HashMap</code>和<code>Hashtable</code>的实现机制几乎一样,但由于<code>Hashtable</code>是一个古老的、线程安全的集合,因此<code>HashMap</code>通常比<code>Hashtable</code>要快。</p>
<h2 id="TreeMap比Hashtable慢"><a href="#TreeMap比Hashtable慢" class="headerlink" title="TreeMap比Hashtable慢"></a>TreeMap比Hashtable慢</h2><p><code>TreeMap</code>通常比<code>HashMap</code>、 <code>Hashtable</code>要慢(尤其在插入、删除<code>key-value</code>对时更慢),因为<code>TreeMap</code>采用<code>红黑树</code>来管理<code>key-value</code>对(红黑树的每个节点就是一个<code>key-value</code>对)。</p>
<h2 id="TreeMap会自动排序"><a href="#TreeMap会自动排序" class="headerlink" title="TreeMap会自动排序"></a>TreeMap会自动排序</h2><p>使用<code>TreeMap</code>有一个好处: <code>TreeMap</code>中的<code>key-value</code>对总是处于有序状态,无须专门进行排序操作。</p>
<h3 id="如何快速查找TreeMap中的key"><a href="#如何快速查找TreeMap中的key" class="headerlink" title="如何快速查找TreeMap中的key"></a>如何快速查找TreeMap中的key</h3><ul>
<li>当<code>TreeMap</code>被填充之后,就可以调用<code>keySet()</code>方法,取得由<code>key</code>组成的<code>Set</code>,</li>
<li>然后使用<code>toArray()</code>方法生成<code>key</code>的数组,</li>
<li>接下来使用<code>Arrays</code>类的<code>binarySearch</code>方法就可以在已排序的数组中快速地查询<code>key</code>对象。</li>
</ul>
<h2 id="一般用HashMap"><a href="#一般用HashMap" class="headerlink" title="一般用HashMap"></a>一般用HashMap</h2><p>对于一般的应用场景,程序应该多考虑使用<code>HashMap</code>,因为<code>HashMap</code>正是为<code>快速查询</code>设计的(<code>HashMap</code>底层其实也是采用数组来存储<code>key-value</code>对)。</p>
<h2 id="需要自动排序用TreeMap"><a href="#需要自动排序用TreeMap" class="headerlink" title="需要自动排序用TreeMap"></a>需要自动排序用TreeMap</h2><p>但如果程序需要一个总是排好序的<code>Map</code>时,则可以考虑使用<code>TreeMap</code>.</p>
<h2 id="LinkedHashMap按插入顺序排序"><a href="#LinkedHashMap按插入顺序排序" class="headerlink" title="LinkedHashMap按插入顺序排序"></a>LinkedHashMap按插入顺序排序</h2><p><code>LinkedHashMap</code>比<code>HashMap</code>慢一点,因为它需要维护<strong>链表</strong>来保持<code>Map</code>中<code>key-value</code>时的<strong>添加顺序</strong>。</p>
<h2 id="IdentityHashMap使用-x3D-x3D-判断key是否相等"><a href="#IdentityHashMap使用-x3D-x3D-判断key是否相等" class="headerlink" title="IdentityHashMap使用&#x3D;&#x3D;判断key是否相等"></a>IdentityHashMap使用&#x3D;&#x3D;判断key是否相等</h2><p><code>IdentityHashMap</code>性能没有特别出色之处,因为它釆用与<code>HashMap</code>基本相似的实现,只是它使用<code>==</code>运算符来判断元素相等,而不是使用<code>equals()</code>方法来判断元素相等。</p>
<h2 id="EnumMap只能放入枚举值"><a href="#EnumMap只能放入枚举值" class="headerlink" title="EnumMap只能放入枚举值"></a>EnumMap只能放入枚举值</h2><p><code>EnumMap</code>的性能最好,但它只能使用同一个枚举类的枚举值作为<code>key</code></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://lanlan2017.github.io/JavaReadingNotes/82e01751/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/JavaReadingNotes/images/avatar.gif">
      <meta itemprop="name" content="蓝蓝">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="蓝蓝站点">
      <meta itemprop="description" content="好好学习，天天向上">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 蓝蓝站点">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/JavaReadingNotes/82e01751/" class="post-title-link" itemprop="url">8.6.8 EnumMap实现类</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2019-07-11 22:09:09" itemprop="dateCreated datePublished" datetime="2019-07-11T22:09:09+08:00">2019-07-11</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2020-03-09 10:34:04" itemprop="dateModified" datetime="2020-03-09T10:34:04+08:00">2020-03-09</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JavaReadingNotes/categories/1-%E7%96%AF%E7%8B%82Java%E8%AE%B2%E4%B9%89-%E7%AC%AC4%E7%89%88/" itemprop="url" rel="index"><span itemprop="name">1 疯狂Java讲义 (第4版)</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JavaReadingNotes/categories/1-%E7%96%AF%E7%8B%82Java%E8%AE%B2%E4%B9%89-%E7%AC%AC4%E7%89%88/%E7%AC%AC8%E7%AB%A0-Java%E9%9B%86%E5%90%88/" itemprop="url" rel="index"><span itemprop="name">第8章 Java集合</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JavaReadingNotes/categories/1-%E7%96%AF%E7%8B%82Java%E8%AE%B2%E4%B9%89-%E7%AC%AC4%E7%89%88/%E7%AC%AC8%E7%AB%A0-Java%E9%9B%86%E5%90%88/8-6-Java-8%E5%A2%9E%E5%BC%BA%E7%9A%84Map%E9%9B%86%E5%90%88/" itemprop="url" rel="index"><span itemprop="name">8.6 Java 8增强的Map集合</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
    <span class="post-meta-item-icon">
      <i class="far fa-comment"></i>
    </span>
    <span class="post-meta-item-text">Waline：</span>
  
    <a title="waline" href="/JavaReadingNotes/82e01751/#waline-comments" itemprop="discussionUrl">
      <span class="post-comments-count waline-comment-count" id="/JavaReadingNotes/82e01751/" data-xid="/JavaReadingNotes/82e01751/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>1.2k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>1 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="8-6-8-EnumMap实现类"><a href="#8-6-8-EnumMap实现类" class="headerlink" title="8.6.8 EnumMap实现类"></a>8.6.8 EnumMap实现类</h1><p><code>EnumMap</code>是一个与<strong>枚举类</strong>一起使用的<code>Map</code>实现, <strong><code>EnumMap</code>中的所有<code>key</code>都必须是单个枚举类的枚举值</strong>。创建<code>EnumMap</code>时必须显式或隐式指定它对应的枚举类。 </p>
<h2 id="EnumMap特征"><a href="#EnumMap特征" class="headerlink" title="EnumMap特征"></a>EnumMap特征</h2><p><code>EnumMap</code>具有如下特征:</p>
<h3 id="存储结构-数组"><a href="#存储结构-数组" class="headerlink" title="存储结构 数组"></a>存储结构 数组</h3><p><code>EnumMap</code>在内部以<strong>数组</strong>形式保存,所以这种实现形式非常紧凑、高效</p>
<h3 id="按枚举值的定义顺序排序"><a href="#按枚举值的定义顺序排序" class="headerlink" title="按枚举值的定义顺序排序"></a>按枚举值的定义顺序排序</h3><p><code>EnumMap</code>根据<code>key</code>的自然顺序(即枚举值在枚举类中的定义顺序)来维护<code>key-value</code>对的顺序。当程序通过<code>keySet</code>、 <code>entrySet()</code>、 <code>values()</code>等方法遍历<code>EnumMap</code>时可以看到这种顺序。</p>
<h3 id="key不可以为null-value可以为null"><a href="#key不可以为null-value可以为null" class="headerlink" title="key不可以为null,value可以为null"></a>key不可以为null,value可以为null</h3><p><code>EnumMap</code>**不允许使用<code>null</code>作为<code>key</code>,但允许使用<code>null</code>作为<code>value</code>**。</p>
<ul>
<li>如果试图使用<code>null</code>作为<code>key</code>时将抛出<code>NullPointerException</code>异常。</li>
<li>如果只是查询是否包含值为<code>null</code>的<code>key</code>,或只是删除值为<code>null</code>的<code>key</code>,都不会抛出异常</li>
</ul>
<h2 id="创建EnumMap时必须指定枚举类"><a href="#创建EnumMap时必须指定枚举类" class="headerlink" title="创建EnumMap时必须指定枚举类"></a>创建EnumMap时必须指定枚举类</h2><p>与创建普通的<code>Map</code>有所区别的是,创建<code>EnumMap</code>时必须指定一个枚举类,从而将该<code>EnumMap</code>和指定枚举类关联起来。</p>
<h2 id="程序-EnumMap示例"><a href="#程序-EnumMap示例" class="headerlink" title="程序 EnumMap示例"></a>程序 EnumMap示例</h2><p>下面程序示范了<code>EnumMap</code>的用法。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">enum</span> <span class="title class_">Season</span></span><br><span class="line">&#123;</span><br><span class="line">    SPRING,SUMMER,FALL,WINTER</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EnumMapTest</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// 创建EnumMap对象，该EnumMap的所有key都是Season枚举类的枚举值</span></span><br><span class="line">        <span class="type">EnumMap</span> <span class="variable">enumMap</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">EnumMap</span>(Season.class);</span><br><span class="line">        enumMap.put(Season.SUMMER , <span class="string">&quot;夏日炎炎&quot;</span>);</span><br><span class="line">        enumMap.put(Season.SPRING , <span class="string">&quot;春暖花开&quot;</span>);</span><br><span class="line">        System.out.println(enumMap);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>上面程序中创建了一个<code>EnumMap</code>对象,创建该<code>EnumMap</code>对象时指定它的<code>key</code>只能是<code>Season</code>枚举类的枚举值。如果向该<code>EnumMap</code>中添加两个<code>key-value</code>对后,这两个<code>key-value</code>对将会以<code>Season</code>枚举值的<strong>自然顺序排序</strong>。<br>编译、运行上面程序,看到如下运行结果:</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;SPRING=春暖花开, SUMMER=夏日炎炎&#125;</span><br></pre></td></tr></table></figure>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><ul>
<li>创建<code>EnumMap</code>是就需要传入枚举的<code>class</code>对象</li>
<li><code>EnumMap</code>中的<code>key</code>只能是<code>Season</code>枚举类的枚举值.</li>
<li>放入<code>EnumMap</code>中的枚举值对按其在枚举类中定义的顺序排序</li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://lanlan2017.github.io/JavaReadingNotes/651c1fe/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/JavaReadingNotes/images/avatar.gif">
      <meta itemprop="name" content="蓝蓝">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="蓝蓝站点">
      <meta itemprop="description" content="好好学习，天天向上">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 蓝蓝站点">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/JavaReadingNotes/651c1fe/" class="post-title-link" itemprop="url">8.6.7 IdentityMap实现类</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2019-07-11 21:55:23" itemprop="dateCreated datePublished" datetime="2019-07-11T21:55:23+08:00">2019-07-11</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2020-03-09 10:34:04" itemprop="dateModified" datetime="2020-03-09T10:34:04+08:00">2020-03-09</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JavaReadingNotes/categories/1-%E7%96%AF%E7%8B%82Java%E8%AE%B2%E4%B9%89-%E7%AC%AC4%E7%89%88/" itemprop="url" rel="index"><span itemprop="name">1 疯狂Java讲义 (第4版)</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JavaReadingNotes/categories/1-%E7%96%AF%E7%8B%82Java%E8%AE%B2%E4%B9%89-%E7%AC%AC4%E7%89%88/%E7%AC%AC8%E7%AB%A0-Java%E9%9B%86%E5%90%88/" itemprop="url" rel="index"><span itemprop="name">第8章 Java集合</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JavaReadingNotes/categories/1-%E7%96%AF%E7%8B%82Java%E8%AE%B2%E4%B9%89-%E7%AC%AC4%E7%89%88/%E7%AC%AC8%E7%AB%A0-Java%E9%9B%86%E5%90%88/8-6-Java-8%E5%A2%9E%E5%BC%BA%E7%9A%84Map%E9%9B%86%E5%90%88/" itemprop="url" rel="index"><span itemprop="name">8.6 Java 8增强的Map集合</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
    <span class="post-meta-item-icon">
      <i class="far fa-comment"></i>
    </span>
    <span class="post-meta-item-text">Waline：</span>
  
    <a title="waline" href="/JavaReadingNotes/651c1fe/#waline-comments" itemprop="discussionUrl">
      <span class="post-comments-count waline-comment-count" id="/JavaReadingNotes/651c1fe/" data-xid="/JavaReadingNotes/651c1fe/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>1.5k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>1 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="8-6-7-IdentityMap实现类"><a href="#8-6-7-IdentityMap实现类" class="headerlink" title="8.6.7 IdentityMap实现类"></a>8.6.7 IdentityMap实现类</h1><h2 id="两个key是同一个对象的引用时IdentityMap才认为这两个key相等"><a href="#两个key是同一个对象的引用时IdentityMap才认为这两个key相等" class="headerlink" title="两个key是同一个对象的引用时IdentityMap才认为这两个key相等"></a>两个key是同一个对象的引用时IdentityMap才认为这两个key相等</h2><p><code>IdentityMap</code>这个<code>Map</code>实现类的实现机制与<code>HashMap</code>基本相似,不过,<strong><code>IdentityMap</code>在处理两个<code>key</code>相等时比较独特</strong>:</p>
<ul>
<li>在<code>IdentityHashMap</code>中,当且仅当两个<code>key</code><strong>严格相等</strong>时, <code>IdentityHashMap</code>才认为两个<code>key</code>相等;<ul>
<li>所谓<strong>严格相等</strong>即:<code>key1==key2</code>。也就是说,<strong>只有<code>key1</code>和<code>key2</code>是同一个对象的引用,<code>IdentityHashMap</code>才认为两个<code>key</code>相等</strong>.</li>
</ul>
</li>
</ul>
<h2 id="普通的HashMap通过equals和hashCode来判断相等"><a href="#普通的HashMap通过equals和hashCode来判断相等" class="headerlink" title="普通的HashMap通过equals和hashCode来判断相等"></a>普通的HashMap通过equals和hashCode来判断相等</h2><p>对于普通的<code>HashMap</code>而言,<strong>只要<code>key1</code>和<code>key2</code>通过<code>equals()</code>方法比较返回<code>true</code>,且它们的<code>hashCode</code>值相等</strong>即可。</p>
<h2 id="IdentityHashMap违反了Map的通常规范"><a href="#IdentityHashMap违反了Map的通常规范" class="headerlink" title="IdentityHashMap违反了Map的通常规范"></a>IdentityHashMap违反了Map的通常规范</h2><p><code>IdentityHashMap</code>是一个特殊的<code>Map</code>实现!此类实现<code>Map</code>接口时,它有意<strong>违反了<code>Map</code>的通常规范</strong>: <code>IdentityHashMap</code>要求两个<code>key</code>严格相等时才认为两个<code>key</code>相等。</p>
<h2 id="IdentityHashMap的key和value可以为null"><a href="#IdentityHashMap的key和value可以为null" class="headerlink" title="IdentityHashMap的key和value可以为null"></a>IdentityHashMap的key和value可以为null</h2><p><code>IdentityHashMap</code>提供了与<code>HashMap</code>基本相似的方法,也允许使用<code>null</code>作为<code>key</code>和<code>value</code>。</p>
<h2 id="IdentityHashMap无序"><a href="#IdentityHashMap无序" class="headerlink" title="IdentityHashMap无序"></a>IdentityHashMap无序</h2><p>与<code>HashMap</code>相似: <code>IdentityHashMap</code>也不保证<code>key-value</code>对之间的顺序,更不能保证它们的顺序随时间的推移保持不变。</p>
<h2 id="程序-IdentityHashMap示例"><a href="#程序-IdentityHashMap示例" class="headerlink" title="程序 IdentityHashMap示例"></a>程序 IdentityHashMap示例</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">IdentityHashMapTest</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">IdentityHashMap</span> <span class="variable">ihm</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">IdentityHashMap</span>();</span><br><span class="line">        <span class="comment">// 下面两行代码将会向IdentityHashMap对象中添加两个key-value对</span></span><br><span class="line">        <span class="comment">// 虽然作为key的这两个字符串通过equals()方法比较相等</span></span><br><span class="line">        <span class="comment">// 但不是同一个对象,所以IdentityHashMap认为这两个key不相等,可以添加</span></span><br><span class="line">        ihm.put(<span class="keyword">new</span> <span class="title class_">String</span>(<span class="string">&quot;语文&quot;</span>) , <span class="number">89</span>);</span><br><span class="line">        ihm.put(<span class="keyword">new</span> <span class="title class_">String</span>(<span class="string">&quot;语文&quot;</span>) , <span class="number">78</span>);</span><br><span class="line">        <span class="comment">// 下面两行代码只会向IdentityHashMap对象中添加一个key-value对</span></span><br><span class="line">        <span class="comment">// 字符串直接量只会创建一次,所以这两个对象是同一个对象.</span></span><br><span class="line">        <span class="comment">// IdentityHashMap认为这两个key相等,所以只会添加一次.</span></span><br><span class="line">        ihm.put(<span class="string">&quot;java&quot;</span> , <span class="number">93</span>);</span><br><span class="line">        ihm.put(<span class="string">&quot;java&quot;</span> , <span class="number">98</span>);</span><br><span class="line">        System.out.println(ihm);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>编译、运行上面程序,看到如下运行结果:</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;语文=<span class="number">89</span>, java=<span class="number">98</span>, 语文=<span class="number">78</span>&#125;</span><br></pre></td></tr></table></figure>
<p>上面程序试图向<code>IdentityHashMap</code>对象中添加<strong>4个</strong><code>key-value</code>对,</p>
<ul>
<li>前2个<code>key-value</code>对中的<code>key</code>是新创建的字符串对象,它们通过<code>==</code>运算符比较不相等,所以<code>IdentityHashMap</code>会把它们当成2个<code>key</code>来处理;</li>
<li>后2个<code>key-value</code>对中的<code>key</code>都是<strong>字符串直接量</strong>,而且它们的字符序列完全相同,<code>Java</code>使用常量池来管理字符串直接量,所以它们通过一比较返回<code>true</code>, <code>IdentityHashMap</code>会认为它们是同一个<code>key</code>,因此<strong>只有第一次可以添加成功</strong>。</li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://lanlan2017.github.io/JavaReadingNotes/554c719d/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/JavaReadingNotes/images/avatar.gif">
      <meta itemprop="name" content="蓝蓝">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="蓝蓝站点">
      <meta itemprop="description" content="好好学习，天天向上">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 蓝蓝站点">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/JavaReadingNotes/554c719d/" class="post-title-link" itemprop="url">8.6.6 WeakHashMap实现类</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2019-07-11 21:08:40" itemprop="dateCreated datePublished" datetime="2019-07-11T21:08:40+08:00">2019-07-11</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2020-03-09 10:34:04" itemprop="dateModified" datetime="2020-03-09T10:34:04+08:00">2020-03-09</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JavaReadingNotes/categories/1-%E7%96%AF%E7%8B%82Java%E8%AE%B2%E4%B9%89-%E7%AC%AC4%E7%89%88/" itemprop="url" rel="index"><span itemprop="name">1 疯狂Java讲义 (第4版)</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JavaReadingNotes/categories/1-%E7%96%AF%E7%8B%82Java%E8%AE%B2%E4%B9%89-%E7%AC%AC4%E7%89%88/%E7%AC%AC8%E7%AB%A0-Java%E9%9B%86%E5%90%88/" itemprop="url" rel="index"><span itemprop="name">第8章 Java集合</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JavaReadingNotes/categories/1-%E7%96%AF%E7%8B%82Java%E8%AE%B2%E4%B9%89-%E7%AC%AC4%E7%89%88/%E7%AC%AC8%E7%AB%A0-Java%E9%9B%86%E5%90%88/8-6-Java-8%E5%A2%9E%E5%BC%BA%E7%9A%84Map%E9%9B%86%E5%90%88/" itemprop="url" rel="index"><span itemprop="name">8.6 Java 8增强的Map集合</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
    <span class="post-meta-item-icon">
      <i class="far fa-comment"></i>
    </span>
    <span class="post-meta-item-text">Waline：</span>
  
    <a title="waline" href="/JavaReadingNotes/554c719d/#waline-comments" itemprop="discussionUrl">
      <span class="post-comments-count waline-comment-count" id="/JavaReadingNotes/554c719d/" data-xid="/JavaReadingNotes/554c719d/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>1.5k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>1 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="8-6-6-WeakHashMap实现类"><a href="#8-6-6-WeakHashMap实现类" class="headerlink" title="8.6.6 WeakHashMap实现类"></a>8.6.6 WeakHashMap实现类</h1><p><code>WeakHashMap</code>与<code>HashMap</code>的用法基本相似。</p>
<h2 id="WeakHashMap和HashMap的区别"><a href="#WeakHashMap和HashMap的区别" class="headerlink" title="WeakHashMap和HashMap的区别"></a>WeakHashMap和HashMap的区别</h2><p><code>WeakHashMap</code>与<code>HashMap</code>的区别在于:</p>
<ul>
<li><code>HashMap</code>的<code>key</code>保留了对实际对象的<code>强引用</code>,这意味着:<ul>
<li><strong>只要该<code>HashMap</code>对象不被销毁,该<code>HashMap</code>的所有<code>key</code>所引用的对象就不会被垃圾回收, <code>HashMap</code>也不会自动删除这些<code>key</code>所对应的<code>key-value</code>对</strong>;</li>
</ul>
</li>
<li><code>Weak HashMap</code>的<code>key</code>只保留了对实际对象的<code>弱引用</code>,这意味着:<ul>
<li><strong>如果<code>WeakHashMap</code>对象的<code>key</code>所引用的对象没有被其他强引用变量所引用,则这些<code>key</code>所引用的对象可能被垃圾回收, <code>WeakHashMap</code>也可能自动删除这些<code>key</code>所对应的<code>key-value</code>对</strong>。</li>
</ul>
</li>
</ul>
<h2 id="WeakHashMap特点"><a href="#WeakHashMap特点" class="headerlink" title="WeakHashMap特点"></a>WeakHashMap特点</h2><p><strong><code>WeakHashMap</code>中的每个<code>key</code>对象只持有对实际对象的弱引用,因此,当垃圾回收了该<code>key</code>所对应的实际对象之后, <code>WeakHashMap</code>会自动删除该<code>key</code>对应的<code>key-value</code>对</strong>。</p>
<h2 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h2><p>看如下程序:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WeakHashMapTest</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">WeakHashMap</span> <span class="variable">whm</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">WeakHashMap</span>();</span><br><span class="line">        <span class="comment">// 将WeakHashMap中添加三个key-value对，</span></span><br><span class="line">        <span class="comment">// 三个key都是匿名字符串对象（没有其他引用）</span></span><br><span class="line">        whm.put(<span class="keyword">new</span> <span class="title class_">String</span>(<span class="string">&quot;语文&quot;</span>) , <span class="keyword">new</span> <span class="title class_">String</span>(<span class="string">&quot;良好&quot;</span>));</span><br><span class="line">        whm.put(<span class="keyword">new</span> <span class="title class_">String</span>(<span class="string">&quot;数学&quot;</span>), <span class="keyword">new</span> <span class="title class_">String</span>(<span class="string">&quot;及格&quot;</span>));</span><br><span class="line">        whm.put(<span class="keyword">new</span> <span class="title class_">String</span>(<span class="string">&quot;英文&quot;</span>), <span class="keyword">new</span> <span class="title class_">String</span>(<span class="string">&quot;中等&quot;</span>));</span><br><span class="line">        <span class="comment">// 将 WeakHashMap中添加一个key-value对，</span></span><br><span class="line">        <span class="comment">// 该key是一个系统缓存的字符串对象。</span></span><br><span class="line">        whm.put(<span class="string">&quot;java&quot;</span>, <span class="keyword">new</span> <span class="title class_">String</span>(<span class="string">&quot;中等&quot;</span>));  / ①</span><br><span class="line">        <span class="comment">// 输出whm对象，将看到4个key-value对。</span></span><br><span class="line">        System.out.println(whm);</span><br><span class="line">        <span class="comment">// 通知系统立即进行垃圾回收</span></span><br><span class="line">        System.gc();</span><br><span class="line">        System.runFinalization();</span><br><span class="line">        <span class="comment">// 通常情况下，将只看到一个key-value对。</span></span><br><span class="line">        System.out.println(whm);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>编译、运行上面程序,看到如下运行结果:</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;英文=中等, java=中等, 数学=及格, 语文=良好&#125;</span><br><span class="line">&#123;java=中等&#125;</span><br></pre></td></tr></table></figure>
<p>从上面运行结果可以看出,当系统进行垃圾回收时,删除了<code>WeakHashMap</code>对象的前三个<code>key- value</code>对。这是因为添加前三个<code>key- value</code>对时,这三个<code>key</code>都是<strong>匿名的字符串对象</strong>,<code>WeakHashMap</code>只保留了对它们的<code>弱引用</code>,这样垃圾回收时会自动删除这三个<code>key-value</code>对。<br><code>WeakHashMap</code>对象中第4个组<code>key-value</code>对(第①号代码行)的<code>key</code>(<code>&quot;java&quot;</code>)是一个<strong>字符串直接量</strong>,(系统会自动保留对该字符串对象的<code>强引用</code>),所以垃圾回收时不会回收它.</p>
<h2 id="使用WeakHashMap要注意什么"><a href="#使用WeakHashMap要注意什么" class="headerlink" title="使用WeakHashMap要注意什么"></a>使用WeakHashMap要注意什么</h2><p>如果需要使用<code>WeakHashMap</code>的<code>key</code>来保留对象的弱引用,则<strong>不要让该<code>key</code>所引用的象具有任何强引用,否则将失去使用<code>WeakHashMap</code>的意义</strong></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://lanlan2017.github.io/JavaReadingNotes/50672106/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/JavaReadingNotes/images/avatar.gif">
      <meta itemprop="name" content="蓝蓝">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="蓝蓝站点">
      <meta itemprop="description" content="好好学习，天天向上">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 蓝蓝站点">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/JavaReadingNotes/50672106/" class="post-title-link" itemprop="url">8.6.5 SortedMap接口和TreeMap实现类</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2019-07-11 18:16:53" itemprop="dateCreated datePublished" datetime="2019-07-11T18:16:53+08:00">2019-07-11</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2020-03-09 10:34:04" itemprop="dateModified" datetime="2020-03-09T10:34:04+08:00">2020-03-09</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JavaReadingNotes/categories/1-%E7%96%AF%E7%8B%82Java%E8%AE%B2%E4%B9%89-%E7%AC%AC4%E7%89%88/" itemprop="url" rel="index"><span itemprop="name">1 疯狂Java讲义 (第4版)</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JavaReadingNotes/categories/1-%E7%96%AF%E7%8B%82Java%E8%AE%B2%E4%B9%89-%E7%AC%AC4%E7%89%88/%E7%AC%AC8%E7%AB%A0-Java%E9%9B%86%E5%90%88/" itemprop="url" rel="index"><span itemprop="name">第8章 Java集合</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JavaReadingNotes/categories/1-%E7%96%AF%E7%8B%82Java%E8%AE%B2%E4%B9%89-%E7%AC%AC4%E7%89%88/%E7%AC%AC8%E7%AB%A0-Java%E9%9B%86%E5%90%88/8-6-Java-8%E5%A2%9E%E5%BC%BA%E7%9A%84Map%E9%9B%86%E5%90%88/" itemprop="url" rel="index"><span itemprop="name">8.6 Java 8增强的Map集合</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
    <span class="post-meta-item-icon">
      <i class="far fa-comment"></i>
    </span>
    <span class="post-meta-item-text">Waline：</span>
  
    <a title="waline" href="/JavaReadingNotes/50672106/#waline-comments" itemprop="discussionUrl">
      <span class="post-comments-count waline-comment-count" id="/JavaReadingNotes/50672106/" data-xid="/JavaReadingNotes/50672106/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>4.5k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>4 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="8-6-5-SortedMap接口和TreeMap实现类"><a href="#8-6-5-SortedMap接口和TreeMap实现类" class="headerlink" title="8.6.5 SortedMap接口和TreeMap实现类"></a>8.6.5 SortedMap接口和TreeMap实现类</h1><p>正如<code>Set</code>接口派生出<code>SortedSet</code>子接口有一个<code>TreeSet</code>实现类一样,<code>Map</code>接口也派生的<code>SortedMap</code>子接口也有一个<code>TreeMap</code>实现类.</p>
<h2 id="TreeMap数据结构-红黑树"><a href="#TreeMap数据结构-红黑树" class="headerlink" title="TreeMap数据结构 红黑树"></a>TreeMap数据结构 红黑树</h2><p><code>TreeMap</code>就是一个<code>红黑树</code>数据结构,每个<code>key-value</code>对即作为红黑树的一个节点。 <code>TreeMap</code>存储<code>key-value</code>对(节点)时,需要根据<code>key</code>对节点进行排序。 <strong><code>TreeMap</code>可以保证所有的<code>key-value</code>对处于有序状态</strong>。 </p>
<h2 id="自然排序-定制排序"><a href="#自然排序-定制排序" class="headerlink" title="自然排序 定制排序"></a>自然排序 定制排序</h2><p><code>TreeMap</code>也有两种排序方式:</p>
<ul>
<li><strong>自然排序</strong>:<code>TreeMap</code>的所有<code>key</code>必须实现<code>Comparable</code>接口,而且所有的<code>key</code>应该是同一个类的对象,否则将会抛出<code>ClassCastException</code>异常。</li>
<li><strong>定制排序</strong>:创建<code>TreeMap</code>时,传入一个<code>Comparator</code>对象,该对象负责对<code>TreeMap</code>中的所有<code>key</code>进行排序。采用定制排序时不要求<code>Map</code>的<code>key</code>实现<code>Comparable</code>接口。</li>
</ul>
<h2 id="TreeMap判断两个key相等的标准"><a href="#TreeMap判断两个key相等的标准" class="headerlink" title="TreeMap判断两个key相等的标准"></a>TreeMap判断两个key相等的标准</h2><p>类似于<code>TreeSet</code>中判断两个元素相等的标准, <code>TreeMap</code>中判断两个<code>key</code>相等的标准是:<br><strong>如果两个<code>key</code>通过<code>compareTo()</code>方法返回<code>0</code>, 那么<code>TreeMap</code>就认为这两个<code>key</code>是相等的</strong>。</p>
<h2 id="理解Comparable接口的compareTo方法"><a href="#理解Comparable接口的compareTo方法" class="headerlink" title="理解Comparable接口的compareTo方法"></a>理解Comparable接口的compareTo方法</h2><ul>
<li>如果<code>对象.compareTo(参数)</code>返回<strong>0</strong>,则表示该对象和参数相等.</li>
<li>如果<code>对象.compareTo(参数)</code>返回<strong>正数</strong>,则表示该对象大于参数.</li>
<li>如果<code>对象.compareTo(参数)</code>返回<strong>负数</strong>,则表示该对象小于参数.</li>
</ul>
<p>为了便于记忆可以把<code>Comparable</code>接口的<code>compareTo</code>方法理解为<code>减去</code>的意思,也就是说<code>对象.compareTo(参数)</code>意思为<code>对象减去参数</code>.</p>
<ul>
<li>如果对象减去参数等于<code>0</code>,则两者相等.</li>
<li>如果对象减去参数大于0,则对象大于参数,</li>
<li>如果对象减去参数小于0则对象小于参数。</li>
</ul>
<h2 id="理解Comparator接口的compare方法"><a href="#理解Comparator接口的compare方法" class="headerlink" title="理解Comparator接口的compare方法"></a>理解Comparator接口的compare方法</h2><p>同样的<code>Comparator</code>接口的<code>compare(参数1,参数2)</code>可以理解为<code>前面的参数减去后面的参数</code>的计算结果.也就是<strong>参数1<code>减去</code>参数2</strong>,所以:</p>
<ul>
<li>如果参数1减去参数2等于0时,两者相等,</li>
<li>如果参数1减去参数2大于0,则参数1大于参数2,</li>
<li>如果参数1减去参数2小于0,则参数1小于参数2.</li>
</ul>
<h2 id="作为key的自定义类的要求"><a href="#作为key的自定义类的要求" class="headerlink" title="作为key的自定义类的要求"></a>作为key的自定义类的要求</h2><p>如果使用自定义类作为<code>TreeMap</code>的<code>key</code>,且想让<code>TreeMap</code>良好地工作,则重写该类的<code>equals()</code>方法和<code>compareTo()</code>方法时应保持一致的返回结果:<br>**两个<code>key</code>通过<code>equals</code>方法比较返回<code>true</code>时,它们通过<code>compareTo()</code>方法比较应该返回<code>0</code>**。如果<code>equals()</code>方法与<code>compareTo()</code>方法的返回结果不一致, <code>TreeMap</code>与<code>Map</code>接口的规则就会冲突。</p>
<h2 id="Java使用Map来实现的Set"><a href="#Java使用Map来实现的Set" class="headerlink" title="Java使用Map来实现的Set"></a>Java使用Map来实现的Set</h2><p>再次强调:<code>Set</code>和<code>Map</code>的关系十分密切,<code>Java</code>源码就是先实现了<code>HashMap</code>、<code>TreeMap</code>等集合,然后通过包装一个所有的<code>value</code>都为<code>null</code>的<code>Map</code>集合实现了<code>Set</code>集合类。</p>
<h2 id="Set和Map的关系"><a href="#Set和Map的关系" class="headerlink" title="Set和Map的关系"></a>Set和Map的关系</h2><p>再次强调:<code>Set</code>和<code>Map</code>的关系十分密切,<code>Java</code>源码就是先实现了<code>HashMap</code>、 <code>TreeMap</code>等集合,然后<strong>通过包装一个所有的<code>value</code>都为<code>null</code>的<code>Map</code>集合来实现<code>Set</code>集合类</strong>。</p>
<h2 id="返回key或Entry的方法"><a href="#返回key或Entry的方法" class="headerlink" title="返回key或Entry的方法"></a>返回key或Entry的方法</h2><p>与<code>TreeSet</code>类似的是, <code>TreeMap</code>中也提供了一系列根据<code>key</code>顺序访问<code>key-value</code>对的方法。</p>
<h3 id="查找最大最小的key"><a href="#查找最大最小的key" class="headerlink" title="查找最大最小的key"></a>查找最大最小的key</h3><table>
<thead>
<tr>
<th align="left">方法</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>K firstKey()</code></td>
<td align="left">返回该<code>Map</code>中的最小<code>key</code>值,如果该<code>Map</code>为空,则返回<code>null</code>。</td>
</tr>
<tr>
<td align="left"><code>K lastKey()</code></td>
<td align="left">返回该<code>Map</code>中的最大<code>key</code>值,如果该<code>Map</code>为空或不存在这样的<code>key</code>,则都返回<code>null</code>。</td>
</tr>
</tbody></table>
<h3 id="查找给定key的前一个或后一个key"><a href="#查找给定key的前一个或后一个key" class="headerlink" title="查找给定key的前一个或后一个key"></a>查找给定key的前一个或后一个key</h3><table>
<thead>
<tr>
<th align="left">方法</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>K higherKey(K key)</code></td>
<td align="left">返回该<code>Map</code>中大于参数<code>key</code>的最小<code>key</code>值。如果该<code>Map</code>为空或不存在这样的<code>key-value</code>对,则都返回<code>null</code>。</td>
</tr>
<tr>
<td align="left"><code>K lowerKey(K key)</code></td>
<td align="left">返回该<code>Map</code>中小于参数<code>key</code>的最大<code>key</code>值。如果该<code>Map</code>为空或不存在这样的<code>key</code>,则都返回<code>null</code></td>
</tr>
</tbody></table>
<h3 id="查找最大最小key对应的Entry"><a href="#查找最大最小key对应的Entry" class="headerlink" title="查找最大最小key对应的Entry"></a>查找最大最小key对应的Entry</h3><table>
<thead>
<tr>
<th align="left">方法</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>Map.Entry&lt;K,​V&gt; firstEntry()</code></td>
<td align="left">返回该<code>Map</code>中最小<code>key</code>所对应的<code>key-value</code>对,如果该<code>Map</code>为空,则返回<code>null</code>。</td>
</tr>
<tr>
<td align="left"><code>Map.Entry&lt;K,​V&gt; lastEntry()</code></td>
<td align="left">返回该<code>Map</code>中最大<code>key</code>所对应的 <code>key-value</code>对,如果该<code>Map</code>为空或不存在这样的<code>key-value</code>对,则都返回<code>null</code>。</td>
</tr>
</tbody></table>
<h3 id="查找给定key的前一个或后一个key对应的Entry"><a href="#查找给定key的前一个或后一个key对应的Entry" class="headerlink" title="查找给定key的前一个或后一个key对应的Entry"></a>查找给定key的前一个或后一个key对应的Entry</h3><table>
<thead>
<tr>
<th align="left">方法</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>Map.Entry&lt;K,​V&gt; higherEntry(K key)</code></td>
<td align="left">返回该<code>Map</code>中大于参数<code>key</code>的最小<code>key</code>所对应的<code>key-value</code>对。如果该<code>Map</code>为空,则返回<code>null</code>。</td>
</tr>
<tr>
<td align="left"><code>Map.Entry&lt;K,​V&gt; lowerEntry(K key)</code></td>
<td align="left">返回该<code>Map</code>中小于参数<code>key</code>的最大<code>key</code>所对应的<code>key-value</code>对。如果该<code>Map</code>为空或不存在这样的 <code>key-value</code>对,则都返回<code>null</code></td>
</tr>
</tbody></table>
<h2 id="截取子Map的方法"><a href="#截取子Map的方法" class="headerlink" title="截取子Map的方法"></a>截取子Map的方法</h2><h3 id="截取指定区间"><a href="#截取指定区间" class="headerlink" title="截取指定区间"></a>截取指定区间</h3><table>
<thead>
<tr>
<th align="left">方法</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>SortedMap&lt;K,​V&gt; subMap(K fromKey, K toKey)</code></td>
<td align="left">返回该<code>Map</code>的子<code>Map</code>,其<code>key</code>的范围是从<code>fromKey</code>(包括)到<code>toKey</code>(不包括)。<code>subXXX()</code>方法遵循<code>前闭后开</code>原则。</td>
</tr>
<tr>
<td align="left"><code>NavigableMap&lt;K,​V&gt; subMap(K fromKey, boolean fromInclusive, K toKey, boolean toInclusive)</code></td>
<td align="left">返回该<code>Map</code>的子<code>Map</code>,其<code>key</code>的范围是从 <code>fromKey</code>到<code>toKey</code>,是否包括<code>fromKey</code>取决于第二个参数,是否包括<code>toKey</code>取决于第四个参数.</td>
</tr>
</tbody></table>
<h3 id="向前截取"><a href="#向前截取" class="headerlink" title="向前截取"></a>向前截取</h3><table>
<thead>
<tr>
<th align="left">方法</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>SortedMap&lt;K,​V&gt; headMap(K toKey)</code></td>
<td align="left">返回该<code>Map</code>的子<code>Map</code>,其<code>key</code>的范围是小于<code>toKey</code>的所有<code>key</code>,不包括<code>toKey</code>.</td>
</tr>
<tr>
<td align="left"><code>NavigableMap&lt;K,​V&gt; headMap(K toKey, boolean inclusive)</code></td>
<td align="left">Returns a view of the portion of this map whose keys are less than (or equal to, if inclusive is true) toKey.</td>
</tr>
</tbody></table>
<h3 id="向后截取"><a href="#向后截取" class="headerlink" title="向后截取"></a>向后截取</h3><table>
<thead>
<tr>
<th align="left">方法</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>SortedMap&lt;K,​V&gt; tailMap(K fromKey)</code></td>
<td align="left">返回该<code>Map</code>的子<code>Map</code>,其<code>key</code>的范围是大于<code>fromKey</code>(包括)的所有<code>key</code>。</td>
</tr>
<tr>
<td align="left"><code>NavigableMap&lt;K,​V&gt; tailMap(K fromKey, boolean inclusive)</code></td>
<td align="left">返回该<code>Map</code>的子<code>Map</code>,其<code>key</code>的范围是大于<code>fromKey</code>的所有<code>key</code>,子<code>Map</code>是否包括第一个<code>fromKey</code>取决于第二个参数.</td>
</tr>
</tbody></table>
<p>表面上看起来这些方法很复杂,其实它们很简单。因为<code>TreeMap</code>中的<code>key-value</code>对是有序的,所以增加了访问第一个、最后一个、前一个、后一个、<code>key-value</code>对的方法,并提供了几个从<code>TreeMap</code>中截取子<code>TreeMap</code>的方法。</p>
<h2 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h2><p>下面以自然排序为例,介绍<code>TreeMap</code>的基本用法。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">R</span> <span class="keyword">implements</span> <span class="title class_">Comparable</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> count;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">R</span><span class="params">(<span class="type">int</span> count)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">this</span>.count = count;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;R[count:&quot;</span> + count + <span class="string">&quot;]&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 根据count来判断两个对象是否相等。</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">equals</span><span class="params">(Object obj)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">this</span> == obj)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">if</span> (obj != <span class="literal">null</span> &amp;&amp; obj.getClass() == R.class)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">R</span> <span class="variable">r</span> <span class="operator">=</span> (R)obj;</span><br><span class="line">            <span class="keyword">return</span> r.count == <span class="built_in">this</span>.count;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 根据count属性值来判断两个对象的大小。</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">compareTo</span><span class="params">(Object obj)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">R</span> <span class="variable">r</span> <span class="operator">=</span> (R)obj;</span><br><span class="line">        <span class="keyword">return</span> count &gt; r.count ? <span class="number">1</span> :</span><br><span class="line">            count &lt; r.count ? -<span class="number">1</span> : <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TreeMapTest</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">TreeMap</span> <span class="variable">tm</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TreeMap</span>();</span><br><span class="line">        tm.put(<span class="keyword">new</span> <span class="title class_">R</span>(<span class="number">3</span>) , <span class="string">&quot;轻量级Java EE企业应用实战&quot;</span>);</span><br><span class="line">        tm.put(<span class="keyword">new</span> <span class="title class_">R</span>(-<span class="number">5</span>) , <span class="string">&quot;疯狂Java讲义&quot;</span>);</span><br><span class="line">        tm.put(<span class="keyword">new</span> <span class="title class_">R</span>(<span class="number">9</span>) , <span class="string">&quot;疯狂Android讲义&quot;</span>);</span><br><span class="line">        System.out.println(tm);</span><br><span class="line">        <span class="comment">// 返回该TreeMap的第一个Entry对象</span></span><br><span class="line">        System.out.println(tm.firstEntry());</span><br><span class="line">        <span class="comment">// 返回该TreeMap的最后一个key值</span></span><br><span class="line">        System.out.println(tm.lastKey());</span><br><span class="line">        <span class="comment">// 返回该TreeMap的比new R(2)大的最小key值。</span></span><br><span class="line">        System.out.println(tm.higherKey(<span class="keyword">new</span> <span class="title class_">R</span>(<span class="number">2</span>)));</span><br><span class="line">        <span class="comment">// 返回该TreeMap的比new R(2)小的最大的key-value对。</span></span><br><span class="line">        System.out.println(tm.lowerEntry(<span class="keyword">new</span> <span class="title class_">R</span>(<span class="number">2</span>)));</span><br><span class="line">        <span class="comment">// 返回该TreeMap的子TreeMap</span></span><br><span class="line">        System.out.println(tm.subMap(<span class="keyword">new</span> <span class="title class_">R</span>(-<span class="number">1</span>) , <span class="keyword">new</span> <span class="title class_">R</span>(<span class="number">4</span>)));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>上面程序中定义了一个<code>R</code>类,该类重写了<code>equals</code>方法,并实现了<code>Comparable</code>接口,所以可以使用该R对象作为<code>TreeMap</code>的<code>key</code>,该<code>TreeMap</code>使用自然排序。运行上面程序,看到如下运行结果:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;R[count:-5]=疯狂Java讲义, R[count:3]=轻量级Java EE企业应用实战, R[count:9]=疯狂Android讲义&#125;</span><br><span class="line">R[count:-5]=疯狂Java讲义</span><br><span class="line">R[count:9]</span><br><span class="line">R[count:3]</span><br><span class="line">R[count:-5]=疯狂Java讲义</span><br><span class="line">&#123;R[count:3]=轻量级Java EE企业应用实战&#125;</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://lanlan2017.github.io/JavaReadingNotes/12fdc454/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/JavaReadingNotes/images/avatar.gif">
      <meta itemprop="name" content="蓝蓝">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="蓝蓝站点">
      <meta itemprop="description" content="好好学习，天天向上">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 蓝蓝站点">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/JavaReadingNotes/12fdc454/" class="post-title-link" itemprop="url">8.6.4 使用Properties读写属性文件</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2019-07-11 17:33:19" itemprop="dateCreated datePublished" datetime="2019-07-11T17:33:19+08:00">2019-07-11</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2020-03-09 10:34:04" itemprop="dateModified" datetime="2020-03-09T10:34:04+08:00">2020-03-09</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JavaReadingNotes/categories/1-%E7%96%AF%E7%8B%82Java%E8%AE%B2%E4%B9%89-%E7%AC%AC4%E7%89%88/" itemprop="url" rel="index"><span itemprop="name">1 疯狂Java讲义 (第4版)</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JavaReadingNotes/categories/1-%E7%96%AF%E7%8B%82Java%E8%AE%B2%E4%B9%89-%E7%AC%AC4%E7%89%88/%E7%AC%AC8%E7%AB%A0-Java%E9%9B%86%E5%90%88/" itemprop="url" rel="index"><span itemprop="name">第8章 Java集合</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JavaReadingNotes/categories/1-%E7%96%AF%E7%8B%82Java%E8%AE%B2%E4%B9%89-%E7%AC%AC4%E7%89%88/%E7%AC%AC8%E7%AB%A0-Java%E9%9B%86%E5%90%88/8-6-Java-8%E5%A2%9E%E5%BC%BA%E7%9A%84Map%E9%9B%86%E5%90%88/" itemprop="url" rel="index"><span itemprop="name">8.6 Java 8增强的Map集合</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
    <span class="post-meta-item-icon">
      <i class="far fa-comment"></i>
    </span>
    <span class="post-meta-item-text">Waline：</span>
  
    <a title="waline" href="/JavaReadingNotes/12fdc454/#waline-comments" itemprop="discussionUrl">
      <span class="post-comments-count waline-comment-count" id="/JavaReadingNotes/12fdc454/" data-xid="/JavaReadingNotes/12fdc454/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>4.3k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>4 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="8-6-4-使用Properties读写属性文件"><a href="#8-6-4-使用Properties读写属性文件" class="headerlink" title="8.6.4 使用Properties读写属性文件"></a>8.6.4 使用Properties读写属性文件</h1><p><code>Properties</code>类是<code>Hashtable</code>类的子类,正如它的名字所暗示的,该对象在处理<strong>属性文件</strong>时特别方便( <code>Windows</code>操作平台上的<code>.ini</code>文件就是一种属性文件)。</p>
<h2 id="Properties功能"><a href="#Properties功能" class="headerlink" title="Properties功能"></a>Properties功能</h2><p><strong><code>Properties</code>类可以把<code>Map</code>对象和属性文件关联起来</strong>,从而<strong>可以把<code>Map</code>对象中的<code>key-value</code>对写入属性文件中,也可以把属性文件中的”<code>属性名=属性值</code>“加载到<code>Map</code>对象中</strong>。</p>
<h2 id="key和value都是String"><a href="#key和value都是String" class="headerlink" title="key和value都是String"></a>key和value都是String</h2><p>由于<strong>属性文件里的属性名、属性值只能是<code>字符串</code>类型</strong>,所以<code>Properties</code>里的<code>key</code>、<code>vaue</code>都是字符串类型。所以<code>Properties</code>相当于一个<code>key</code>、<code>value</code>都是<code>String</code>类型的<code>Map</code></p>
<h2 id="Properties类方法"><a href="#Properties类方法" class="headerlink" title="Properties类方法"></a>Properties类方法</h2><h3 id="获取属性值"><a href="#获取属性值" class="headerlink" title="获取属性值"></a>获取属性值</h3><table>
<thead>
<tr>
<th align="left">方法</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>String getProperty(String key)</code></td>
<td align="left">获取<code>Properties</code>中指定属性名对应的属性值,类似于<code>Map</code>的<code>get(Object key)</code>方法。</td>
</tr>
<tr>
<td align="left"><code>String getProperty(String key, String defaultValue)</code></td>
<td align="left">该方法与前一个方法基本相似。该方法多一个功能,如果<code>Properties</code>中不存在指定的<code>key</code>时,则该方法返回第二个参数作为默认值。</td>
</tr>
</tbody></table>
<h3 id="设置属性值"><a href="#设置属性值" class="headerlink" title="设置属性值"></a>设置属性值</h3><table>
<thead>
<tr>
<th align="left">方法</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>Object setProperty(String key, String value)</code></td>
<td align="left">设置属性值,类似于<code>Hashtable</code>的<code>put()</code>方法。</td>
</tr>
</tbody></table>
<h3 id="读取属性文件"><a href="#读取属性文件" class="headerlink" title="读取属性文件"></a>读取属性文件</h3><table>
<thead>
<tr>
<th align="left">方法</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>void load(InputStream inStream)</code></td>
<td align="left">从属性文件(以输入流表示)中加载<code>key-value</code>对,把加载到的<code>key-value</code>对追加到<code>Properties</code>里(<code>Properties</code>是 <code>Hashtable</code>的子类,它不保证<code>key-value</code>对之间的次序)。</td>
</tr>
<tr>
<td align="left"><code>void load(Reader reader)</code></td>
<td align="left">Reads a property list (key and element pairs) from the input character stream in a simple line-oriented format.</td>
</tr>
</tbody></table>
<h3 id="写入属性文件"><a href="#写入属性文件" class="headerlink" title="写入属性文件"></a>写入属性文件</h3><table>
<thead>
<tr>
<th align="left">方法</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>void store(OutputStream out, String comments)</code></td>
<td align="left">将<code>Properties</code>中的<code>key-value</code>对输出到指定的属性文件(以输出流表示)中。</td>
</tr>
<tr>
<td align="left"><code>void store(Writer writer, String comments)</code></td>
<td align="left">Writes this property list (key and element pairs) in this Properties table to the output character stream in a format suitable for using the load(Reader) method.</td>
</tr>
</tbody></table>
<h2 id="实例-Properties读写文件"><a href="#实例-Properties读写文件" class="headerlink" title="实例 Properties读写文件"></a>实例 Properties读写文件</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PropertiesTest</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span></span><br><span class="line">        <span class="keyword">throws</span> Exception</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">Properties</span> <span class="variable">props</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Properties</span>();</span><br><span class="line">        <span class="comment">// 向Properties中增加属性</span></span><br><span class="line">        props.setProperty(<span class="string">&quot;username&quot;</span> , <span class="string">&quot;yeeku&quot;</span>);</span><br><span class="line">        props.setProperty(<span class="string">&quot;password&quot;</span> , <span class="string">&quot;123456&quot;</span>);</span><br><span class="line">        <span class="comment">// 将Properties中的key-value对保存到a.ini文件中</span></span><br><span class="line">        props.store(<span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(<span class="string">&quot;a.ini&quot;</span>)</span><br><span class="line">            , <span class="string">&quot;comment line&quot;</span>);   <span class="comment">//①</span></span><br><span class="line">        <span class="comment">// 新建一个Properties对象</span></span><br><span class="line">        <span class="type">Properties</span> <span class="variable">props2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Properties</span>();</span><br><span class="line">        <span class="comment">// 向Properties中增加属性</span></span><br><span class="line">        props2.setProperty(<span class="string">&quot;gender&quot;</span> , <span class="string">&quot;male&quot;</span>);</span><br><span class="line">        <span class="comment">// 将a.ini文件中的key-value对追加到props2中</span></span><br><span class="line">        props2.load(<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(<span class="string">&quot;a.ini&quot;</span>) );   <span class="comment">//②</span></span><br><span class="line">        System.out.println(props2);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>上面程序示范了<code>Properties</code>类的用法,其中<br>①代码处将<code>Properties</code>对象中的<code>key-value</code>对写入<code>a.ini</code>文件中;<br>②代码处则从<code>a.ini</code>文件中读取<code>key-value</code>对,并添加到<code>props2</code>对象中。<br>编译、运行上面程序,该程序输出结果如下:</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;password=<span class="number">123456</span>, gender=male, username=yeeku&#125;</span><br></pre></td></tr></table></figure>
<p>上面程序还在当前路径下生成了一个<code>a.ini</code>文件,该文件的内容如下:</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#comment line</span><br><span class="line">#Thu Jul <span class="number">11</span> <span class="number">17</span>:<span class="number">42</span>:<span class="number">17</span> CST <span class="number">2019</span></span><br><span class="line">password=<span class="number">123456</span></span><br><span class="line">username=yeeku</span><br></pre></td></tr></table></figure>
<h2 id="读写XML"><a href="#读写XML" class="headerlink" title="读写XML"></a>读写XML</h2><p><code>Properties</code>可以把<code>key-value</code>对以<code>XML</code>文件的形式保存起来,也可以从<code>XML</code>文件中加载<code>key-value</code>对,相关方法如下。</p>
<h3 id="读取XML"><a href="#读取XML" class="headerlink" title="读取XML"></a>读取XML</h3><table>
<thead>
<tr>
<th align="left">方法</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>void loadFromXML(InputStream in)</code></td>
<td align="left">将指定输入流上的<code>XML</code>文档表示的所有属性加载到此<code>Properties</code>表中。</td>
</tr>
</tbody></table>
<h3 id="写入XML"><a href="#写入XML" class="headerlink" title="写入XML"></a>写入XML</h3><table>
<thead>
<tr>
<th align="left">方法</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>void storeToXML(OutputStream os, String comment)</code></td>
<td align="left">把属性表中的键值对保存到到<code>XML</code>文件中</td>
</tr>
<tr>
<td align="left"><code>void storeToXML(OutputStream os, String comment, String encoding)</code></td>
<td align="left">把属性表中的键值对保存到<code>XML</code>文件中,并指定编码</td>
</tr>
<tr>
<td align="left"><code>void storeToXML(OutputStream os, String comment, Charset charset)</code></td>
<td align="left">Emits an XML document representing all of the properties contained in this table, using the specified encoding.</td>
</tr>
</tbody></table>
<h2 id="实例-Properties读写XML"><a href="#实例-Properties读写XML" class="headerlink" title="实例 Properties读写XML"></a>实例 Properties读写XML</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> map.test.properties;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.FileNotFoundException;</span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.InvalidPropertiesFormatException;</span><br><span class="line"><span class="keyword">import</span> java.util.Properties;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PropertiesXMLTest</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">Properties</span> <span class="variable">props</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Properties</span>();</span><br><span class="line">        <span class="comment">// 向Properties中增加属性</span></span><br><span class="line">        props.setProperty(<span class="string">&quot;username&quot;</span>, <span class="string">&quot;yeeku&quot;</span>);</span><br><span class="line">        props.setProperty(<span class="string">&quot;password&quot;</span>, <span class="string">&quot;123456&quot;</span>);</span><br><span class="line">        <span class="comment">// 将Properties中的key-value对保存到a.ini文件中</span></span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        &#123;</span><br><span class="line">            props.storeToXML(<span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(<span class="string">&quot;a.xml&quot;</span>), <span class="string">&quot;这是注释&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (FileNotFoundException e1)</span><br><span class="line">        &#123;</span><br><span class="line">            e1.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e1)</span><br><span class="line">        &#123;</span><br><span class="line">            e1.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 新建一个Properties对象</span></span><br><span class="line">        <span class="type">Properties</span> <span class="variable">props2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Properties</span>();</span><br><span class="line">        <span class="comment">// 向Properties中增加属性</span></span><br><span class="line">        props2.setProperty(<span class="string">&quot;gender&quot;</span>, <span class="string">&quot;male&quot;</span>);</span><br><span class="line">        <span class="comment">// 将a.ini文件中的key-value对追加到props2中</span></span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        &#123;</span><br><span class="line">            props2.loadFromXML(<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(<span class="string">&quot;a.xml&quot;</span>));</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InvalidPropertiesFormatException e)</span><br><span class="line">        &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (FileNotFoundException e)</span><br><span class="line">        &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e)</span><br><span class="line">        &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(props2);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行效果:</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;password=<span class="number">123456</span>, gender=male, username=yeeku&#125;</span><br></pre></td></tr></table></figure>
<p>生成<code>XML</code>文件内容如下:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span> standalone=<span class="string">&quot;no&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">properties</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;http://java.sun.com/dtd/properties.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">comment</span>&gt;</span>这是注释<span class="tag">&lt;/<span class="name">comment</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">entry</span> <span class="attr">key</span>=<span class="string">&quot;password&quot;</span>&gt;</span>123456<span class="tag">&lt;/<span class="name">entry</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">entry</span> <span class="attr">key</span>=<span class="string">&quot;username&quot;</span>&gt;</span>yeeku<span class="tag">&lt;/<span class="name">entry</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://lanlan2017.github.io/JavaReadingNotes/9e27f253/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/JavaReadingNotes/images/avatar.gif">
      <meta itemprop="name" content="蓝蓝">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="蓝蓝站点">
      <meta itemprop="description" content="好好学习，天天向上">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 蓝蓝站点">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/JavaReadingNotes/9e27f253/" class="post-title-link" itemprop="url">8.6.3 LinkedHashMap实现类</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2019-07-10 17:17:57" itemprop="dateCreated datePublished" datetime="2019-07-10T17:17:57+08:00">2019-07-10</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2020-03-09 10:34:04" itemprop="dateModified" datetime="2020-03-09T10:34:04+08:00">2020-03-09</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JavaReadingNotes/categories/1-%E7%96%AF%E7%8B%82Java%E8%AE%B2%E4%B9%89-%E7%AC%AC4%E7%89%88/" itemprop="url" rel="index"><span itemprop="name">1 疯狂Java讲义 (第4版)</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JavaReadingNotes/categories/1-%E7%96%AF%E7%8B%82Java%E8%AE%B2%E4%B9%89-%E7%AC%AC4%E7%89%88/%E7%AC%AC8%E7%AB%A0-Java%E9%9B%86%E5%90%88/" itemprop="url" rel="index"><span itemprop="name">第8章 Java集合</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JavaReadingNotes/categories/1-%E7%96%AF%E7%8B%82Java%E8%AE%B2%E4%B9%89-%E7%AC%AC4%E7%89%88/%E7%AC%AC8%E7%AB%A0-Java%E9%9B%86%E5%90%88/8-6-Java-8%E5%A2%9E%E5%BC%BA%E7%9A%84Map%E9%9B%86%E5%90%88/" itemprop="url" rel="index"><span itemprop="name">8.6 Java 8增强的Map集合</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
    <span class="post-meta-item-icon">
      <i class="far fa-comment"></i>
    </span>
    <span class="post-meta-item-text">Waline：</span>
  
    <a title="waline" href="/JavaReadingNotes/9e27f253/#waline-comments" itemprop="discussionUrl">
      <span class="post-comments-count waline-comment-count" id="/JavaReadingNotes/9e27f253/" data-xid="/JavaReadingNotes/9e27f253/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>999</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>1 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="8-6-3-LinkedHashMap实现类"><a href="#8-6-3-LinkedHashMap实现类" class="headerlink" title="8.6.3 LinkedHashMap实现类"></a>8.6.3 LinkedHashMap实现类</h1><p><code>HashSet</code>有一个<code>LinkedHashSet</code>子类, <code>HashMap</code>也有一个<code>LinkedHashMap</code>子类; </p>
<h2 id="LinkedHashMap数据结构-双向链表"><a href="#LinkedHashMap数据结构-双向链表" class="headerlink" title="LinkedHashMap数据结构 双向链表"></a>LinkedHashMap数据结构 双向链表</h2><p><code>LinkedHashMap</code>也使用<strong>双向链表</strong>来维护<code>key-value</code>对的次序(其实只需要考虑<code>key</code>的次序),该链表负责维护<code>Map</code>的迭代顺序。</p>
<h2 id="LinkedHashMap有序"><a href="#LinkedHashMap有序" class="headerlink" title="LinkedHashMap有序"></a>LinkedHashMap有序</h2><p><strong><code>LinkedHashMap</code>的迭代顺序与<code>key-value</code>对的插入顺序保持一致</strong>。</p>
<p><code>LinkedHashMap</code>可以避免对<code>HashMap</code>、 <code>Hashtable</code>里的<code>key-value</code>对进行排序(只要插入<code>key-value</code>对时保持顺序即可),同时又可避免使用<code>TreeMap</code>所增加的成本。<br><code>LinkedHashMap</code>需要维护元素的插入顺序,因此性能略低于<code>HashMap</code>的性能;但因为它以链表来维护内部顺序,所以在迭代访问<code>Map</code>里的全部元素时将有较好的性能。</p>
<h2 id="程序-LinkedHashMap示例"><a href="#程序-LinkedHashMap示例" class="headerlink" title="程序 LinkedHashMap示例"></a>程序 LinkedHashMap示例</h2><p>下面程序示范了<code>LinkedHashMap</code>的功能:<strong>迭代输出<code>LinkedHashMap</code>的元素时,输出的顺序与添加<code>key-value</code>对的顺序一致</strong>。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LinkedHashMapTest</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">LinkedHashMap</span> <span class="variable">scores</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">LinkedHashMap</span>();</span><br><span class="line">        scores.put(<span class="string">&quot;语文&quot;</span> , <span class="number">80</span>);</span><br><span class="line">        scores.put(<span class="string">&quot;英文&quot;</span> , <span class="number">82</span>);</span><br><span class="line">        scores.put(<span class="string">&quot;数学&quot;</span> , <span class="number">76</span>);</span><br><span class="line">        <span class="comment">// 调用forEach方法遍历scores里的所有key-value对</span></span><br><span class="line">        scores.forEach((key, value) -&gt; System.out.println(key + <span class="string">&quot;--&gt;&quot;</span> + value));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果:</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">语文--&gt;<span class="number">80</span></span><br><span class="line">英文--&gt;<span class="number">82</span></span><br><span class="line">数学--&gt;<span class="number">76</span></span><br></pre></td></tr></table></figure>
<p>上面程序中最后一行代码使用<code>Java 8</code>为<code>Map</code>新增的<code>forEach()</code>方法来遍历<code>Map</code>集合。编译、运行上面程序,即可看到<code>LinkedHashMap</code>的功能: <strong><code>LinkedHashMap</code>可以记住<code>key-value</code>对的添加顺序</strong>。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://lanlan2017.github.io/JavaReadingNotes/5f93fd8b/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/JavaReadingNotes/images/avatar.gif">
      <meta itemprop="name" content="蓝蓝">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="蓝蓝站点">
      <meta itemprop="description" content="好好学习，天天向上">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 蓝蓝站点">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/JavaReadingNotes/5f93fd8b/" class="post-title-link" itemprop="url">8.6.2 Java 8改进的HashMap和Hashtable实现类</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2019-07-10 17:17:47" itemprop="dateCreated datePublished" datetime="2019-07-10T17:17:47+08:00">2019-07-10</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2020-03-09 10:34:04" itemprop="dateModified" datetime="2020-03-09T10:34:04+08:00">2020-03-09</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JavaReadingNotes/categories/1-%E7%96%AF%E7%8B%82Java%E8%AE%B2%E4%B9%89-%E7%AC%AC4%E7%89%88/" itemprop="url" rel="index"><span itemprop="name">1 疯狂Java讲义 (第4版)</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JavaReadingNotes/categories/1-%E7%96%AF%E7%8B%82Java%E8%AE%B2%E4%B9%89-%E7%AC%AC4%E7%89%88/%E7%AC%AC8%E7%AB%A0-Java%E9%9B%86%E5%90%88/" itemprop="url" rel="index"><span itemprop="name">第8章 Java集合</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JavaReadingNotes/categories/1-%E7%96%AF%E7%8B%82Java%E8%AE%B2%E4%B9%89-%E7%AC%AC4%E7%89%88/%E7%AC%AC8%E7%AB%A0-Java%E9%9B%86%E5%90%88/8-6-Java-8%E5%A2%9E%E5%BC%BA%E7%9A%84Map%E9%9B%86%E5%90%88/" itemprop="url" rel="index"><span itemprop="name">8.6 Java 8增强的Map集合</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
    <span class="post-meta-item-icon">
      <i class="far fa-comment"></i>
    </span>
    <span class="post-meta-item-text">Waline：</span>
  
    <a title="waline" href="/JavaReadingNotes/5f93fd8b/#waline-comments" itemprop="discussionUrl">
      <span class="post-comments-count waline-comment-count" id="/JavaReadingNotes/5f93fd8b/" data-xid="/JavaReadingNotes/5f93fd8b/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>5.2k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>5 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="8-6-2-Java-8改进的HashMap和Hashtable实现类"><a href="#8-6-2-Java-8改进的HashMap和Hashtable实现类" class="headerlink" title="8.6.2 Java 8改进的HashMap和Hashtable实现类"></a>8.6.2 Java 8改进的HashMap和Hashtable实现类</h1><p><code>HashMap</code>和<code>Hashtable</code>都是<code>Map</code>接口的典型实现类,它们之间的关系完全类似于<code>ArrayList</code>和<code>Vector</code>的关系：<code>Hashtable</code>是一个古老的<code>Map</code>实现类,它从<code>JDK1.0</code>起就已经出现了,当**<code>Hashtable</code>出现时,<code>Java</code>还没有提供<code>Map</code>接口**,所以<code>Hashtable</code>包含了两个烦琐的方法：</p>
<ul>
<li><code>elements()</code>方法(这个类似于<code>Map</code>接口定义的<code>values()</code>方法)</li>
<li><code>keys()</code>方法(该方法类似于<code>Map</code>接口定义的<code>keySet()</code>方法)</li>
</ul>
<p>现在很少使用这两个方法。</p>
<p><code>Java 8</code>改进了<code>HashMap</code>的实现,使用<code>HashMap</code>存在<code>key</code>冲突时依然具有较好的性能。</p>
<h2 id="Hashtable和HashMap的典型区别"><a href="#Hashtable和HashMap的典型区别" class="headerlink" title="Hashtable和HashMap的典型区别"></a>Hashtable和HashMap的典型区别</h2><p>除此之外, <code>Hashtable</code>和<code>HashMap</code>存在两点典型区别。</p>
<h3 id="Hashtable线程安全-HashMap线程不安全"><a href="#Hashtable线程安全-HashMap线程不安全" class="headerlink" title="Hashtable线程安全 HashMap线程不安全"></a>Hashtable线程安全 HashMap线程不安全</h3><ul>
<li><code>Hashtable</code>是一个<strong>线程安全</strong>的<code>Map</code>实现,但<code>HashMap</code>是<strong>线程不安全</strong>的实现,所以<code>HashMap</code>比<code>Hashtable</code>的性能高一点;但如果有多个线程访问同一个<code>Map</code>对象时,使用<code>Hashtable</code>实现类会更好。</li>
</ul>
<h3 id="Hashtable的key和value不能为null-HashMap的key和value可以为null"><a href="#Hashtable的key和value不能为null-HashMap的key和value可以为null" class="headerlink" title="Hashtable的key和value不能为null HashMap的key和value可以为null"></a>Hashtable的key和value不能为null HashMap的key和value可以为null</h3><ul>
<li><code>Hashtable</code>不允许使用<code>null</code>作为<code>key</code>和<code>value</code>,如果试图把<code>null</code>值放进<code>Hashtable</code>中,将会引发<code>NullPointerException</code>异常;但<code>HashMap</code>可以使用<code>null</code>作为<code>key</code>或<code>value</code></li>
</ul>
<p>由于<strong>HashMap里的key不能重复,value可以重复</strong>,所以<code>HashMap</code>里最多只有一个<code>key-value</code>对的<code>key</code>可以为<code>null</code>，但可以有无数多个<code>key-value</code>对的<code>value</code>可以为<code>null</code>。</p>
<p>下面程序示范了用<code>null</code>值作为<code>HashMap</code>的<code>key</code>和<code>value</code>的情形。</p>
<h2 id="实例-null作为HashMap的key和value的情况"><a href="#实例-null作为HashMap的key和value的情况" class="headerlink" title="实例 null作为HashMap的key和value的情况"></a>实例 null作为HashMap的key和value的情况</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">NullInHashMap</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">HashMap</span> <span class="variable">hm</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HashMap</span>();</span><br><span class="line">        <span class="comment">// 试图将两个key为null的key-value对放入HashMap中</span></span><br><span class="line">        hm.put(<span class="literal">null</span> , <span class="literal">null</span>);</span><br><span class="line">        hm.put(<span class="literal">null</span> , <span class="literal">null</span>);    <span class="comment">// 1</span></span><br><span class="line">        <span class="comment">// 将一个value为null的key-value对放入HashMap中</span></span><br><span class="line">        hm.put(<span class="string">&quot;a&quot;</span> , <span class="literal">null</span>);    <span class="comment">// 2</span></span><br><span class="line">        <span class="comment">// 输出Map对象</span></span><br><span class="line">        System.out.println(hm);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>上面程序试图向<code>HashMap</code>中放入三个<code>key-value</code>对,其中1代码处无法将<code>key-value</code>对放入,因为<code>Map</code>中已经有一个<code>key-value</code>对的<code>key</code>为<code>null</code>值,所以无法再放入<code>key</code>为<code>null</code>值的<code>key-value</code>对。2代码处可以放入该<code>key-value</code>对,因为<strong>一个<code>HashMap</code>中可以有多个<code>value</code>为<code>null</code>值</strong>。编译、运行上面程序,看到如下输出结果:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;null=null, a=null&#125;</span><br></pre></td></tr></table></figure>

<h2 id="尽量少用Hashtable"><a href="#尽量少用Hashtable" class="headerlink" title="尽量少用Hashtable"></a>尽量少用Hashtable</h2><p>从<code>Hashtable</code>的类名上就可以看出它是一个古老的类,它的命名甚至没有遵守<code>Java</code>的命名规范:<strong>每个单词的首字母都应该大写</strong>。也许当初开发<code>Hashtable</code>的工程师也没有注意到这一点,后来大量<code>Java</code>程序中使用了<code>Hashtable</code>类,所以这个类名也就不能改为<code>HashTable</code>了,否则将导致大量程序需要改写。与<code>Vector</code>类似的是,<strong>尽量少用<code>Hashtable</code>实现类</strong>。</p>
<h3 id="即使有线程安全要求也不要使用Hashtable"><a href="#即使有线程安全要求也不要使用Hashtable" class="headerlink" title="即使有线程安全要求也不要使用Hashtable"></a>即使有线程安全要求也不要使用Hashtable</h3><p>即使需要创建线程安全的<code>Map</code>实现类,也无须使用<code>Hashtable</code>实现类,可以通过后面介绍的<code>Collections</code>工具类把<code>HashMap</code>变成线程安全的。</p>
<h2 id="HashMap中作为key对象要满足什么条件"><a href="#HashMap中作为key对象要满足什么条件" class="headerlink" title="HashMap中作为key对象要满足什么条件"></a>HashMap中作为key对象要满足什么条件</h2><p>为了成功地在<code>HashMap</code>、 <code>Hashtable</code>中存储、获取对象,用作<code>key</code>的对象必须实现<code>hashCode()</code>方法和<code>equals()</code>方法。</p>
<h2 id="HashMap判断两个key相等的标准是什么"><a href="#HashMap判断两个key相等的标准是什么" class="headerlink" title="HashMap判断两个key相等的标准是什么"></a>HashMap判断两个key相等的标准是什么</h2><p>与<code>HashSet</code>集合不能保证元素的顺序一样, <code>HashMap</code>、 <code>Hashtable</code>也不能保证其中<code>key-value</code>对的顺序。类似于<code>HashSet</code>, <code>HashMap</code>、 <code>Hashtable</code><strong>判断两个<code>key</code>相等的标准也是:两个<code>key</code>通过<code>equals</code>方法比较返回<code>true</code>,并且两个<code>key</code>的<code>hashCode</code>值也相等</strong>。</p>
<h2 id="HashMap判断两个value相等的标准是什么"><a href="#HashMap判断两个value相等的标准是什么" class="headerlink" title="HashMap判断两个value相等的标准是什么"></a>HashMap判断两个value相等的标准是什么</h2><p>除此之外, <code>HashMap</code>、 <code>Hashtable</code>中还包含一个<code>containsValue()</code>方法,用于判断是否包含指定的<code>value</code>那么<code>HashMap</code>、 <code>Hashtable</code>如何判断两个<code>value</code>相等呢? <strong><code>HashMap</code>、 <code>Hashtable</code>判断两个<code>value</code>相等的标准更简单:只要两个对象通过<code>equals</code>方法比较返回<code>true</code>即可</strong>。</p>
<h3 id="程序示例"><a href="#程序示例" class="headerlink" title="程序示例"></a>程序示例</h3><p>下面程序示范了<code>Hashtable</code>判断两个<code>key</code>相等的标准和两个<code>value</code>相等的标准。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">A</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> count;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">A</span><span class="params">(<span class="type">int</span> count)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">this</span>.count = count;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 根据count的值来判断两个对象是否相等。</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">equals</span><span class="params">(Object obj)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (obj == <span class="built_in">this</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">if</span> (obj != <span class="literal">null</span> &amp;&amp; obj.getClass() == A.class)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">A</span> <span class="variable">a</span> <span class="operator">=</span> (A)obj;</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">this</span>.count == a.count;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 根据count来计算hashCode值。</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">hashCode</span><span class="params">()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.count;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">B</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 重写equals()方法，B对象与任何对象通过equals()方法比较都返回true</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">equals</span><span class="params">(Object obj)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HashtableTest</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">Hashtable</span> <span class="variable">ht</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Hashtable</span>();</span><br><span class="line">        ht.put(<span class="keyword">new</span> <span class="title class_">A</span>(<span class="number">60000</span>) , <span class="string">&quot;疯狂Java讲义&quot;</span>);</span><br><span class="line">        ht.put(<span class="keyword">new</span> <span class="title class_">A</span>(<span class="number">87563</span>) , <span class="string">&quot;轻量级Java EE企业应用实战&quot;</span>);</span><br><span class="line">        ht.put(<span class="keyword">new</span> <span class="title class_">A</span>(<span class="number">1232</span>) , <span class="keyword">new</span> <span class="title class_">B</span>());</span><br><span class="line">        System.out.println(ht);</span><br><span class="line">        <span class="comment">// 只要两个对象通过equals比较返回true，</span></span><br><span class="line">        <span class="comment">// Hashtable就认为它们是相等的value。</span></span><br><span class="line">        <span class="comment">// 由于Hashtable中有一个B对象，</span></span><br><span class="line">        <span class="comment">// 它与任何对象通过equals比较都相等，所以下面输出true。</span></span><br><span class="line">        System.out.println(ht.containsValue(<span class="string">&quot;测试字符串&quot;</span>)); <span class="comment">// ① 输出true</span></span><br><span class="line">        <span class="comment">// 只要两个A对象的count相等，它们通过equals比较返回true，且hashCode相等</span></span><br><span class="line">        <span class="comment">// Hashtable即认为它们是相同的key，所以下面输出true。</span></span><br><span class="line">        System.out.println(ht.containsKey(<span class="keyword">new</span> <span class="title class_">A</span>(<span class="number">87563</span>)));   <span class="comment">// ② 输出true</span></span><br><span class="line">        <span class="comment">// 下面语句可以删除最后一个key-value对</span></span><br><span class="line">        ht.remove(<span class="keyword">new</span> <span class="title class_">A</span>(<span class="number">1232</span>));    <span class="comment">//③</span></span><br><span class="line">        System.out.println(ht);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>上面程序定义了A类和B类,其中</p>
<ul>
<li>A类判断两个A对象相等的标准是<code>count</code>实例变量:只要两个A对象的<code>count</code>变量相等,则通过<code>equals</code>方法比较它们返回<code>true</code>,它们的<code>hashCode</code>值也相等;</li>
<li>而B对象则可以与任何对象相等。</li>
</ul>
<p><strong><code>Hashtable</code>判断<code>value</code>相等的标准是: <code>value</code>与另外一个对象通过<code>equals()</code>方法比较返回<code>true</code>即可</strong>。上面程序中的<code>ht</code>对象中包含了一个B对象,它与任何对象通过<code>equals()</code>方法比较总是返回<code>true</code>,所以在①代码处返回<code>true</code>在这种情况下,不管传给<code>ht</code>对象的<code>containtsValue()</code>方法参数是什么,程序总是返回<code>true</code>。</p>
<p>根据<code>Hashtable</code>判断两个<code>key</code>相等的标准,程序在②处也将输出<code>true</code>,虽然两个A对象虽然不是同个对象,但它们**通过<code>equals</code>方法比较返回<code>tue</code>,且<code>hashCode</code>值相等, <code>Hashtable</code>就认为它们是同一个<code>key</code>**。类似的是,程序在③处也可以删除对应的<code>key-value</code>对。</p>
<h2 id="equals方法和hashCode方法判断标准要一致"><a href="#equals方法和hashCode方法判断标准要一致" class="headerlink" title="equals方法和hashCode方法判断标准要一致"></a>equals方法和hashCode方法判断标准要一致</h2><p>当使用自定义类作为<code>HashMap</code>、 <code>Hashtable</code>的<code>key</code>时,如果重写该类的<code>equals()</code>方法和<code>hashCode()</code>方法,则应该保证两个方法的判断标准一致,也就是<strong>当两个<code>key</code>通过<code>equals</code>方法比较返回<code>true</code>时,两个<code>key</code>的<code>hashCode()</code>返回值也应该相同</strong>。因为<code>HashMap</code>、 <code>Hashtable</code>保存<code>key</code>的方式与<code>HashSet</code>保存集合元素的方式完全相同,所以<code>HashMap</code>、 <code>Hashtable</code>对<code>key</code>的要求与<code>HashSet</code>对集合元素的要求完全相同。</p>
<h2 id="可变对象作为HashMap的key时可能无法正确访问"><a href="#可变对象作为HashMap的key时可能无法正确访问" class="headerlink" title="可变对象作为HashMap的key时可能无法正确访问"></a>可变对象作为HashMap的key时可能无法正确访问</h2><p>与<code>HashSet</code>类似的是,如果使用可变对象作为<code>HashMap</code>、 <code>Hashtable</code>的<code>key</code>,并且程序修改了作为<code>key</code>的可变对象,则也可能出现与<code>HashSet</code>类似的情形:程序再也无法准确访问到<code>Map</code>中被修改过的<code>key</code>。</p>
<p>看下面程序</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HashMapErrorTest</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">HashMap</span> <span class="variable">ht</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HashMap</span>();</span><br><span class="line">        <span class="comment">// 此处的A类与前一个程序的A类是同一个类</span></span><br><span class="line">        ht.put(<span class="keyword">new</span> <span class="title class_">A</span>(<span class="number">60000</span>) , <span class="string">&quot;疯狂Java讲义&quot;</span>);</span><br><span class="line">        ht.put(<span class="keyword">new</span> <span class="title class_">A</span>(<span class="number">87563</span>) , <span class="string">&quot;轻量级Java EE企业应用实战&quot;</span>);</span><br><span class="line">        <span class="comment">// 获得Hashtable的key Set集合对应的Iterator迭代器</span></span><br><span class="line">        <span class="type">Iterator</span> <span class="variable">it</span> <span class="operator">=</span> ht.keySet().iterator();</span><br><span class="line">        <span class="comment">// 取出Map中第一个key，并修改它的count值</span></span><br><span class="line">        <span class="type">A</span> <span class="variable">first</span> <span class="operator">=</span> (A)it.next();</span><br><span class="line">        first.count = <span class="number">87563</span>;   <span class="comment">// ①</span></span><br><span class="line">        <span class="comment">// 输出&#123;A@1560b=疯狂Java讲义, A@1560b=轻量级Java EE企业应用实战&#125;</span></span><br><span class="line">        System.out.println(ht);</span><br><span class="line">        <span class="comment">// 只能删除    没有被修改过   的key所对应的key-value对</span></span><br><span class="line">        ht.remove(<span class="keyword">new</span> <span class="title class_">A</span>(<span class="number">87563</span>));</span><br><span class="line">        </span><br><span class="line">        System.out.println(ht);</span><br><span class="line">        <span class="comment">// 无法获取剩下的value，下面两行代码都将输出null。</span></span><br><span class="line">        System.out.println(ht.get(<span class="keyword">new</span> <span class="title class_">A</span>(<span class="number">87563</span>)));   <span class="comment">// ② 输出null</span></span><br><span class="line">        System.out.println(ht.get(<span class="keyword">new</span> <span class="title class_">A</span>(<span class="number">60000</span>)));   <span class="comment">// ③ 输出null</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>该程序使用了前一个程序定义的A类实例作为<code>key</code>,而A对象是可变对象。当程序在①处修改了A对象后,实际上修改了<code>HashMap</code>集合中元素的<code>key</code>,这就导致该<code>key</code>不能被准确访问。当程序试图删除<code>count</code>为<code>87563</code>的A对象时,只能删除没被修改的<code>key</code>所对应的<code>key-value</code>对。程序②和③处的代码都不能访问”<code>疯狂Java讲义</code>“字符串,这都是因为它对应的<code>key</code>被修改过的原因。</p>
<h2 id="尽量不要使用可变对象作为HashMap的key"><a href="#尽量不要使用可变对象作为HashMap的key" class="headerlink" title="尽量不要使用可变对象作为HashMap的key"></a>尽量不要使用可变对象作为HashMap的key</h2><p>与<code>HashSet</code>类似的是,尽量不要使用可变对象作为<code>HashMap</code>、 <code>Hashtable</code>的<code>key</code>,如果确实需要使用可变对象作为<code>HashMap</code>、 <code>Hashtable</code>的<code>key</code>,则尽量不要在程序中修改作为<code>key</code>的可变对象。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/JavaReadingNotes/page/153/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/JavaReadingNotes/">1</a><span class="space">&hellip;</span><a class="page-number" href="/JavaReadingNotes/page/153/">153</a><span class="page-number current">154</span><a class="page-number" href="/JavaReadingNotes/page/155/">155</a><span class="space">&hellip;</span><a class="page-number" href="/JavaReadingNotes/page/188/">188</a><a class="extend next" rel="next" href="/JavaReadingNotes/page/155/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 2018 – 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">蓝蓝</span>
  <!--博客朗读功能开始-->
  <script>
const java_generic_descriptor_regexp = new RegExp('\\<[a-zA-Z?& ,]+\\>');
const modifierRegExp = '([a-z]+)';
const returnValueRegExp = '([a-zA-Z0-9<>,&? \\[\\]]+)';
const methodNameRegExp = '([a-zA-Z0-9]+)';
const parameterRegExp = '([a-zA-Z0-9<>,&? ]+)';
const constructorRegExp = '([A-Z][a-zA-Z0-9_]+)';
const constructor_parameterless_regexp = new RegExp('^' + constructorRegExp + '\\(\\)$');
const constructor_parameterless_replace = '$1无参数构造方法';
const constructor_parameter_regexp = new RegExp('^' + constructorRegExp + '\\(' + parameterRegExp + '\\)$');
const constructor_parameter_replace = '$1构造方法，参数列表$2。';
const return_name_parameterless_regexp = new RegExp('^' + returnValueRegExp + ' ' + methodNameRegExp + '\\(\\)$');
const return_name_parameterless_replace = '$2方法，无参数，返回值$1。';
const modifier_return_name_parameterless_regexp = new RegExp('^' + modifierRegExp + ' ' + returnValueRegExp + ' ' + methodNameRegExp + '\\(\\)$');
const modifier_return_name_parameterless_replace = '$3方法，无参数，返回值$2，修饰符$1。';
const return_name_parameter_regexp = new RegExp('^' + returnValueRegExp + ' ' + methodNameRegExp + '\\(' + parameterRegExp + '\\)' + '$');
const return_name_parameter_replace = '$2方法，参数列表：$3，返回值：$1。';
const modifier_return_name_parameter_regexp = new RegExp('^' + modifierRegExp + ' ' + returnValueRegExp + ' ' + methodNameRegExp + '\\(' + parameterRegExp + '\\)' + '$');
const modifier_return_name_parameter_replace = '$3方法，参数列表：$4，返回值：$2，修饰符：$1。';
function fixTuoFengSplit(javaMethodCode, code) {
    var wrongCode = code.replace(/(?<=[A-Z])(?=[A-Z])/g, " ");
    if (javaMethodCode.search(wrongCode) > -1) {
        javaMethodCode = javaMethodCode.replaceAll(wrongCode, code);
    }
    return javaMethodCode;
}
function javaTuoFengLangDu(javaMethodCode) {
    javaMethodCode = javaMethodCode.replace(/(?<=[a-zA-Z])(?=[A-Z])/g, " ");
    var wrongSplit = ['UNIX', 'WEST', 'NORTH', 'SOUTH', 'EAST', 'RIGHT', 'CENTER', 'LEFT', 'CLASSPATH', 'PATH'];
    wrongSplit = wrongSplit.sort(function (a, b) {
        return b.length - a.length;
    })
    for (var i = 0, len = wrongSplit.length; i < len; i++) {
        javaMethodCode = fixTuoFengSplit(javaMethodCode, wrongSplit[i]);
    }
    return javaMethodCode;
}
function readPunctuation(text) {
    text = text.replaceAll("<", "");
    text = text.replaceAll(">", "");
    text = text.replaceAll(".", "点");
    text = text.replaceAll(":", "冒号");
    text = text.replaceAll("?", "问号");
    return text.replaceAll("**", "");
}
function readKeywords(text) {
    text = text.replaceAll("instanceof", "instance of");
    text = text.replaceAll("C#", "C sharp");
    text = text.replaceAll("javac", "java c");
    return text;
}
function remove_colon_Period_AtTheEndOfTheLine(text) {
    if (text.endsWith(".") || text.endsWith(":")) {
        text = text.substring(0, text.length - 1);
    }
    return text;
}
function readJavaStaticConstants(text) {
    const regexp = /(\.[A-Z_]+)/g;
    const matches = text.matchAll(regexp);
    for (const match of matches) {
        const goup1 = RegExp.$1;
        const goup1Lower = goup1.toLowerCase();
        text = text.replace(goup1, goup1Lower);
    }
    return text;
}
function removeReadingBtnTag(text) {
    text = text.replace(/\n朗读\n/g, '');
    text = text.replace(/^\d+$\n/mg, '');
    text = text.replace(/朗读$/mg, '');
    return text;
}
function preprocessingText(text) {
    text = remove_colon_Period_AtTheEndOfTheLine(text);
    text = readJavaStaticConstants(text);
    text = readPunctuation(text);
    text = readKeywords(text);
    text = javaTuoFengLangDu(text);
    text = removeReadingBtnTag(text);
    return text;
}
function methondReading(text) {
    while (java_generic_descriptor_regexp.test(text)) {
        text = text.replace(java_generic_descriptor_regexp, '');
    }
    console.log("     删除泛型后：" + text);
    text = text.replace('[]', '数组');
    text = text.replace(/\, ?/g, " 和 ");
    text = text.replace(/([a-zA-Z<>]+) ([a-zA-Z]+)/g, "$1类型的参数$2")
    text = javaTuoFengLangDu(text);
    return text;
}
function speak(text, parentElement) {
    const to_speak = new window.SpeechSynthesisUtterance();
    to_speak.text = text;
    to_speak.rate = 7.0;
    const oldColor = parentElement.style.backgroundColor;
    window.speechSynthesis.speak(to_speak);
    parentElement.style.backgroundColor = 'LightCyan';
    to_speak.onstart = function () {
        parentElement.style.backgroundColor = 'LightSkyBlue';
        parentElement.scrollIntoView({
            behavior: "smooth"
        });
    }
    to_speak.onend = function () {
        parentElement.style.backgroundColor = oldColor;
    }
}
function isMethod(text) {
    const modifierCode = 2;
    const returnCode = 3;
    const methodNameCode = 5;
    const parameterCode = 7;
    const constructorCode = 11;
    if (modifier_return_name_parameter_regexp.test(text)) {
        return modifierCode * returnCode * methodNameCode * parameterCode;
    }
    else if (return_name_parameter_regexp.test(text)) {
        return returnCode * methodNameCode * parameterCode;
    } else if (modifier_return_name_parameterless_regexp.test(text)) {
        return modifierCode * returnCode * methodNameCode;
    }
    else if (return_name_parameterless_regexp.test(text)) {
        return returnCode * methodNameCode;
    }
    else if (constructor_parameter_regexp.test(text)) {
        return constructorCode * methodNameCode;
    }
    else if (constructor_parameterless_regexp.test(text)) {
        return constructorCode;
    }
    return -1;
}
function addSpeckBtn(element, number) {
    let i = 0;
    for (; i < element.length; i++) {
        let speakBtn = document.createElement('button');
        speakBtn.innerText = "朗读";
        setButtonStyle(speakBtn);
        speakBtn.id = "speak_btn_" + (i + number);
        speakBtn.className = "speak_btn";
        speakBtn.onclick = function (e) {
            e.target.style.backgroundColor = '#979696';
            const btn = document.getElementById(e.target.id);
            parentElement = btn.parentElement;
            let text = parentElement.innerText;
            text = text.substring(0, text.lastIndexOf(e.target.innerText));
            text = text.replaceAll('​', '');
            console.log(text);
            const methodCode = isMethod(text);
            if (methodCode > 0) {
                console.log("是方法！编号:" + methodCode);
                if (methodCode === 210) {
                    console.log("    修饰符 返回值 方法名 参数列表")
                    text = text.replace(modifier_return_name_parameter_regexp, modifier_return_name_parameter_replace);
                } else if (methodCode === 105) {
                    console.log("    返回值 方法名 参数列表");
                    text = text.replace(return_name_parameter_regexp, return_name_parameter_replace);
                } else if (methodCode === 15) {
                    console.log("    返回值 方法名 没有参数列表")
                    text = text.replace(return_name_parameterless_regexp, return_name_parameterless_replace);
                } else if (methodCode === 30) {
                    console.log("    修饰符 返回值 方法名 没有参数列表");
                    text = text.replace(modifier_return_name_parameterless_regexp, modifier_return_name_parameterless_replace);
                } else if (methodCode === 55) {
                    console.log("    构造器 参数列表");
                    text = text.replace(constructor_parameter_regexp, constructor_parameter_replace);
                } else if (methodCode === 11) {
                    console.log("    构造器 无参数");
                    text = text.replace(constructor_parameterless_regexp, constructor_parameterless_replace);
                }
                text = methondReading(text);
            } else {
                console.log("不是方法")
                text = preprocessingText(text);
            }
            console.log(text + '\n');
            speak(text, parentElement);
        }
        element[i].append(speakBtn);
    }
    return (i + number);
}
function setButtonStyle(button) {
    if (button.innerText.startsWith('朗读')) {
        button.style.fontSize = '12px';
        button.style.backgroundColor = '#008CBA';
    } else {
        button.style.fontSize = '0.8em';
        if (button.innerText == '显示' || button.innerText == '隐藏') {
            button.style.backgroundColor = '#d54b4b';
        } else {
            button.style.backgroundColor = '#25d37c';
        }
        button.style.display = 'block';
    }
    button.style.border = 'none';
    button.style.marginTop = '0.5em';
    button.style.borderRadius = '2px';
}
window.onload = function () {
    const article_div = document.querySelector('body > main > div> div> article');
    const p_ul_ol_h = article_div.querySelectorAll('p:not(.image-caption,:has(img)),div:not(.post-copyright)>ul,div>ol,div>pre,h1:not(.post-title),h2,h3,h4,h5,h6');
    let number = addSpeckBtn(p_ul_ol_h, 0);
    const table_td = article_div.querySelectorAll('div > table tr > th,td:not(.code,.gutter)');
    addSpeckBtn(table_td, number);
    const readAllBtn = document.createElement('button');
    readAllBtn.innerText = "开始";
    setButtonStyle(readAllBtn);
    readAllBtn.onclick = function () {
        const sttButtonS = document.querySelectorAll('button.speak_btn');
        console.log(sttButtonS);
        for (let i = 0; i < sttButtonS.length; i++) {
            sttButtonS[i].click();
        }
    }
    const reloadBtn = document.createElement('button');
    reloadBtn.innerText = "刷新";
    setButtonStyle(reloadBtn);
    reloadBtn.onclick = function () {
        location.reload();
        window.scrollTo(0, 0);
    }
    const pauseBtn = document.createElement('button');
    pauseBtn.innerText = "暂停";
    setButtonStyle(pauseBtn);
    pauseBtn.onclick = function () {
        if (pauseBtn.innerText === "暂停") {
            window.speechSynthesis.pause();
            pauseBtn.innerText = "继续";
        } else if (pauseBtn.innerText === "继续") {
            window.speechSynthesis.resume();
            pauseBtn.innerText = "暂停";
        }
    }
    const readStopBtn = document.createElement('button');
    readStopBtn.innerText = "停止";
    setButtonStyle(readStopBtn);
    readStopBtn.onclick = function () {
        window.speechSynthesis.cancel()
        const sttButtonS = document.querySelectorAll('button.speak_btn');
        for (let i = 0; i < sttButtonS.length; i++) {
            sttButtonS[i].parentElement.style.backgroundColor = '#fff';
        }
    }
    const divTop = document.createElement('div');
    divTop.id = 'blog_reading_control_div';
    divTop.style.position = 'fixed';
    divTop.style.zIndex = '9999';
    divTop.style.textAlign = 'center';
    divTop.style.bottom = '1em';
    divTop.style.left = '0em';
    divTop.style.lineHeight = '1.15';
    const controlDiv = document.createElement('div');
    const showHideBtn = document.createElement('button');
    showHideBtn.innerText = '隐藏';
    showHideBtn.onclick = function (ev) {
        if (showHideBtn.innerText === '隐藏') {
            controlDiv.style.display = 'none';
            showHideBtn.innerText = '显示';
        } else if (showHideBtn.innerText === '显示') {
            controlDiv.style.display = 'block';
            showHideBtn.innerText = '隐藏';
        }
    }
    setButtonStyle(showHideBtn);
    controlDiv.append(reloadBtn);
    controlDiv.append(readAllBtn);
    controlDiv.append(pauseBtn);
    controlDiv.append(readStopBtn);
    divTop.append(controlDiv);
    divTop.append(showHideBtn);
    document.body.appendChild(divTop);
}
  </script>
  <!--博客朗读功能结束-->
</div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
      <span>站点总字数：</span>
    <span title="站点总字数">5.9m</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span>站点阅读时长 &asymp;</span>
    <span title="站点阅读时长">88:42</span>
  </span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@next-theme/pjax@0.5.0/pjax.min.js" integrity="sha256-3NkoLDrmHLTYj7csHIZSr0MHAFTXth7Ua/DDt4MRUAg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/lozad@1.16.0/dist/lozad.min.js" integrity="sha256-mOFREFhqmHeQbXpK2lp4nA3qooVgACfh88fpJftLBbc=" crossorigin="anonymous"></script>
<script src="/JavaReadingNotes/js/comments.js"></script><script src="/JavaReadingNotes/js/utils.js"></script><script src="/JavaReadingNotes/js/motion.js"></script><script src="/JavaReadingNotes/js/next-boot.js"></script><script src="/JavaReadingNotes/js/pjax.js"></script>

  
<script src="https://cdn.jsdelivr.net/npm/hexo-generator-searchdb@1.4.0/dist/search.js" integrity="sha256-vXZMYLEqsROAXkEw93GGIvaB2ab+QW6w3+1ahD9nXXA=" crossorigin="anonymous"></script>
<script src="/JavaReadingNotes/js/third-party/search/local-search.js"></script>



  <script src="/JavaReadingNotes/js/third-party/fancybox.js"></script>

  <script src="/JavaReadingNotes/js/third-party/pace.js"></script>

  




  

  <script class="next-config" data-name="enableMath" type="application/json">false</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js","integrity":"sha256-r+3itOMtGGjap0x+10hu6jW/gZCzxHsoKrOd7gyRSGY="}}</script>
<script src="/JavaReadingNotes/js/third-party/math/mathjax.js"></script>


  <script src="https://cdn.jsdelivr.net/npm/quicklink@2.2.0/dist/quicklink.umd.js" integrity="sha256-4kQf9z5ntdQrzsBC3YSHnEz02Z9C1UeW/E9OgnvlzSY=" crossorigin="anonymous"></script>
  <script class="next-config" data-name="quicklink" type="application/json">{"enable":true,"home":true,"archive":true,"delay":true,"timeout":3000,"priority":true,"url":"https://lanlan2017.github.io/JavaReadingNotes/page/154/"}</script>
  <script src="/JavaReadingNotes/js/third-party/quicklink.js"></script>
<script class="next-config" data-name="waline" type="application/json">{"lang":null,"enable":true,"serverURL":"https://waline-test-lanlan2017.vercel.app","placeholder":"填写邮箱可接收回复通知 填写个人网址可为您引流","avatar":"mm","pageSize":10,"visitor":false,"comment_count":true,"requiredFields":[],"meta":["nick","mail","link"],"libUrl":"https://cdn.jsdelivr.net/npm/@waline/client/dist/Waline.min.js","el":"#waline-comments","path":"/JavaReadingNotes/page/154/"}</script>
<script>
document.addEventListener('page:loaded', () => {
  NexT.utils.loadComments(CONFIG.waline.el).then(() => 
    NexT.utils.getScript(CONFIG.waline.libUrl, { condition: window.Waline })
  ).then(() => {
    new Waline(CONFIG.waline);
  });
});
</script>
</body>
</html>
